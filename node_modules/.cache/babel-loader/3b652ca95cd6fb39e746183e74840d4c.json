{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\86136\\\\Desktop\\\\\\u5B66\\u4E60\\u8FDB\\u5EA6\\\\new_html\\\\fullstack_yyf\\\\react\\\\cloud-music\\\\src\\\\application\\\\SongList\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { SongList, SongItem } from \"./style\";\nimport { getName } from '../../api/utils';\nimport { ONE_PAGE_COUNT } from '../../api/config';\nimport { connect } from 'react-redux';\nimport { changePlayList, changeCurrentIndex, changeSequecePlayList } from './../../application/Player/store/actionCreators';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SongsList = /*#__PURE__*/React.forwardRef(_c = _s((props, refs) => {\n  _s();\n\n  const [startIndex, setStartIndex] = useState(0);\n  const {\n    songs,\n    collectCount,\n    showCollect,\n    loading = false,\n    usePageSplit\n  } = props;\n  const {\n    musicAnimation\n  } = props;\n  const {\n    changePlayListDispatch,\n    changeCurrentIndexDispatch,\n    changeSequecePlayListDispatch\n  } = props;\n  const totalCount = songs.length;\n  useEffect(() => {\n    if (!loading) return;\n    if (startIndex + 1 + ONE_PAGE_COUNT >= totalCount) return;\n    setStartIndex(startIndex + ONE_PAGE_COUNT);\n  }, [loading, startIndex, totalCount]);\n\n  const selectItem = (e, index) => {\n    changePlayListDispatch(songs);\n    changeSequecePlayListDispatch(songs);\n    changeCurrentIndexDispatch(index);\n    musicAnimation(e.nativeEvent.clientX, e.nativeEvent.clientY);\n  };\n\n  let songList = list => {\n    let res = []; // 判断页数是否超过总数\n\n    let end = usePageSplit ? startIndex + ONE_PAGE_COUNT : list.length;\n\n    for (let i = 0; i < end; i++) {\n      if (i >= list.length) break;\n      let item = list[i];\n      res.push( /*#__PURE__*/_jsxDEV(\"li\", {\n        onClick: e => selectItem(e, i),\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"index\",\n          children: i + 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 44,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [item.ar ? getName(item.ar) : getName(item.artists), \" - \", item.al ? item.al.name : item.album.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 11\n        }, this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }, this));\n    }\n\n    return res;\n  };\n\n  const collect = count => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"add_list\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"iconfont\",\n        children: \"\\uE62D\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"\\u6536\\u85CF(\", Math.floor(count / 1000) / 10, \"\\u4E07)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this) // <div className=\"isCollected\">\n    //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\n    // </div>\n    ;\n  };\n\n  return /*#__PURE__*/_jsxDEV(SongList, {\n    ref: refs,\n    showBackground: props.showBackground,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"first_line\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"play_all\",\n        onClick: e => selectItem(e, 0),\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"iconfont\",\n          children: \"\\uE6E3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u64AD\\u653E\\u5168\\u90E8 \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"sum\",\n            children: [\"(\\u5171\", totalCount, \"\\u9996)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 22\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), showCollect ? collect(collectCount) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SongItem, {\n      children: songList(songs)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n}, \"xONUAB7K55wruasu3W4M4x13F+I=\")); // 映射Redux全局的state到组件的props上\n\n_c2 = SongsList;\n\nconst mapStateToProps = state => ({\n  fullScreen: state.getIn(['player', 'fullScreen']),\n  playing: state.getIn(['player', 'playing']),\n  currentSong: state.getIn(['player', 'currentSong']),\n  scrollY: state.getIn(['album', 'scrollY'])\n}); // 映射dispatch到props上\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    changePlayListDispatch(data) {\n      dispatch(changePlayList(data));\n    },\n\n    changeCurrentIndexDispatch(data) {\n      dispatch(changeCurrentIndex(data));\n    },\n\n    changeSequecePlayListDispatch(data) {\n      dispatch(changeSequecePlayList(data));\n    }\n\n  };\n}; // 将ui组件包装成容器组件\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)( /*#__PURE__*/React.memo(SongsList));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SongsList$React.forwardRef\");\n$RefreshReg$(_c2, \"SongsList\");","map":{"version":3,"sources":["C:/Users/86136/Desktop/学习进度/new_html/fullstack_yyf/react/cloud-music/src/application/SongList/index.js"],"names":["React","useState","useEffect","SongList","SongItem","getName","ONE_PAGE_COUNT","connect","changePlayList","changeCurrentIndex","changeSequecePlayList","SongsList","forwardRef","props","refs","startIndex","setStartIndex","songs","collectCount","showCollect","loading","usePageSplit","musicAnimation","changePlayListDispatch","changeCurrentIndexDispatch","changeSequecePlayListDispatch","totalCount","length","selectItem","e","index","nativeEvent","clientX","clientY","songList","list","res","end","i","item","push","name","ar","artists","al","album","id","collect","count","Math","floor","showBackground","mapStateToProps","state","fullScreen","getIn","playing","currentSong","scrollY","mapDispatchToProps","dispatch","data","memo"],"mappings":"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","sourcesContent":["import React, {useState, useEffect } from 'react';\r\nimport { SongList, SongItem } from \"./style\";\r\nimport { getName } from '../../api/utils';\r\nimport { ONE_PAGE_COUNT } from '../../api/config';\r\nimport { connect } from 'react-redux';\r\nimport { changePlayList, changeCurrentIndex, changeSequecePlayList } from './../../application/Player/store/actionCreators';\r\n\r\nconst SongsList = React.forwardRef((props, refs)=> {\r\n\r\n  const [startIndex, setStartIndex] = useState(0);\r\n\r\n  const { songs, collectCount, showCollect,loading=false, usePageSplit } = props;\r\n\r\n  const { musicAnimation } = props;\r\n\r\n  const { changePlayListDispatch, changeCurrentIndexDispatch, changeSequecePlayListDispatch } = props;\r\n  const totalCount = songs.length;\r\n\r\n  useEffect(() => {\r\n    if(!loading) return;\r\n    if(startIndex + 1 + ONE_PAGE_COUNT >= totalCount)\r\n      return;\r\n    setStartIndex(startIndex + ONE_PAGE_COUNT);\r\n  }, [loading, startIndex, totalCount]);\r\n\r\n  const selectItem = (e, index) => {\r\n    changePlayListDispatch(songs);\r\n    changeSequecePlayListDispatch(songs);\r\n    changeCurrentIndexDispatch(index);\r\n    musicAnimation(e.nativeEvent.clientX, e.nativeEvent.clientY);\r\n  }\r\n\r\n  let songList = (list) => {\r\n    let res = [];\r\n    // 判断页数是否超过总数\r\n    let end = usePageSplit ? startIndex + ONE_PAGE_COUNT : list.length;\r\n    for(let i = 0; i < end; i++) {\r\n      if(i >= list.length) break;\r\n      let item = list[i];\r\n      res.push(\r\n        <li key={item.id} onClick={(e) => selectItem(e, i)}>\r\n          <span className=\"index\">{i + 1}</span>\r\n          <div className=\"info\">\r\n            <span>{item.name}</span>\r\n            <span>\r\n              { item.ar ? getName(item.ar): getName(item.artists) } - { item.al ? item.al.name : item.album.name}\r\n            </span>\r\n          </div>\r\n        </li>\r\n      )\r\n    }\r\n    return res;\r\n  };\r\n\r\n  const collect = (count) => {\r\n    return  (\r\n      <div className=\"add_list\">\r\n        <i className=\"iconfont\">&#xe62d;</i>\r\n        <span>收藏({Math.floor(count/1000)/10}万)</span>\r\n      </div>\r\n      // <div className=\"isCollected\">\r\n      //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\r\n      // </div>\r\n    )\r\n  };\r\n  return (\r\n    <SongList ref={refs} showBackground={props.showBackground}>\r\n      <div className=\"first_line\">\r\n        <div className=\"play_all\" onClick={(e) => selectItem(e, 0)}>\r\n          <i className=\"iconfont\">&#xe6e3;</i>\r\n          <span>播放全部 <span className=\"sum\">(共{totalCount}首)</span></span>\r\n        </div>\r\n        { showCollect ? collect(collectCount) : null}\r\n      </div>\r\n      <SongItem>\r\n        { songList(songs) }\r\n      </SongItem>\r\n    </SongList>\r\n  )\r\n});\r\n\r\n\r\n// 映射Redux全局的state到组件的props上\r\nconst mapStateToProps = (state) => ({\r\n  fullScreen: state.getIn(['player', 'fullScreen']),\r\n  playing: state.getIn(['player', 'playing']),\r\n  currentSong: state.getIn(['player', 'currentSong']),\r\n  scrollY: state.getIn(['album', 'scrollY'])  \r\n});\r\n// 映射dispatch到props上\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    changePlayListDispatch(data){\r\n      dispatch(changePlayList(data));\r\n    },\r\n    changeCurrentIndexDispatch(data) {\r\n      dispatch(changeCurrentIndex(data));\r\n    },\r\n    changeSequecePlayListDispatch(data) {\r\n      dispatch(changeSequecePlayList(data))\r\n    }\r\n  }\r\n};\r\n\r\n\r\n// 将ui组件包装成容器组件\r\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(SongsList));"]},"metadata":{},"sourceType":"module"}