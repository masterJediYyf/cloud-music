{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\86136\\\\Desktop\\\\\\u5B66\\u4E60\\u8FDB\\u5EA6\\\\new_html\\\\fullstack_yyf\\\\react\\\\cloud-music\\\\src\\\\application\\\\Singer\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { CSSTransition } from 'react-transition-group';\nimport { Container, ImgWrapper, CollectButton, BgLayer, SongListWrapper } from './style';\nimport Header from \"../../baseUI/header\";\nimport Scroll from '../../baseUI/scroll';\nimport SongList from \"../SongList\";\nimport { HEADER_HEIGHT } from '../../api/config';\nimport { connect } from 'react-redux';\nimport { getSingerInfo, changeEnterLoading } from './store/actionCreator';\nimport loading from \"../../baseUI/loading\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Singer(props) {\n  _s();\n\n  const [showStatus, setShowStatus] = useState(true);\n  const collectButton = useRef();\n  const imageWrapper = useRef();\n  const songScrollWrapper = useRef();\n  const songScroll = useRef();\n  const header = useRef();\n  const layer = useRef(); // 图片初始高度\n\n  const initialHeight = useRef(0); // 往上偏移的尺寸，露出圆角\n\n  const OFFSET = 5;\n  const {\n    artist: immutableArtist,\n    songs: immutableSongs,\n    loading\n  } = props;\n  const {\n    getSingerDataDispatch\n  } = props;\n  const artist = immutableArtist.toJS();\n  const songs = immutableSongs.toJS();\n  useEffect(() => {\n    const id = props.match.params.id;\n    getSingerDataDispatch(id);\n    let h = imageWrapper.current.offsetHeight;\n    songScrollWrapper.current.style.top = `${h - OFFSET}px`;\n    initialHeight.current = h; // 把遮罩先放在下面，以裹住歌曲列表\n\n    layer.current.style.top = `${h - OFFSET}px`;\n    songScroll.current.refresh(); //eslint-disable-next-line\n  }, []);\n  const setShowStatusFalse = useCallback(() => {\n    setShowStatus(false);\n  }, []);\n  const handleScroll = useCallback(pos => {\n    let height = initialHeight.current;\n    const newY = pos.y;\n    const imageDOM = imageWrapper.current;\n    const buttonDOM = collectButton.current;\n    const headerDOM = header.current;\n    const layerDOM = layer.current;\n    const minScrollY = -(height - OFFSET) + HEADER_HEIGHT; //指的是滑动距离占图片高度的百分比\n\n    const percent = Math.abs(newY / height);\n\n    if (newY > 0) {\n      imageDOM.style[\"transform\"] = `scale(${1 + percent})`;\n      buttonDOM.style[\"transform\"] = `translated(0,${newY}px,0)`;\n      layerDOM.style.top = `${height - OFFSET + newY}px`;\n    } else if (newY >= minScrollY) {\n      layerDOM.style.top = `${height - OFFSET - Math.abs(newY)}px`; // 这时候保证遮罩的层叠优先级比图片高，不至于被图片挡住\n\n      layerDOM.style.zIndex = 1;\n      imageDOM.style.paddingTop = \"75%\";\n      imageDOM.style.height = 0;\n      imageDOM.style.zIndex = -1; // 按钮跟着移动且渐渐变透明\n\n      buttonDOM.style[\"transform\"] = `translate3d (0, ${newY}px, 0)`;\n      buttonDOM.style[\"opacity\"] = `${1 - percent * 2}`;\n    } else if (newY < minScrollY) {\n      // 往上滑动，但是超过 Header 部分\n      layerDOM.style.top = `${HEADER_HEIGHT - OFFSET}px`;\n      layerDOM.style.zIndex = 1; // 防止溢出的歌单内容遮住 Header\n\n      headerDOM.style.zIndex = 100; // 此时图片高度与 Header 一致\n\n      imageDOM.style.height = `${HEADER_HEIGHT}px`;\n      imageDOM.style.paddingTop = 0;\n      imageDOM.style.zIndex = 99;\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(CSSTransition, {\n    in: showStatus,\n    timeout: 300,\n    classNames: \"fly\",\n    appear: true,\n    unmountOnExit: true,\n    onExited: () => props.history.goBack(),\n    children: [/*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        handleClick: setShowStatusFalse,\n        title: artist.name,\n        ref: header\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(ImgWrapper, {\n        ref: imageWrapper,\n        bgUrl: artist.picUrl,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(CollectButton, {\n        ref: collectButton,\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"iconfont\",\n          children: \"\\uE62D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text\",\n          children: \" \\u6536\\u85CF \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(BgLayer, {\n        ref: layer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SongListWrapper, {\n        ref: songScrollWrapper,\n        children: /*#__PURE__*/_jsxDEV(Scroll, {\n          ref: songScroll,\n          onScroll: handleScroll,\n          children: /*#__PURE__*/_jsxDEV(SongList, {\n            songs: songs,\n            showCollect: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"loading\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 22\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 7\n  }, this);\n} //映射 Redux 全局的 state 到组件的 props 上\n\n\n_s(Singer, \"wzZXg0EU4CyqhJgHP2jdznGeSeU=\");\n\n_c = Singer;\n\nconst mapStateToProps = state => ({\n  artist: state.getIn([\"singerInfo\", \"artist\"]),\n  songs: state.getIn([\"singerInfo\", \"songsOfArtist\"]),\n  loading: state.getIn([\"singerInfo\", \"loading\"])\n}); //映射 dispatch 到 props 上\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getSingerDataDispatch(id) {\n      dispatch(changeEnterLoading(true));\n      dispatch(getSingerInfo(id));\n    }\n\n  };\n}; // 将 ui 组件包装成容器组件\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)( /*#__PURE__*/React.memo(Singer));\n\nvar _c;\n\n$RefreshReg$(_c, \"Singer\");","map":{"version":3,"sources":["C:/Users/86136/Desktop/学习进度/new_html/fullstack_yyf/react/cloud-music/src/application/Singer/index.js"],"names":["React","useState","useRef","useEffect","useCallback","CSSTransition","Container","ImgWrapper","CollectButton","BgLayer","SongListWrapper","Header","Scroll","SongList","HEADER_HEIGHT","connect","getSingerInfo","changeEnterLoading","loading","Singer","props","showStatus","setShowStatus","collectButton","imageWrapper","songScrollWrapper","songScroll","header","layer","initialHeight","OFFSET","artist","immutableArtist","songs","immutableSongs","getSingerDataDispatch","toJS","id","match","params","h","current","offsetHeight","style","top","refresh","setShowStatusFalse","handleScroll","pos","height","newY","y","imageDOM","buttonDOM","headerDOM","layerDOM","minScrollY","percent","Math","abs","zIndex","paddingTop","history","goBack","name","picUrl","mapStateToProps","state","getIn","mapDispatchToProps","dispatch","memo"],"mappings":"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","sourcesContent":["import React ,{useState,useRef,useEffect,useCallback}from \"react\";\r\nimport {CSSTransition} from 'react-transition-group';\r\nimport {Container,ImgWrapper,CollectButton,BgLayer,SongListWrapper} from './style';\r\nimport Header from \"../../baseUI/header\";\r\nimport Scroll from '../../baseUI/scroll';\r\nimport SongList from \"../SongList\";\r\nimport {HEADER_HEIGHT} from '../../api/config';\r\nimport { connect } from 'react-redux';\r\nimport { getSingerInfo, changeEnterLoading } from './store/actionCreator';\r\nimport loading from \"../../baseUI/loading\";\r\n\r\n\r\nfunction Singer(props){\r\n    const [showStatus,setShowStatus] = useState(true);\r\n\r\n    const collectButton = useRef ();\r\n    const imageWrapper = useRef ();\r\n    const songScrollWrapper = useRef ();\r\n    const songScroll = useRef ();\r\n    const header = useRef ();\r\n    const layer = useRef ();\r\n    // 图片初始高度\r\n    const initialHeight = useRef (0);\r\n\r\n    // 往上偏移的尺寸，露出圆角\r\n    const OFFSET = 5;\r\n\r\n    const {\r\n      artist: immutableArtist,\r\n      songs: immutableSongs,\r\n      loading,\r\n    } = props;\r\n\r\n    const { getSingerDataDispatch } = props;\r\n\r\n    const artist = immutableArtist.toJS();\r\n    const songs = immutableSongs.toJS();\r\n\r\n    useEffect (() => {\r\n      const id = props.match.params.id;\r\n      getSingerDataDispatch(id);\r\n      let h = imageWrapper.current.offsetHeight;\r\n      songScrollWrapper.current.style.top = `${h - OFFSET}px`;\r\n      initialHeight.current = h;\r\n      // 把遮罩先放在下面，以裹住歌曲列表\r\n      layer.current.style.top = `${h - OFFSET}px`;\r\n      songScroll.current.refresh ();\r\n      //eslint-disable-next-line\r\n    }, []);\r\n\r\n    const setShowStatusFalse = useCallback (() => {\r\n      setShowStatus (false);\r\n    }, []);\r\n\r\n    const handleScroll = useCallback(pos =>{\r\n      let height = initialHeight.current;\r\n      const newY = pos.y;\r\n      const imageDOM = imageWrapper.current;\r\n      const buttonDOM = collectButton.current;\r\n      const headerDOM = header.current;\r\n      const layerDOM = layer.current;\r\n      const minScrollY = -(height - OFFSET) + HEADER_HEIGHT;\r\n\r\n      //指的是滑动距离占图片高度的百分比\r\n      const percent = Math.abs(newY/height);\r\n      if(newY > 0){\r\n        imageDOM.style[\"transform\"] = `scale(${1 + percent})`;\r\n        buttonDOM.style[\"transform\"] = `translated(0,${newY}px,0)`;\r\n        layerDOM.style.top = `${height - OFFSET + newY}px`;\r\n      }else if (newY >= minScrollY) {\r\n        layerDOM.style.top = `${height - OFFSET - Math.abs (newY)}px`;\r\n        // 这时候保证遮罩的层叠优先级比图片高，不至于被图片挡住\r\n        layerDOM.style.zIndex = 1;\r\n        imageDOM.style.paddingTop = \"75%\";\r\n        imageDOM.style.height = 0;\r\n        imageDOM.style.zIndex = -1;\r\n        // 按钮跟着移动且渐渐变透明\r\n        buttonDOM.style [\"transform\"] = `translate3d (0, ${newY}px, 0)`;\r\n        buttonDOM.style [\"opacity\"] = `${1 - percent * 2}`;\r\n      }else if (newY < minScrollY) {\r\n        // 往上滑动，但是超过 Header 部分\r\n        layerDOM.style.top = `${HEADER_HEIGHT - OFFSET}px`;\r\n        layerDOM.style.zIndex = 1;\r\n        // 防止溢出的歌单内容遮住 Header\r\n        headerDOM.style.zIndex = 100;\r\n        // 此时图片高度与 Header 一致\r\n        imageDOM.style.height = `${HEADER_HEIGHT}px`;\r\n        imageDOM.style.paddingTop = 0;\r\n        imageDOM.style.zIndex = 99;\r\n      }\r\n\r\n    },[]); \r\n\r\n    return (\r\n      <CSSTransition\r\n        in={showStatus}\r\n        timeout={300}\r\n        classNames=\"fly\"\r\n        appear={true}\r\n        unmountOnExit\r\n        onExited={() => props.history.goBack ()}\r\n      >\r\n        <Container>\r\n          <Header\r\n            handleClick={setShowStatusFalse}\r\n            title={artist.name}\r\n            ref={header}\r\n          ></Header>\r\n          <ImgWrapper ref={imageWrapper} bgUrl={artist.picUrl}>\r\n            <div className=\"filter\"></div>\r\n          </ImgWrapper>\r\n          <CollectButton ref={collectButton}>\r\n            <i className=\"iconfont\">&#xe62d;</i>\r\n            <span className=\"text\"> 收藏 </span>\r\n          </CollectButton>\r\n          <BgLayer ref={layer}></BgLayer>\r\n          <SongListWrapper ref={songScrollWrapper}>\r\n            <Scroll ref={songScroll} onScroll={handleScroll}>\r\n              <SongList\r\n                songs={songs}\r\n                showCollect={false}\r\n              ></SongList>\r\n            </Scroll>\r\n          </SongListWrapper>\r\n        </Container>\r\n        { loading ? (<loading></loading>) : null}\r\n      </CSSTransition>\r\n    )\r\n}\r\n\r\n//映射 Redux 全局的 state 到组件的 props 上\r\nconst mapStateToProps = state => ({\r\n  artist: state.getIn([\"singerInfo\",\"artist\"]),\r\n  songs: state.getIn([\"singerInfo\",\"songsOfArtist\"]),\r\n  loading: state.getIn([\"singerInfo\",\"loading\"])\r\n});\r\n\r\n//映射 dispatch 到 props 上\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    getSingerDataDispatch(id) {\r\n      dispatch(changeEnterLoading(true));\r\n      dispatch(getSingerInfo(id));\r\n    }\r\n  }\r\n}\r\n\r\n// 将 ui 组件包装成容器组件\r\nexport default connect(mapStateToProps,mapDispatchToProps)(React.memo(Singer));"]},"metadata":{},"sourceType":"module"}