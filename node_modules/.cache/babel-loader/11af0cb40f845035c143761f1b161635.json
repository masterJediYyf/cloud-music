{"ast":null,"code":"/*!\n * better-scroll / better-scroll\n * (c) 2016-2020 ustbhuangyi\n * Released under the MIT License.\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nfunction warn(msg) {\n  console.error(\"[BScroll warn]: \" + msg);\n} // ssr support\n\n\nvar inBrowser = typeof window !== 'undefined';\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\nvar isWeChatDevTools = ua && /wechatdevtools/.test(ua);\nvar isAndroid = ua && ua.indexOf('android') > 0;\n\nfunction getNow() {\n  return window.performance && window.performance.now && window.performance.timing ? window.performance.now() + window.performance.timing.navigationStart : +new Date();\n}\n\nfunction extend(target) {\n  var rest = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    rest[_i - 1] = arguments[_i];\n  }\n\n  for (var i = 0; i < rest.length; i++) {\n    var source = rest[i];\n\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction isUndef(v) {\n  return v === undefined || v === null;\n}\n\nfunction isPlainObject(v) {\n  return typeof v === 'object' && v !== null;\n}\n\nfunction getDistance(x, y) {\n  return Math.sqrt(x * x + y * y);\n}\n\nfunction fixInboundValue(x, min, max) {\n  if (x < min) {\n    return min;\n  }\n\n  if (x > max) {\n    return max;\n  }\n\n  return x;\n}\n\nvar elementStyle = inBrowser && document.createElement('div').style;\n\nvar vendor = function () {\n  if (!inBrowser) {\n    return false;\n  }\n\n  var transformNames = {\n    webkit: 'webkitTransform',\n    Moz: 'MozTransform',\n    O: 'OTransform',\n    ms: 'msTransform',\n    standard: 'transform'\n  };\n\n  for (var key in transformNames) {\n    if (elementStyle[transformNames[key]] !== undefined) {\n      return key;\n    }\n  }\n\n  return false;\n}();\n\nfunction prefixStyle(style) {\n  if (vendor === false) {\n    return style;\n  }\n\n  if (vendor === 'standard') {\n    if (style === 'transitionEnd') {\n      return 'transitionend';\n    }\n\n    return style;\n  }\n\n  return vendor + style.charAt(0).toUpperCase() + style.substr(1);\n}\n\nfunction getElement(el) {\n  return typeof el === 'string' ? document.querySelector(el) : el;\n}\n\nfunction addEvent(el, type, fn, capture) {\n  el.addEventListener(type, fn, {\n    passive: false,\n    capture: !!capture\n  });\n}\n\nfunction removeEvent(el, type, fn, capture) {\n  el.removeEventListener(type, fn, {\n    capture: !!capture\n  });\n}\n\nfunction offset(el) {\n  var left = 0;\n  var top = 0;\n\n  while (el) {\n    left -= el.offsetLeft;\n    top -= el.offsetTop;\n    el = el.offsetParent;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n}\n\nfunction offsetToBody(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    left: -(rect.left + window.pageXOffset),\n    top: -(rect.top + window.pageYOffset)\n  };\n}\n\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\nvar transform = prefixStyle('transform');\nvar transition = prefixStyle('transition');\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle; // fix issue #361\n\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\nvar hasTransition = inBrowser && transition in elementStyle;\nvar style = {\n  transform: transform,\n  transition: transition,\n  transitionTimingFunction: prefixStyle('transitionTimingFunction'),\n  transitionDuration: prefixStyle('transitionDuration'),\n  transitionDelay: prefixStyle('transitionDelay'),\n  transformOrigin: prefixStyle('transformOrigin'),\n  transitionEnd: prefixStyle('transitionEnd')\n};\nvar eventTypeMap = {\n  touchstart: 1,\n  touchmove: 1,\n  touchend: 1,\n  mousedown: 2,\n  mousemove: 2,\n  mouseup: 2\n};\n\nfunction getRect(el) {\n  if (el instanceof window.SVGElement) {\n    var rect = el.getBoundingClientRect();\n    return {\n      top: rect.top,\n      left: rect.left,\n      width: rect.width,\n      height: rect.height\n    };\n  } else {\n    return {\n      top: el.offsetTop,\n      left: el.offsetLeft,\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    };\n  }\n}\n\nfunction preventDefaultExceptionFn(el, exceptions) {\n  for (var i in exceptions) {\n    if (exceptions[i].test(el[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar tagExceptionFn = preventDefaultExceptionFn;\n\nfunction tap(e, eventName) {\n  var ev = document.createEvent('Event');\n  ev.initEvent(eventName, true, true);\n  ev.pageX = e.pageX;\n  ev.pageY = e.pageY;\n  e.target.dispatchEvent(ev);\n}\n\nfunction click(e, event) {\n  if (event === void 0) {\n    event = 'click';\n  }\n\n  var eventSource;\n\n  if (e.type === 'mouseup') {\n    eventSource = e;\n  } else if (e.type === 'touchend' || e.type === 'touchcancel') {\n    eventSource = e.changedTouches[0];\n  }\n\n  var posSrc = {};\n\n  if (eventSource) {\n    posSrc.screenX = eventSource.screenX || 0;\n    posSrc.screenY = eventSource.screenY || 0;\n    posSrc.clientX = eventSource.clientX || 0;\n    posSrc.clientY = eventSource.clientY || 0;\n  }\n\n  var ev;\n  var bubbles = true;\n  var cancelable = true;\n\n  if (typeof MouseEvent !== 'undefined') {\n    try {\n      ev = new MouseEvent(event, extend({\n        bubbles: bubbles,\n        cancelable: cancelable\n      }, posSrc));\n    } catch (e) {\n      createEvent();\n    }\n  } else {\n    createEvent();\n  }\n\n  function createEvent() {\n    ev = document.createEvent('Event');\n    ev.initEvent(event, bubbles, cancelable);\n    extend(ev, posSrc);\n  } // forwardedTouchEvent set to true in case of the conflict with fastclick\n\n\n  ev.forwardedTouchEvent = true;\n  ev._constructed = true;\n  e.target.dispatchEvent(ev);\n}\n\nfunction dblclick(e) {\n  click(e, 'dblclick');\n}\n\nfunction prepend(el, target) {\n  var firstChild = target.firstChild;\n\n  if (firstChild) {\n    before(el, firstChild);\n  } else {\n    target.appendChild(el);\n  }\n}\n\nfunction before(el, target) {\n  target.parentNode.insertBefore(el, target);\n}\n\nfunction removeChild(el, child) {\n  el.removeChild(child);\n}\n\nfunction hasClass(el, className) {\n  var reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)');\n  return reg.test(el.className);\n}\n\nvar ease = {\n  // easeOutQuint\n  swipe: {\n    style: 'cubic-bezier(0.23, 1, 0.32, 1)',\n    fn: function (t) {\n      return 1 + --t * t * t * t * t;\n    }\n  },\n  // easeOutQuard\n  swipeBounce: {\n    style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n    fn: function (t) {\n      return t * (2 - t);\n    }\n  },\n  // easeOutQuart\n  bounce: {\n    style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\n    fn: function (t) {\n      return 1 - --t * t * t * t;\n    }\n  }\n};\nvar DEFAULT_INTERVAL = 100 / 60;\nvar windowCompat = inBrowser && window;\n\nfunction noop() {}\n\nvar requestAnimationFrame = function () {\n  if (!inBrowser) {\n    /* istanbul ignore if */\n    return noop;\n  }\n\n  return windowCompat.requestAnimationFrame || windowCompat.webkitRequestAnimationFrame || windowCompat.mozRequestAnimationFrame || windowCompat.oRequestAnimationFrame || // if all else fails, use setTimeout\n  function (callback) {\n    return window.setTimeout(callback, (callback.interval || DEFAULT_INTERVAL) / 2); // make interval as precise as possible.\n  };\n}();\n\nvar cancelAnimationFrame = function () {\n  if (!inBrowser) {\n    /* istanbul ignore if */\n    return noop;\n  }\n\n  return windowCompat.cancelAnimationFrame || windowCompat.webkitCancelAnimationFrame || windowCompat.mozCancelAnimationFrame || windowCompat.oCancelAnimationFrame || function (id) {\n    window.clearTimeout(id);\n  };\n}();\n\nvar noop$1 = function (val) {};\n\nvar sharedPropertyDefinition = {\n  enumerable: true,\n  configurable: true,\n  get: noop$1,\n  set: noop$1\n};\n\nvar getProperty = function (obj, key) {\n  var keys = key.split('.');\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    obj = obj[keys[i]];\n    if (typeof obj !== 'object' || !obj) return;\n  }\n\n  var lastKey = keys.pop();\n\n  if (typeof obj[lastKey] === 'function') {\n    return function () {\n      return obj[lastKey].apply(obj, arguments);\n    };\n  } else {\n    return obj[lastKey];\n  }\n};\n\nvar setProperty = function (obj, key, value) {\n  var keys = key.split('.');\n  var temp;\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    temp = keys[i];\n    if (!obj[temp]) obj[temp] = {};\n    obj = obj[temp];\n  }\n\n  obj[keys.pop()] = value;\n};\n\nfunction propertiesProxy(target, sourceKey, key) {\n  sharedPropertyDefinition.get = function proxyGetter() {\n    return getProperty(this, sourceKey);\n  };\n\n  sharedPropertyDefinition.set = function proxySetter(val) {\n    setProperty(this, sourceKey, val);\n  };\n\n  Object.defineProperty(target, key, sharedPropertyDefinition);\n}\n\nvar EventEmitter =\n/** @class */\nfunction () {\n  function EventEmitter(names) {\n    this.events = {};\n    this.eventTypes = {};\n    this.registerType(names);\n  }\n\n  EventEmitter.prototype.on = function (type, fn, context) {\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    if (!this.events[type]) {\n      this.events[type] = [];\n    }\n\n    this.events[type].push([fn, context]);\n    return this;\n  };\n\n  EventEmitter.prototype.once = function (type, fn, context) {\n    var _this = this;\n\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    var magic = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      _this.off(type, magic);\n\n      fn.apply(context, args);\n    };\n\n    magic.fn = fn;\n    this.on(type, magic);\n    return this;\n  };\n\n  EventEmitter.prototype.off = function (type, fn) {\n    if (!type && !fn) {\n      this.events = {};\n      return this;\n    }\n\n    if (type) {\n      this.hasType(type);\n\n      if (!fn) {\n        this.events[type] = [];\n        return this;\n      }\n\n      var events = this.events[type];\n\n      if (!events) {\n        return this;\n      }\n\n      var count = events.length;\n\n      while (count--) {\n        if (events[count][0] === fn || events[count][0] && events[count][0].fn === fn) {\n          events.splice(count, 1);\n        }\n      }\n\n      return this;\n    }\n  };\n\n  EventEmitter.prototype.trigger = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    this.hasType(type);\n    var events = this.events[type];\n\n    if (!events) {\n      return;\n    }\n\n    var len = events.length;\n    var eventsCopy = events.slice();\n    var ret;\n\n    for (var i = 0; i < len; i++) {\n      var event_1 = eventsCopy[i];\n      var fn = event_1[0],\n          context = event_1[1];\n\n      if (fn) {\n        ret = fn.apply(context, args);\n\n        if (ret === true) {\n          return ret;\n        }\n      }\n    }\n  };\n\n  EventEmitter.prototype.registerType = function (names) {\n    var _this = this;\n\n    names.forEach(function (type) {\n      _this.eventTypes[type] = type;\n    });\n  };\n\n  EventEmitter.prototype.destroy = function () {\n    this.events = {};\n    this.eventTypes = {};\n  };\n\n  EventEmitter.prototype.hasType = function (type) {\n    var types = this.eventTypes;\n    var isType = types[type] === type;\n\n    if (!isType) {\n      warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" + (\"\" + Object.keys(types).map(function (_) {\n        return JSON.stringify(_);\n      })) + \"]\");\n    }\n  };\n\n  return EventEmitter;\n}();\n\nvar EventRegister =\n/** @class */\nfunction () {\n  function EventRegister(wrapper, events) {\n    this.wrapper = wrapper;\n    this.events = events;\n    this.addDOMEvents();\n  }\n\n  EventRegister.prototype.destroy = function () {\n    this.removeDOMEvents();\n    this.events = [];\n  };\n\n  EventRegister.prototype.addDOMEvents = function () {\n    this.handleDOMEvents(addEvent);\n  };\n\n  EventRegister.prototype.removeDOMEvents = function () {\n    this.handleDOMEvents(removeEvent);\n  };\n\n  EventRegister.prototype.handleDOMEvents = function (eventOperation) {\n    var _this = this;\n\n    var wrapper = this.wrapper;\n    this.events.forEach(function (event) {\n      eventOperation(wrapper, event.name, _this, !!event.capture);\n    });\n  };\n\n  EventRegister.prototype.handleEvent = function (e) {\n    var eventType = e.type;\n    this.events.some(function (event) {\n      if (event.name === eventType) {\n        event.handler(e);\n        return true;\n      }\n\n      return false;\n    });\n  };\n\n  return EventRegister;\n}();\n\nvar Options =\n/** @class */\nfunction () {\n  function Options() {\n    this.startX = 0;\n    this.startY = 0;\n    this.scrollX = false;\n    this.scrollY = true;\n    this.freeScroll = false;\n    this.directionLockThreshold = 5;\n    this.eventPassthrough = \"\"\n    /* None */\n    ;\n    this.click = false;\n    this.dblclick = false;\n    this.tap = '';\n    this.bounce = {\n      top: true,\n      bottom: true,\n      left: true,\n      right: true\n    };\n    this.bounceTime = 800;\n    this.momentum = true;\n    this.momentumLimitTime = 300;\n    this.momentumLimitDistance = 15;\n    this.swipeTime = 2500;\n    this.swipeBounceTime = 500;\n    this.deceleration = 0.0015;\n    this.flickLimitTime = 200;\n    this.flickLimitDistance = 100;\n    this.resizePolling = 60;\n    this.probeType = 0\n    /* Default */\n    ;\n    this.stopPropagation = false;\n    this.preventDefault = true;\n    this.preventDefaultException = {\n      tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/\n    };\n    this.tagException = {\n      tagName: /^TEXTAREA$/\n    };\n    this.HWCompositing = true;\n    this.useTransition = true;\n    this.bindToWrapper = false;\n    this.disableMouse = hasTouch;\n    this.disableTouch = !hasTouch;\n    this.autoBlur = true;\n  }\n\n  Options.prototype.merge = function (options) {\n    if (!options) return this;\n\n    for (var key in options) {\n      this[key] = options[key];\n    }\n\n    return this;\n  };\n\n  Options.prototype.process = function () {\n    this.translateZ = this.HWCompositing && hasPerspective ? ' translateZ(0)' : '';\n    this.useTransition = this.useTransition && hasTransition;\n    this.preventDefault = !this.eventPassthrough && this.preventDefault;\n    this.resolveBounce(); // If you want eventPassthrough I have to lock one of the axes\n\n    this.scrollX = this.eventPassthrough === \"horizontal\"\n    /* Horizontal */\n    ? false : this.scrollX;\n    this.scrollY = this.eventPassthrough === \"vertical\"\n    /* Vertical */\n    ? false : this.scrollY; // With eventPassthrough we also need lockDirection mechanism\n\n    this.freeScroll = this.freeScroll && !this.eventPassthrough; // force true when freeScroll is true\n\n    this.scrollX = this.freeScroll ? true : this.scrollX;\n    this.scrollY = this.freeScroll ? true : this.scrollY;\n    this.directionLockThreshold = this.eventPassthrough ? 0 : this.directionLockThreshold;\n    return this;\n  };\n\n  Options.prototype.resolveBounce = function () {\n    var directions = ['top', 'right', 'bottom', 'left'];\n    var bounce = this.bounce;\n\n    if (bounce === false || bounce === true) {\n      this.bounce = makeMap(directions, bounce);\n    }\n  };\n\n  return Options;\n}();\n\nfunction makeMap(keys, val) {\n  if (val === void 0) {\n    val = true;\n  }\n\n  var ret = {};\n  keys.forEach(function (key) {\n    ret[key] = val;\n  });\n  return ret;\n}\n\nvar ActionsHandler =\n/** @class */\nfunction () {\n  function ActionsHandler(wrapper, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeStart', 'start', 'move', 'end', 'click']);\n    this.handleDOMEvents();\n  }\n\n  ActionsHandler.prototype.handleDOMEvents = function () {\n    var _a = this.options,\n        bindToWrapper = _a.bindToWrapper,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch,\n        click = _a.click;\n    var wrapper = this.wrapper;\n    var target = bindToWrapper ? wrapper : window;\n    var wrapperEvents = [];\n    var targetEvents = [];\n    var shouldRegisterTouch = hasTouch && !disableTouch;\n    var shouldRegisterMouse = !disableMouse;\n\n    if (click) {\n      wrapperEvents.push({\n        name: 'click',\n        handler: this.click.bind(this),\n        capture: true\n      });\n    }\n\n    if (shouldRegisterTouch) {\n      wrapperEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (shouldRegisterMouse) {\n      wrapperEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\n    this.targetEventRegister = new EventRegister(target, targetEvents);\n  };\n\n  ActionsHandler.prototype.beforeHandler = function (e, type) {\n    var _a = this.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n    var preventDefaultConditions = {\n      start: function () {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      end: function () {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      move: function () {\n        return preventDefault;\n      }\n    };\n\n    if (preventDefaultConditions[type]()) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  ActionsHandler.prototype.setInitiated = function (type) {\n    if (type === void 0) {\n      type = 0;\n    }\n\n    this.initiated = type;\n  };\n\n  ActionsHandler.prototype.start = function (e) {\n    var _eventType = eventTypeMap[e.type];\n\n    if (this.initiated && this.initiated !== _eventType) {\n      return;\n    }\n\n    this.setInitiated(_eventType); // if textarea or other html tags in options.tagException is manipulated\n    // do not make bs scroll\n\n    if (tagExceptionFn(e.target, this.options.tagException)) {\n      this.setInitiated();\n      return;\n    } // no mouse left button\n\n\n    if (_eventType === 2\n    /* Mouse */\n    && e.button !== 0\n    /* Left */\n    ) return;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\n      return;\n    }\n\n    this.beforeHandler(e, 'start');\n    var point = e.touches ? e.touches[0] : e;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ActionsHandler.prototype.move = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.beforeHandler(e, 'move');\n    var point = e.touches ? e.touches[0] : e;\n    var deltaX = point.pageX - this.pointX;\n    var deltaY = point.pageY - this.pointY;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.move, {\n      deltaX: deltaX,\n      deltaY: deltaY,\n      e: e\n    })) {\n      return;\n    } // auto end when out of wrapper\n\n\n    var scrollLeft = document.documentElement.scrollLeft || window.pageXOffset || document.body.scrollLeft;\n    var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n    var pX = this.pointX - scrollLeft;\n    var pY = this.pointY - scrollTop;\n\n    if (pX > document.documentElement.clientWidth - this.options.momentumLimitDistance || pX < this.options.momentumLimitDistance || pY < this.options.momentumLimitDistance || pY > document.documentElement.clientHeight - this.options.momentumLimitDistance) {\n      this.end(e);\n    }\n  };\n\n  ActionsHandler.prototype.end = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.setInitiated();\n    this.beforeHandler(e, 'end');\n    this.hooks.trigger(this.hooks.eventTypes.end, e);\n  };\n\n  ActionsHandler.prototype.click = function (e) {\n    this.hooks.trigger(this.hooks.eventTypes.click, e);\n  };\n\n  ActionsHandler.prototype.destroy = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.hooks.destroy();\n  };\n\n  return ActionsHandler;\n}();\n\nvar translaterMetaData = {\n  x: ['translateX', 'px'],\n  y: ['translateY', 'px']\n};\n\nvar Translater =\n/** @class */\nfunction () {\n  function Translater(content) {\n    this.content = content;\n    this.style = content.style;\n    this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\n  }\n\n  Translater.prototype.getComputedPosition = function () {\n    var cssStyle = window.getComputedStyle(this.content, null);\n    var matrix = cssStyle[style.transform].split(')')[0].split(', ');\n    var x = +(matrix[12] || matrix[4]);\n    var y = +(matrix[13] || matrix[5]);\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  Translater.prototype.translate = function (point) {\n    var transformStyle = [];\n    Object.keys(point).forEach(function (key) {\n      if (!translaterMetaData[key]) {\n        return;\n      }\n\n      var transformFnName = translaterMetaData[key][0];\n\n      if (transformFnName) {\n        var transformFnArgUnit = translaterMetaData[key][1];\n        var transformFnArg = point[key];\n        transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\n      }\n    });\n    this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\n    this.style[style.transform] = transformStyle.join(' ');\n    this.hooks.trigger(this.hooks.eventTypes.translate, point);\n  };\n\n  Translater.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Translater;\n}();\n\nvar Base =\n/** @class */\nfunction () {\n  function Base(content, translater, options) {\n    this.content = content;\n    this.translater = translater;\n    this.options = options;\n    this.hooks = new EventEmitter(['move', 'end', 'beforeForceStop', 'forceStop', 'time', 'timeFunction']);\n    this.style = content.style;\n  }\n\n  Base.prototype.translate = function (endPoint) {\n    this.translater.translate(endPoint);\n  };\n\n  Base.prototype.setPending = function (pending) {\n    this.pending = pending;\n  };\n\n  Base.prototype.setForceStopped = function (forceStopped) {\n    this.forceStopped = forceStopped;\n  };\n\n  Base.prototype.destroy = function () {\n    this.hooks.destroy();\n    cancelAnimationFrame(this.timer);\n  };\n\n  return Base;\n}();\n\nvar Transition =\n/** @class */\nfunction (_super) {\n  __extends(Transition, _super);\n\n  function Transition() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Transition.prototype.startProbe = function () {\n    var _this = this;\n\n    var probe = function () {\n      var pos = _this.translater.getComputedPosition();\n\n      _this.hooks.trigger(_this.hooks.eventTypes.move, pos); // excute when transition ends\n\n\n      if (!_this.pending) {\n        _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\n\n        return;\n      }\n\n      _this.timer = requestAnimationFrame(probe);\n    };\n\n    cancelAnimationFrame(this.timer);\n    this.timer = requestAnimationFrame(probe);\n  };\n\n  Transition.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.style[style.transitionDuration] = time + 'ms';\n    this.hooks.trigger(this.hooks.eventTypes.time, time);\n  };\n\n  Transition.prototype.transitionTimingFunction = function (easing) {\n    this.style[style.transitionTimingFunction] = easing;\n    this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\n  };\n\n  Transition.prototype.move = function (startPoint, endPoint, time, easingFn, isSlient) {\n    this.setPending(time > 0 && (startPoint.x !== endPoint.x || startPoint.y !== endPoint.y));\n    this.transitionTimingFunction(easingFn);\n    this.transitionTime(time);\n    this.translate(endPoint);\n\n    if (time && this.options.probeType === 3\n    /* Realtime */\n    ) {\n        this.startProbe();\n      } // if we change content's transformY in a tick\n    // such as: 0 -> 50px -> 0\n    // transitionend will not be triggered\n    // so we forceupdate by reflow\n\n\n    if (!time) {\n      this._reflow = this.content.offsetHeight;\n    } // no need to dispatch move and end when slient\n\n\n    if (!time && !isSlient) {\n      this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n    }\n  };\n\n  Transition.prototype.stop = function () {\n    // still in transition\n    if (this.pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n\n      var _a = this.translater.getComputedPosition(),\n          x = _a.x,\n          y = _a.y;\n\n      this.transitionTime();\n      this.translate({\n        x: x,\n        y: y\n      });\n      this.setForceStopped(true);\n\n      if (this.hooks.trigger(this.hooks.eventTypes.beforeForceStop, {\n        x: x,\n        y: y\n      })) {\n        return;\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, {\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  return Transition;\n}(Base);\n\nvar Animation =\n/** @class */\nfunction (_super) {\n  __extends(Animation, _super);\n\n  function Animation() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Animation.prototype.move = function (startPoint, endPoint, time, easingFn, isSlient) {\n    // time is 0\n    if (!time) {\n      this.translate(endPoint); // if we change content's transformY in a tick\n      // such as: 0 -> 50px -> 0\n      // transitionend will not be triggered\n      // so we forceupdate by reflow\n\n      this._reflow = this.content.offsetHeight; // no need to dispatch move and end when slient\n\n      if (isSlient) return;\n      this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n      return;\n    }\n\n    this.animate(startPoint, endPoint, time, easingFn);\n  };\n\n  Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\n    var _this = this;\n\n    var startTime = getNow();\n    var destTime = startTime + duration;\n\n    var step = function () {\n      var now = getNow(); // js animation end\n\n      if (now >= destTime) {\n        _this.translate(endPoint);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n\n        return;\n      }\n\n      now = (now - startTime) / duration;\n      var easing = easingFn(now);\n      var newPoint = {};\n      Object.keys(endPoint).forEach(function (key) {\n        var startValue = startPoint[key];\n        var endValue = endPoint[key];\n        newPoint[key] = (endValue - startValue) * easing + startValue;\n      });\n\n      _this.translate(newPoint);\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(step);\n      }\n\n      if (_this.options.probeType === 3\n      /* Realtime */\n      ) {\n          _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\n        }\n    };\n\n    this.setPending(true);\n    cancelAnimationFrame(this.timer);\n    step();\n  };\n\n  Animation.prototype.stop = function () {\n    // still in requestFrameAnimation\n    if (this.pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n      var pos = this.translater.getComputedPosition();\n      this.setForceStopped(true);\n\n      if (this.hooks.trigger(this.hooks.eventTypes.beforeForceStop, pos)) {\n        return;\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\n    }\n  };\n\n  return Animation;\n}(Base);\n\nfunction createAnimater(element, translater, options) {\n  var useTransition = options.useTransition;\n  var animaterOptions = {};\n  Object.defineProperty(animaterOptions, 'probeType', {\n    enumerable: true,\n    configurable: false,\n    get: function () {\n      return options.probeType;\n    }\n  });\n\n  if (useTransition) {\n    return new Transition(element, translater, animaterOptions);\n  } else {\n    return new Animation(element, translater, animaterOptions);\n  }\n}\n\nvar Behavior =\n/** @class */\nfunction () {\n  function Behavior(wrapper, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['momentum', 'end']);\n    this.content = this.wrapper.children[0];\n    this.currentPos = 0;\n    this.startPos = 0;\n  }\n\n  Behavior.prototype.start = function () {\n    this.direction = 0\n    /* Default */\n    ;\n    this.movingDirection = 0\n    /* Default */\n    ;\n    this.dist = 0;\n  };\n\n  Behavior.prototype.move = function (delta) {\n    delta = this.hasScroll ? delta : 0;\n    this.movingDirection = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    var newPos = this.currentPos + delta; // Slow down or stop if outside of the boundaries\n\n    if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\n      if (newPos > this.minScrollPos && this.options.bounces[0] || newPos < this.maxScrollPos && this.options.bounces[1]) {\n        newPos = this.currentPos + delta / 3;\n      } else {\n        newPos = newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\n      }\n    }\n\n    return newPos;\n  };\n\n  Behavior.prototype.end = function (duration) {\n    var momentumInfo = {\n      duration: 0\n    };\n    var absDist = Math.abs(this.currentPos - this.startPos); // start momentum animation if needed\n\n    if (this.options.momentum && duration < this.options.momentumLimitTime && absDist > this.options.momentumLimitDistance) {\n      var wrapperSize = this.direction === -1\n      /* Negative */\n      && this.options.bounces[0] || this.direction === 1\n      /* Positive */\n      && this.options.bounces[1] ? this.wrapperSize : 0;\n      momentumInfo = this.hasScroll ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options) : {\n        destination: this.currentPos,\n        duration: 0\n      };\n    } else {\n      this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\n    }\n\n    return momentumInfo;\n  };\n\n  Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\n    if (options === void 0) {\n      options = this.options;\n    }\n\n    var distance = current - start;\n    var speed = Math.abs(distance) / time;\n    var deceleration = options.deceleration,\n        swipeBounceTime = options.swipeBounceTime,\n        swipeTime = options.swipeTime;\n    var momentumData = {\n      destination: current + speed / deceleration * (distance < 0 ? -1 : 1),\n      duration: swipeTime,\n      rate: 15\n    };\n    this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\n\n    if (momentumData.destination < lowerMargin) {\n      momentumData.destination = wrapperSize ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - wrapperSize / momentumData.rate * speed) : lowerMargin;\n      momentumData.duration = swipeBounceTime;\n    } else if (momentumData.destination > upperMargin) {\n      momentumData.destination = wrapperSize ? Math.min(upperMargin + wrapperSize / 4, upperMargin + wrapperSize / momentumData.rate * speed) : upperMargin;\n      momentumData.duration = swipeBounceTime;\n    }\n\n    momentumData.destination = Math.round(momentumData.destination);\n    return momentumData;\n  };\n\n  Behavior.prototype.updateDirection = function () {\n    var absDist = Math.round(this.currentPos) - this.absStartPos;\n    this.direction = absDist > 0 ? -1\n    /* Negative */\n    : absDist < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.refresh = function () {\n    var _a = this.options.rect,\n        size = _a.size,\n        position = _a.position;\n    var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\n    var wrapperRect = getRect(this.wrapper);\n    this.wrapperSize = wrapperRect[size];\n    var contentRect = getRect(this.content);\n    this.contentSize = contentRect[size];\n    this.relativeOffset = contentRect[position];\n\n    if (isWrapperStatic) {\n      this.relativeOffset -= wrapperRect[position];\n    }\n\n    this.minScrollPos = 0;\n    this.maxScrollPos = this.wrapperSize - this.contentSize;\n\n    if (this.maxScrollPos < 0) {\n      this.maxScrollPos -= this.relativeOffset;\n      this.minScrollPos = -this.relativeOffset;\n    }\n\n    this.hasScroll = this.options.scrollable && this.maxScrollPos < this.minScrollPos;\n\n    if (!this.hasScroll) {\n      this.maxScrollPos = this.minScrollPos;\n      this.contentSize = this.wrapperSize;\n    }\n\n    this.direction = 0;\n  };\n\n  Behavior.prototype.updatePosition = function (pos) {\n    this.currentPos = pos;\n  };\n\n  Behavior.prototype.getCurrentPos = function () {\n    return Math.round(this.currentPos);\n  };\n\n  Behavior.prototype.checkInBoundary = function () {\n    var position = this.adjustPosition(this.currentPos);\n    var inBoundary = position === this.getCurrentPos();\n    return {\n      position: position,\n      inBoundary: inBoundary\n    };\n  }; // adjust position when out of boundary\n\n\n  Behavior.prototype.adjustPosition = function (pos) {\n    var roundPos = Math.round(pos);\n\n    if (!this.hasScroll || roundPos > this.minScrollPos) {\n      roundPos = this.minScrollPos;\n    } else if (roundPos < this.maxScrollPos) {\n      roundPos = this.maxScrollPos;\n    }\n\n    return roundPos;\n  };\n\n  Behavior.prototype.updateStartPos = function () {\n    this.startPos = this.currentPos;\n  };\n\n  Behavior.prototype.updateAbsStartPos = function () {\n    this.absStartPos = this.currentPos;\n  };\n\n  Behavior.prototype.resetStartPos = function () {\n    this.updateStartPos();\n    this.updateAbsStartPos();\n  };\n\n  Behavior.prototype.getAbsDist = function (delta) {\n    this.dist += delta;\n    return Math.abs(this.dist);\n  };\n\n  Behavior.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Behavior;\n}();\n\nvar _a, _b, _c, _d;\n\nvar PassthroughHandlers = (_a = {}, _a[\"yes\"\n/* Yes */\n] = function (e) {\n  return true;\n}, _a[\"no\"\n/* No */\n] = function (e) {\n  e.preventDefault();\n  return false;\n}, _a);\nvar DirectionMap = (_b = {}, _b[\"horizontal\"\n/* Horizontal */\n] = (_c = {}, _c[\"yes\"\n/* Yes */\n] = \"horizontal\"\n/* Horizontal */\n, _c[\"no\"\n/* No */\n] = \"vertical\"\n/* Vertical */\n, _c), _b[\"vertical\"\n/* Vertical */\n] = (_d = {}, _d[\"yes\"\n/* Yes */\n] = \"vertical\"\n/* Vertical */\n, _d[\"no\"\n/* No */\n] = \"horizontal\"\n/* Horizontal */\n, _d), _b);\n\nvar DirectionLockAction =\n/** @class */\nfunction () {\n  function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\n    this.directionLockThreshold = directionLockThreshold;\n    this.freeScroll = freeScroll;\n    this.eventPassthrough = eventPassthrough;\n    this.reset();\n  }\n\n  DirectionLockAction.prototype.reset = function () {\n    this.directionLocked = \"\"\n    /* Default */\n    ;\n  };\n\n  DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\n    this.computeDirectionLock(absDistX, absDistY);\n    return this.handleEventPassthrough(e);\n  };\n\n  DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\n    if (this.directionLocked === \"horizontal\"\n    /* Horizontal */\n    ) {\n        deltaY = 0;\n      } else if (this.directionLocked === \"vertical\"\n    /* Vertical */\n    ) {\n        deltaX = 0;\n      }\n\n    return {\n      deltaX: deltaX,\n      deltaY: deltaY\n    };\n  };\n\n  DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\n    // If you are scrolling in one direction, lock it\n    if (this.directionLocked === \"\"\n    /* Default */\n    && !this.freeScroll) {\n      if (absDistX > absDistY + this.directionLockThreshold) {\n        this.directionLocked = \"horizontal\"\n        /* Horizontal */\n        ; // lock horizontally\n      } else if (absDistY >= absDistX + this.directionLockThreshold) {\n        this.directionLocked = \"vertical\"\n        /* Vertical */\n        ; // lock vertically\n      } else {\n        this.directionLocked = \"none\"\n        /* None */\n        ; // no lock\n      }\n    }\n  };\n\n  DirectionLockAction.prototype.handleEventPassthrough = function (e) {\n    var handleMap = DirectionMap[this.directionLocked];\n\n    if (handleMap) {\n      if (this.eventPassthrough === handleMap[\"yes\"\n      /* Yes */\n      ]) {\n        return PassthroughHandlers[\"yes\"\n        /* Yes */\n        ](e);\n      } else if (this.eventPassthrough === handleMap[\"no\"\n      /* No */\n      ]) {\n        return PassthroughHandlers[\"no\"\n        /* No */\n        ](e);\n      }\n    }\n\n    return false;\n  };\n\n  return DirectionLockAction;\n}();\n\nvar ScrollerActions =\n/** @class */\nfunction () {\n  function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\n    this.hooks = new EventEmitter(['start', 'beforeMove', 'scrollStart', 'scroll', 'beforeEnd', 'end', 'scrollEnd']);\n    this.scrollBehaviorX = scrollBehaviorX;\n    this.scrollBehaviorY = scrollBehaviorY;\n    this.actionsHandler = actionsHandler;\n    this.animater = animater;\n    this.options = options;\n    this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\n    this.enabled = true;\n    this.bindActionsHandler();\n  }\n\n  ScrollerActions.prototype.bindActionsHandler = function () {\n    var _this = this; // [mouse|touch]start event\n\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleStart(e);\n    }); // [mouse|touch]move event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\n      var deltaX = _a.deltaX,\n          deltaY = _a.deltaY,\n          e = _a.e;\n      if (!_this.enabled) return true;\n      return _this.handleMove(deltaX, deltaY, e);\n    }); // [mouse|touch]end event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleEnd(e);\n    }); // click\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\n      // handle native click event\n      if (_this.enabled && !e._constructed) {\n        _this.handleClick(e);\n      }\n    });\n  };\n\n  ScrollerActions.prototype.handleStart = function (e) {\n    var timestamp = getNow();\n    this.moved = false;\n    this.startTime = timestamp;\n    this.directionLockAction.reset();\n    this.scrollBehaviorX.start();\n    this.scrollBehaviorY.start(); // force stopping last transition or animation\n\n    this.animater.stop();\n    this.scrollBehaviorX.resetStartPos();\n    this.scrollBehaviorY.resetStartPos();\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\n      return;\n    }\n\n    var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\n    var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\n    var timestamp = getNow(); // We need to move at least momentumLimitDistance pixels\n    // for the scrolling to initiate\n\n    if (this.checkMomentum(absDistX, absDistY, timestamp)) {\n      return true;\n    }\n\n    if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\n      this.actionsHandler.setInitiated();\n      return true;\n    }\n\n    var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\n    var newX = this.scrollBehaviorX.move(delta.deltaX);\n    var newY = this.scrollBehaviorY.move(delta.deltaY);\n\n    if (!this.moved) {\n      this.moved = true;\n      this.hooks.trigger(this.hooks.eventTypes.scrollStart);\n    }\n\n    this.animater.translate({\n      x: newX,\n      y: newY\n    });\n    this.dispatchScroll(timestamp);\n  };\n\n  ScrollerActions.prototype.dispatchScroll = function (timestamp) {\n    // dispatch scroll in interval time\n    if (timestamp - this.startTime > this.options.momentumLimitTime) {\n      // refresh time and starting position to initiate a momentum\n      this.startTime = timestamp;\n      this.scrollBehaviorX.updateStartPos();\n      this.scrollBehaviorY.updateStartPos();\n\n      if (this.options.probeType === 1\n      /* Throttle */\n      ) {\n          this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n        }\n    } // dispatch scroll all the time\n\n\n    if (this.options.probeType > 1\n    /* Throttle */\n    ) {\n        this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n      }\n  };\n\n  ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\n    return timestamp - this.endTime > this.options.momentumLimitTime && absDistY < this.options.momentumLimitDistance && absDistX < this.options.momentumLimitDistance;\n  };\n\n  ScrollerActions.prototype.handleEnd = function (e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\n      return;\n    }\n\n    var currentPos = this.getCurrentPos();\n    this.scrollBehaviorX.updateDirection();\n    this.scrollBehaviorY.updateDirection();\n\n    if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\n      return true;\n    }\n\n    this.animater.translate(currentPos);\n    this.endTime = getNow();\n    var duration = this.endTime - this.startTime;\n    this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\n  };\n\n  ScrollerActions.prototype.handleClick = function (e) {\n    if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  ScrollerActions.prototype.getCurrentPos = function () {\n    return {\n      x: this.scrollBehaviorX.getCurrentPos(),\n      y: this.scrollBehaviorY.getCurrentPos()\n    };\n  };\n\n  ScrollerActions.prototype.refresh = function () {\n    this.endTime = 0;\n  };\n\n  ScrollerActions.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return ScrollerActions;\n}();\n\nfunction createActionsHandlerOptions(bsOptions) {\n  var options = ['click', 'bindToWrapper', 'disableMouse', 'disableTouch', 'preventDefault', 'stopPropagation', 'tagException', 'preventDefaultException'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {});\n  return options;\n}\n\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\n  var options = ['momentum', 'momentumLimitTime', 'momentumLimitDistance', 'deceleration', 'swipeBounceTime', 'swipeTime'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {}); // add extra property\n\n  options.scrollable = bsOptions[extraProp];\n  options.bounces = bounces;\n  options.rect = rect;\n  return options;\n}\n\nfunction bubbling(source, target, events) {\n  events.forEach(function (event) {\n    var sourceEvent;\n    var targetEvent;\n\n    if (typeof event === 'string') {\n      sourceEvent = targetEvent = event;\n    } else {\n      sourceEvent = event.source;\n      targetEvent = event.target;\n    }\n\n    source.on(sourceEvent, function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return target.trigger.apply(target, [targetEvent].concat(args));\n    });\n  });\n}\n\nvar Scroller =\n/** @class */\nfunction () {\n  function Scroller(wrapper, options) {\n    this.hooks = new EventEmitter(['beforeStart', 'beforeMove', 'beforeScrollStart', 'scrollStart', 'scroll', 'beforeEnd', 'scrollEnd', 'refresh', 'touchEnd', 'end', 'flick', 'scrollCancel', 'momentum', 'scrollTo', 'ignoreDisMoveForSamePos', 'scrollToElement', 'resize']);\n    this.wrapper = wrapper;\n    this.content = wrapper.children[0];\n    this.options = options;\n    var _a = this.options.bounce,\n        _b = _a.left,\n        left = _b === void 0 ? true : _b,\n        _c = _a.right,\n        right = _c === void 0 ? true : _c,\n        _d = _a.top,\n        top = _d === void 0 ? true : _d,\n        _e = _a.bottom,\n        bottom = _e === void 0 ? true : _e; // direction X\n\n    this.scrollBehaviorX = new Behavior(wrapper, createBehaviorOptions(options, 'scrollX', [left, right], {\n      size: 'width',\n      position: 'left'\n    })); // direction Y\n\n    this.scrollBehaviorY = new Behavior(wrapper, createBehaviorOptions(options, 'scrollY', [top, bottom], {\n      size: 'height',\n      position: 'top'\n    }));\n    this.translater = new Translater(this.content);\n    this.animater = createAnimater(this.content, this.translater, this.options);\n    this.actionsHandler = new ActionsHandler(wrapper, createActionsHandlerOptions(this.options));\n    this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\n    var resizeHandler = this.resize.bind(this);\n    this.resizeRegister = new EventRegister(window, [{\n      name: 'orientationchange',\n      handler: resizeHandler\n    }, {\n      name: 'resize',\n      handler: resizeHandler\n    }]);\n    this.transitionEndRegister = new EventRegister(this.content, [{\n      name: style.transitionEnd,\n      handler: this.transitionEnd.bind(this)\n    }]);\n    this.init();\n  }\n\n  Scroller.prototype.init = function () {\n    var _this = this;\n\n    this.bindTranslater();\n    this.bindAnimater();\n    this.bindActions(); // enable pointer events when scrolling ends\n\n    this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\n      _this.togglePointerEvents(true);\n    });\n  };\n\n  Scroller.prototype.bindTranslater = function () {\n    var _this = this;\n\n    var hooks = this.translater.hooks;\n    hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\n      if (_this.options.translateZ) {\n        transformStyle.push(_this.options.translateZ);\n      }\n    }); // disable pointer events when scrolling\n\n    hooks.on(hooks.eventTypes.translate, function (pos) {\n      _this.updatePositions(pos);\n\n      _this.togglePointerEvents(false);\n    });\n  };\n\n  Scroller.prototype.bindAnimater = function () {\n    var _this = this; // reset position\n\n\n    this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\n      if (!_this.resetPosition(_this.options.bounceTime)) {\n        _this.animater.setPending(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n    });\n    bubbling(this.animater.hooks, this.hooks, [{\n      source: this.animater.hooks.eventTypes.move,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: this.animater.hooks.eventTypes.forceStop,\n      target: this.hooks.eventTypes.scrollEnd\n    }]);\n  };\n\n  Scroller.prototype.bindActions = function () {\n    var _this = this;\n\n    var actions = this.actions;\n    bubbling(actions.hooks, this.hooks, [{\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeStart\n    }, {\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeScrollStart // just for event api\n\n    }, {\n      source: actions.hooks.eventTypes.beforeMove,\n      target: this.hooks.eventTypes.beforeMove\n    }, {\n      source: actions.hooks.eventTypes.scrollStart,\n      target: this.hooks.eventTypes.scrollStart\n    }, {\n      source: actions.hooks.eventTypes.scroll,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: actions.hooks.eventTypes.beforeEnd,\n      target: this.hooks.eventTypes.beforeEnd\n    }]);\n    actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\n      _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\n\n      if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\n        return true;\n      } // check if it is a click operation\n\n\n      if (!actions.moved && _this.checkClick(e)) {\n        _this.animater.setForceStopped(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\n\n        return true;\n      }\n\n      _this.animater.setForceStopped(false); // reset if we are outside of the boundaries\n\n\n      if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\n        return true;\n      }\n    });\n    actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\n      var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\n      var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\n\n      if (_this.checkFlick(duration, deltaX, deltaY)) {\n        _this.hooks.trigger(_this.hooks.eventTypes.flick);\n\n        return;\n      }\n\n      if (_this.momentum(pos, duration)) {\n        return;\n      }\n\n      _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n    });\n  };\n\n  Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\n    // flick\n    if (this.hooks.events.flick.length > 1 && duration < this.options.flickLimitTime && deltaX < this.options.flickLimitDistance && deltaY < this.options.flickLimitDistance) {\n      return true;\n    }\n  };\n\n  Scroller.prototype.momentum = function (pos, duration) {\n    var meta = {\n      time: 0,\n      easing: ease.swiper,\n      newX: pos.x,\n      newY: pos.y\n    }; // start momentum animation if needed\n\n    var momentumX = this.scrollBehaviorX.end(duration);\n    var momentumY = this.scrollBehaviorY.end(duration);\n    meta.newX = isUndef(momentumX.destination) ? meta.newX : momentumX.destination;\n    meta.newY = isUndef(momentumY.destination) ? meta.newY : momentumY.destination;\n    meta.time = Math.max(momentumX.duration, momentumY.duration);\n    this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this); // when x or y changed, do momentum animation now!\n\n    if (meta.newX !== pos.x || meta.newY !== pos.y) {\n      // change easing function when scroller goes out of the boundaries\n      if (meta.newX > this.scrollBehaviorX.minScrollPos || meta.newX < this.scrollBehaviorX.maxScrollPos || meta.newY > this.scrollBehaviorY.minScrollPos || meta.newY < this.scrollBehaviorY.maxScrollPos) {\n        meta.easing = ease.swipeBounce;\n      }\n\n      this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\n      return true;\n    }\n  };\n\n  Scroller.prototype.checkClick = function (e) {\n    // when in the process of pulling down, it should not prevent click\n    var cancelable = {\n      preventClick: this.animater.forceStopped\n    }; // we scrolled less than momentumLimitDistance pixels\n\n    if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) return true;\n\n    if (!cancelable.preventClick) {\n      var _dblclick = this.options.dblclick;\n      var dblclickTrigged = false;\n\n      if (_dblclick && this.lastClickTime) {\n        var _a = _dblclick.delay,\n            delay = _a === void 0 ? 300 : _a;\n\n        if (getNow() - this.lastClickTime < delay) {\n          dblclickTrigged = true;\n          dblclick(e);\n        }\n      }\n\n      if (this.options.tap) {\n        tap(e, this.options.tap);\n      }\n\n      if (this.options.click && !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n        click(e);\n      }\n\n      this.lastClickTime = dblclickTrigged ? null : getNow();\n      return true;\n    }\n\n    return false;\n  };\n\n  Scroller.prototype.resize = function () {\n    var _this = this;\n\n    if (!this.actions.enabled) {\n      return;\n    } // fix a scroll problem under Android condition\n\n\n    if (isAndroid) {\n      this.wrapper.scrollTop = 0;\n    }\n\n    if (!this.hooks.trigger(this.hooks.eventTypes.resize)) {\n      clearTimeout(this.resizeTimeout);\n      this.resizeTimeout = window.setTimeout(function () {\n        _this.refresh();\n      }, this.options.resizePolling);\n    }\n  };\n\n  Scroller.prototype.transitionEnd = function (e) {\n    if (e.target !== this.content || !this.animater.pending) {\n      return;\n    }\n\n    var animater = this.animater;\n    animater.transitionTime();\n\n    if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\n      this.animater.setPending(false);\n\n      if (this.options.probeType !== 3\n      /* Realtime */\n      ) {\n          this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\n        }\n    }\n  };\n\n  Scroller.prototype.togglePointerEvents = function (enabled) {\n    if (enabled === void 0) {\n      enabled = true;\n    }\n\n    var el = this.content.children.length ? this.content.children : [this.content];\n    var pointerEvents = enabled ? 'auto' : 'none';\n\n    for (var i = 0; i < el.length; i++) {\n      var node = el[i]; // ignore BetterScroll instance's wrapper DOM\n\n      if (node.isBScrollContainer) {\n        continue;\n      }\n\n      node.style.pointerEvents = pointerEvents;\n    }\n  };\n\n  Scroller.prototype.refresh = function () {\n    this.scrollBehaviorX.refresh();\n    this.scrollBehaviorY.refresh();\n    this.actions.refresh();\n    this.wrapperOffset = offset(this.wrapper);\n  };\n\n  Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var _a = this.getCurrentPos(),\n        x = _a.x,\n        y = _a.y;\n\n    easing = !easing ? ease.bounce : easing;\n    deltaX += x;\n    deltaY += y;\n    this.scrollTo(deltaX, deltaY, time, easing);\n  };\n\n  Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform, isSilent) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (extraTransform === void 0) {\n      extraTransform = {\n        start: {},\n        end: {}\n      };\n    }\n\n    easing = !easing ? ease.bounce : easing;\n    var easingFn = this.options.useTransition ? easing.style : easing.fn;\n    var currentPos = this.getCurrentPos();\n\n    var startPoint = __assign({\n      x: currentPos.x,\n      y: currentPos.y\n    }, extraTransform.start);\n\n    var endPoint = __assign({\n      x: x,\n      y: y\n    }, extraTransform.end);\n\n    this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\n\n    if (!this.hooks.trigger(this.hooks.eventTypes.ignoreDisMoveForSamePos)) {\n      // it is an useless move\n      if (startPoint.x === endPoint.x && startPoint.y === endPoint.y) {\n        return;\n      }\n    }\n\n    this.animater.move(startPoint, endPoint, time, easingFn, isSilent);\n  };\n\n  Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\n    var targetEle = getElement(el);\n    var pos = offset(targetEle);\n\n    var getOffset = function (offset, size, wrapperSize) {\n      if (typeof offset === 'number') {\n        return offset;\n      } // if offsetX/Y are true we center the element to the screen\n\n\n      return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\n    };\n\n    offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\n    offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\n\n    var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\n      pos -= wrapperPos;\n      pos = scrollBehavior.adjustPosition(pos - offset);\n      return pos;\n    };\n\n    pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\n    pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\n      return;\n    }\n\n    this.scrollTo(pos.left, pos.top, time, easing);\n  };\n\n  Scroller.prototype.resetPosition = function (time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    easing = !easing ? ease.bounce : easing;\n\n    var _a = this.scrollBehaviorX.checkInBoundary(),\n        x = _a.position,\n        xInBoundary = _a.inBoundary;\n\n    var _b = this.scrollBehaviorY.checkInBoundary(),\n        y = _b.position,\n        yInBoundary = _b.inBoundary;\n\n    if (xInBoundary && yInBoundary) {\n      return false;\n    } // fix ios 13.4 bouncing\n    // see it in issues 982\n\n\n    this._reflow = this.content.offsetHeight; // out of boundary\n\n    this.scrollTo(x, y, time, easing);\n    return true;\n  };\n\n  Scroller.prototype.updatePositions = function (pos) {\n    this.scrollBehaviorX.updatePosition(pos.x);\n    this.scrollBehaviorY.updatePosition(pos.y);\n  };\n\n  Scroller.prototype.getCurrentPos = function () {\n    return this.actions.getCurrentPos();\n  };\n\n  Scroller.prototype.enable = function () {\n    this.actions.enabled = true;\n  };\n\n  Scroller.prototype.disable = function () {\n    cancelAnimationFrame(this.animater.timer);\n    this.actions.enabled = false;\n  };\n\n  Scroller.prototype.destroy = function () {\n    var _this = this;\n\n    var keys = ['resizeRegister', 'transitionEndRegister', 'actionsHandler', 'actions', 'hooks', 'animater', 'translater', 'scrollBehaviorX', 'scrollBehaviorY'];\n    keys.forEach(function (key) {\n      return _this[key].destroy();\n    });\n  };\n\n  return Scroller;\n}();\n\nvar propertiesConfig = [{\n  sourceKey: 'scroller.scrollBehaviorX.currentPos',\n  key: 'x'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.currentPos',\n  key: 'y'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.hasScroll',\n  key: 'hasHorizontalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.hasScroll',\n  key: 'hasVerticalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.contentSize',\n  key: 'scrollerWidth'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.contentSize',\n  key: 'scrollerHeight'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\n  key: 'maxScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\n  key: 'maxScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\n  key: 'minScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\n  key: 'minScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.movingDirection',\n  key: 'movingDirectionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.movingDirection',\n  key: 'movingDirectionY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.direction',\n  key: 'directionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.direction',\n  key: 'directionY'\n}, {\n  sourceKey: 'scroller.actions.enabled',\n  key: 'enabled'\n}, {\n  sourceKey: 'scroller.animater.pending',\n  key: 'pending'\n}, {\n  sourceKey: 'scroller.animater.stop',\n  key: 'stop'\n}, {\n  sourceKey: 'scroller.scrollTo',\n  key: 'scrollTo'\n}, {\n  sourceKey: 'scroller.scrollBy',\n  key: 'scrollBy'\n}, {\n  sourceKey: 'scroller.scrollToElement',\n  key: 'scrollToElement'\n}, {\n  sourceKey: 'scroller.resetPosition',\n  key: 'resetPosition'\n}];\n\nvar BScroll =\n/** @class */\nfunction (_super) {\n  __extends(BScroll, _super);\n\n  function BScroll(el, options) {\n    var _this = _super.call(this, ['refresh', 'enable', 'disable', 'beforeScrollStart', 'scrollStart', 'scroll', 'scrollEnd', 'scrollCancel', 'touchEnd', 'flick', 'destroy']) || this;\n\n    var wrapper = getElement(el);\n\n    if (!wrapper) {\n      warn('Can not resolve the wrapper DOM.');\n      return _this;\n    }\n\n    var content = wrapper.children[0];\n\n    if (!content) {\n      warn('The wrapper need at least one child element to be scroller.');\n      return _this;\n    }\n\n    _this.plugins = {};\n    _this.options = new Options().merge(options).process();\n    _this.hooks = new EventEmitter(['init', 'refresh', 'enable', 'disable', 'destroy']);\n\n    _this.init(wrapper);\n\n    return _this;\n  }\n\n  BScroll.use = function (ctor) {\n    var name = ctor.pluginName;\n    var installed = this.plugins.some(function (plugin) {\n      return ctor === plugin.ctor;\n    });\n    if (installed) return this;\n\n    if (isUndef(name)) {\n      warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\n      return this;\n    }\n\n    if (this.pluginsMap[name]) {\n      warn(\"This plugin has been registered, maybe you need change plugin's name\");\n      return this;\n    }\n\n    this.pluginsMap[name] = true;\n    this.plugins.push({\n      name: name,\n      applyOrder: ctor.applyOrder,\n      ctor: ctor\n    });\n    return this;\n  };\n\n  BScroll.prototype.init = function (wrapper) {\n    this.wrapper = wrapper;\n    wrapper.isBScrollContainer = true;\n    this.scroller = new Scroller(wrapper, this.options);\n    this.eventBubbling();\n    this.handleAutoBlur();\n    this.innerRefresh();\n    this.scroller.scrollTo(this.options.startX, this.options.startY);\n    this.enable();\n    this.proxy(propertiesConfig);\n    this.applyPlugins();\n  };\n\n  BScroll.prototype.applyPlugins = function () {\n    var _this = this;\n\n    var options = this.options;\n    this.constructor.plugins.sort(function (a, b) {\n      var _a;\n\n      var applyOrderMap = (_a = {}, _a[\"pre\"\n      /* Pre */\n      ] = -1, _a[\"post\"\n      /* Post */\n      ] = 1, _a);\n      var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\n      var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\n      return aOrder - bOrder;\n    }).forEach(function (item) {\n      var ctor = item.ctor;\n\n      if (options[item.name] && typeof ctor === 'function') {\n        _this.plugins[item.name] = new ctor(_this);\n      }\n    });\n  };\n\n  BScroll.prototype.handleAutoBlur = function () {\n    if (this.options.autoBlur) {\n      this.on(this.eventTypes.beforeScrollStart, function () {\n        var activeElement = document.activeElement;\n\n        if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) {\n          activeElement.blur();\n        }\n      });\n    }\n  };\n\n  BScroll.prototype.eventBubbling = function () {\n    bubbling(this.scroller.hooks, this, ['beforeScrollStart', 'scrollStart', 'scroll', 'scrollEnd', 'scrollCancel', 'touchEnd', 'flick']);\n  };\n\n  BScroll.prototype.innerRefresh = function () {\n    this.scroller.refresh();\n    this.hooks.trigger(this.hooks.eventTypes.refresh);\n    this.trigger(this.eventTypes.refresh);\n  };\n\n  BScroll.prototype.proxy = function (propertiesConfig) {\n    var _this = this;\n\n    propertiesConfig.forEach(function (_a) {\n      var key = _a.key,\n          sourceKey = _a.sourceKey;\n      propertiesProxy(_this, sourceKey, key);\n    });\n  };\n\n  BScroll.prototype.refresh = function () {\n    this.innerRefresh();\n    this.scroller.resetPosition();\n  };\n\n  BScroll.prototype.enable = function () {\n    this.scroller.enable();\n    this.hooks.trigger(this.hooks.eventTypes.enable);\n    this.trigger(this.eventTypes.enable);\n  };\n\n  BScroll.prototype.disable = function () {\n    this.scroller.disable();\n    this.hooks.trigger(this.hooks.eventTypes.disable);\n    this.trigger(this.eventTypes.disable);\n  };\n\n  BScroll.prototype.destroy = function () {\n    this.hooks.trigger(this.hooks.eventTypes.destroy);\n    this.trigger(this.eventTypes.destroy);\n    this.scroller.destroy();\n  };\n\n  BScroll.prototype.eventRegister = function (names) {\n    this.registerType(names);\n  };\n\n  BScroll.plugins = [];\n  BScroll.pluginsMap = {};\n  return BScroll;\n}(EventEmitter);\n\nvar MouseWheel =\n/** @class */\nfunction () {\n  function MouseWheel(scroll) {\n    this.scroll = scroll;\n    this.wheelStart = false;\n    scroll.registerType(['mousewheelMove', 'mousewheelStart', 'mousewheelEnd']);\n    this.mouseWheelOpt = scroll.options.mouseWheel;\n    this.deltaCache = [];\n    this.registorEvent();\n    this.hooksFn = [];\n    this.registorHooks(scroll.hooks, 'destroy', this.destroy);\n  }\n\n  MouseWheel.prototype.destroy = function () {\n    this.eventRegistor.destroy();\n    window.clearTimeout(this.wheelEndTimer);\n    window.clearTimeout(this.wheelMoveTimer);\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n  };\n\n  MouseWheel.prototype.registorEvent = function () {\n    this.eventRegistor = new EventRegister(this.scroll.scroller.wrapper, [{\n      name: 'wheel',\n      handler: this.wheelHandler.bind(this)\n    }, {\n      name: 'mousewheel',\n      handler: this.wheelHandler.bind(this)\n    }, {\n      name: 'DOMMouseScroll',\n      handler: this.wheelHandler.bind(this)\n    }]);\n  };\n\n  MouseWheel.prototype.wheelHandler = function (e) {\n    this.beforeHandler(e); // start\n\n    if (!this.wheelStart) {\n      this.wheelStartHandler(e);\n      this.wheelStart = true;\n    } // move\n\n\n    var delta = this.getWheelDelta(e);\n    this.wheelMove(delta); // end\n\n    this.wheelStopDetactor(e, delta);\n  };\n\n  MouseWheel.prototype.wheelStartHandler = function (e) {\n    this.deltaCache = [];\n    this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\n  };\n\n  MouseWheel.prototype.wheelStopDetactor = function (e, delta) {\n    var _this = this;\n\n    window.clearTimeout(this.wheelEndTimer);\n    var delayTime = this.mouseWheelOpt.throttle || 400;\n    this.wheelEndTimer = window.setTimeout(function () {\n      _this.wheelStart = false;\n      window.clearTimeout(_this.wheelMoveTimer);\n      _this.wheelMoveTimer = 0;\n\n      _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\n    }, delayTime);\n  };\n\n  MouseWheel.prototype.getWheelDelta = function (e) {\n    var _a = this.mouseWheelOpt,\n        _b = _a.speed,\n        speed = _b === void 0 ? 20 : _b,\n        _c = _a.invert,\n        invert = _c === void 0 ? false : _c;\n    var wheelDeltaX = 0;\n    var wheelDeltaY = 0;\n    var direction = invert ? -1\n    /* Negative */\n    : 1\n    /* Positive */\n    ;\n\n    switch (true) {\n      case 'deltaX' in e:\n        if (e.deltaMode === 1) {\n          wheelDeltaX = -e.deltaX * speed;\n          wheelDeltaY = -e.deltaY * speed;\n        } else {\n          wheelDeltaX = -e.deltaX;\n          wheelDeltaY = -e.deltaY;\n        }\n\n        break;\n\n      case 'wheelDeltaX' in e:\n        wheelDeltaX = e.wheelDeltaX / 120 * speed;\n        wheelDeltaY = e.wheelDeltaY / 120 * speed;\n        break;\n\n      case 'wheelDelta' in e:\n        wheelDeltaX = wheelDeltaY = e.wheelDelta / 120 * speed;\n        break;\n\n      case 'detail' in e:\n        wheelDeltaX = wheelDeltaY = -e.detail / 3 * speed;\n        break;\n    }\n\n    wheelDeltaX *= direction;\n    wheelDeltaY *= direction;\n\n    if (!this.scroll.scroller.scrollBehaviorY.hasScroll) {\n      wheelDeltaX = wheelDeltaY;\n      wheelDeltaY = 0;\n    }\n\n    if (!this.scroll.scroller.scrollBehaviorX.hasScroll) {\n      wheelDeltaX = 0;\n    }\n\n    var directionX = wheelDeltaX > 0 ? -1\n    /* Negative */\n    : wheelDeltaX < 0 ? 1\n    /* Positive */\n    : 0;\n    var directionY = wheelDeltaY > 0 ? -1\n    /* Negative */\n    : wheelDeltaY < 0 ? 1\n    /* Positive */\n    : 0;\n    return {\n      x: wheelDeltaX,\n      y: wheelDeltaY,\n      directionX: directionX,\n      directionY: directionY\n    };\n  };\n\n  MouseWheel.prototype.beforeHandler = function (e) {\n    var _a = this.scroll.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n\n    if (preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException)) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  MouseWheel.prototype.wheelMove = function (delta) {\n    var _this = this;\n\n    if (this.mouseWheelOpt.debounce && this.wheelMoveTimer) {\n      this.deltaCache.push(delta);\n    } else {\n      var cachedDelta = this.deltaCache.reduce(function (prev, current) {\n        return {\n          x: prev.x + current.x,\n          y: prev.y + current.y\n        };\n      }, {\n        x: 0,\n        y: 0\n      });\n      this.deltaCache = [];\n      var newX = this.scroll.x + Math.round(delta.x) + cachedDelta.x;\n      var newY = this.scroll.y + Math.round(delta.y) + cachedDelta.y;\n      var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\n      var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n      newX = fixInboundValue(newX, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos);\n      newY = fixInboundValue(newY, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos);\n\n      if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\n        x: newX,\n        y: newY\n      })) {\n        var easeTime = this.getEaseTime();\n\n        if (newX !== this.scroll.x || newY !== this.scroll.y) {\n          this.scroll.scrollTo(newX, newY, easeTime);\n        }\n      }\n\n      if (this.mouseWheelOpt.debounce) {\n        this.wheelMoveTimer = window.setTimeout(function () {\n          _this.wheelMoveTimer = 0;\n        }, this.mouseWheelOpt.debounce);\n      }\n    }\n  };\n\n  MouseWheel.prototype.registorHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  MouseWheel.prototype.getEaseTime = function () {\n    var DEFAULT_EASETIME = 300;\n    var SAFE_EASETIME = 100;\n    var easeTime = this.mouseWheelOpt.easeTime || DEFAULT_EASETIME; // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\n    // easeTime needs to be greater than 100\n\n    if (easeTime < SAFE_EASETIME) {\n      warn(\"easeTime should be greater than 100.\\n      If mouseWheel easeTime is too small, scrollEnd will be triggered many times.\");\n    }\n\n    return easeTime;\n  };\n\n  MouseWheel.pluginName = 'mouseWheel';\n  MouseWheel.applyOrder = \"pre\"\n  /* Pre */\n  ;\n  return MouseWheel;\n}();\n\nvar ObserveDOM =\n/** @class */\nfunction () {\n  function ObserveDOM(scroll) {\n    var _this = this;\n\n    this.scroll = scroll;\n    this.stopObserver = false;\n    this.hooksFn = [];\n    this.init();\n    this.registorHooks(this.scroll.hooks, 'enable', function () {\n      if (_this.stopObserver) {\n        _this.init();\n      }\n    });\n    this.registorHooks(this.scroll.hooks, 'disable', function () {\n      _this.stopObserve();\n    });\n    this.registorHooks(this.scroll.hooks, 'destroy', function () {\n      _this.destroy();\n    });\n  }\n\n  ObserveDOM.prototype.init = function () {\n    var _this = this;\n\n    if (typeof MutationObserver !== 'undefined') {\n      var timer_1 = 0;\n      this.observer = new MutationObserver(function (mutations) {\n        _this.mutationObserverHandler(mutations, timer_1);\n      });\n      this.startObserve(this.observer);\n    } else {\n      this.checkDOMUpdate();\n    }\n  };\n\n  ObserveDOM.prototype.destroy = function () {\n    this.stopObserve();\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  ObserveDOM.prototype.mutationObserverHandler = function (mutations, timer) {\n    var _this = this;\n\n    if (this.shouldNotRefresh()) {\n      return;\n    }\n\n    var immediateRefresh = false;\n    var deferredRefresh = false;\n\n    for (var i = 0; i < mutations.length; i++) {\n      var mutation = mutations[i];\n\n      if (mutation.type !== 'attributes') {\n        immediateRefresh = true;\n        break;\n      } else {\n        if (mutation.target !== this.scroll.scroller.content) {\n          deferredRefresh = true;\n          break;\n        }\n      }\n    }\n\n    if (immediateRefresh) {\n      this.scroll.refresh();\n    } else if (deferredRefresh) {\n      // attributes changes too often\n      clearTimeout(timer);\n      timer = window.setTimeout(function () {\n        if (!_this.shouldNotRefresh()) {\n          _this.scroll.refresh();\n        }\n      }, 60);\n    }\n  };\n\n  ObserveDOM.prototype.startObserve = function (observer) {\n    var config = {\n      attributes: true,\n      childList: true,\n      subtree: true\n    };\n    observer.observe(this.scroll.scroller.content, config);\n  };\n\n  ObserveDOM.prototype.shouldNotRefresh = function () {\n    var _a = this.scroll,\n        plugins = _a.plugins,\n        scroller = _a.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY; // perform an pulldown action\n\n    var isPullingDown = (plugins.pullDownRefresh || {}).pulling;\n    var outsideBoundaries = scrollBehaviorX.currentPos > scrollBehaviorX.minScrollPos || scrollBehaviorX.currentPos < scrollBehaviorX.maxScrollPos || scrollBehaviorY.currentPos > scrollBehaviorY.minScrollPos || scrollBehaviorY.currentPos < scrollBehaviorY.maxScrollPos;\n    return scroller.animater.pending || outsideBoundaries || isPullingDown;\n  };\n\n  ObserveDOM.prototype.checkDOMUpdate = function () {\n    var me = this;\n    var scrollIns = this.scroll;\n    var scrollerEl = scrollIns.scroller.content;\n    var scrollerRect = getRect(scrollerEl);\n    var oldWidth = scrollerRect.width;\n    var oldHeight = scrollerRect.height;\n\n    function check() {\n      if (me.stopObserver) {\n        return;\n      }\n\n      scrollerRect = getRect(scrollerEl);\n      var newWidth = scrollerRect.width;\n      var newHeight = scrollerRect.height;\n\n      if (oldWidth !== newWidth || oldHeight !== newHeight) {\n        scrollIns.refresh();\n      }\n\n      oldWidth = newWidth;\n      oldHeight = newHeight;\n      next();\n    }\n\n    function next() {\n      setTimeout(function () {\n        check();\n      }, 1000);\n    }\n\n    next();\n  };\n\n  ObserveDOM.prototype.registorHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  ObserveDOM.prototype.stopObserve = function () {\n    this.stopObserver = true;\n\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n  };\n\n  ObserveDOM.pluginName = 'observeDOM';\n  return ObserveDOM;\n}();\n\nvar sourcePrefix = 'plugins.pullDownRefresh';\nvar propertiesMap = [{\n  key: 'finishPullDown',\n  name: 'finish'\n}, {\n  key: 'openPullDown',\n  name: 'open'\n}, {\n  key: 'closePullDown',\n  name: 'close'\n}, {\n  key: 'autoPullDownRefresh',\n  name: 'autoPull'\n}];\nvar propertiesProxyConfig = propertiesMap.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix + \".\" + item.name\n  };\n});\n\nvar PullDown =\n/** @class */\nfunction () {\n  function PullDown(scroll) {\n    this.scroll = scroll;\n    this.pulling = false;\n\n    if (scroll.options.pullDownRefresh) {\n      this._watch();\n    }\n\n    this.scroll.registerType(['pullingDown']);\n    this.scroll.proxy(propertiesProxyConfig);\n  }\n\n  PullDown.prototype._watch = function () {\n    // 需要设置 probe = 3 吗？\n    // must watch scroll in real time\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n    this.scroll.scroller.hooks.on('end', this._checkPullDown, this);\n  };\n\n  PullDown.prototype._checkPullDown = function () {\n    if (!this.scroll.options.pullDownRefresh) {\n      return;\n    }\n\n    var _a = this.scroll.options.pullDownRefresh,\n        _b = _a.threshold,\n        threshold = _b === void 0 ? 90 : _b,\n        _c = _a.stop,\n        stop = _c === void 0 ? 40 : _c; // check if a real pull down action\n\n    if (this.scroll.directionY !== -1\n    /* Negative */\n    || this.scroll.y < threshold) {\n      return false;\n    }\n\n    if (!this.pulling) {\n      this.pulling = true;\n      this.scroll.trigger('pullingDown');\n      this.originalMinScrollY = this.scroll.minScrollY;\n      this.scroll.minScrollY = stop;\n    }\n\n    this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\n    return this.pulling;\n  };\n\n  PullDown.prototype.finish = function () {\n    this.pulling = false;\n    this.scroll.minScrollY = this.originalMinScrollY;\n    this.scroll.resetPosition(this.scroll.options.bounceTime, ease.bounce);\n  };\n\n  PullDown.prototype.open = function (config) {\n    if (config === void 0) {\n      config = true;\n    }\n\n    this.scroll.options.pullDownRefresh = config;\n\n    this._watch();\n  };\n\n  PullDown.prototype.close = function () {\n    this.scroll.options.pullDownRefresh = false;\n  };\n\n  PullDown.prototype.autoPull = function () {\n    var _a = this.scroll.options.pullDownRefresh,\n        _b = _a.threshold,\n        threshold = _b === void 0 ? 90 : _b,\n        _c = _a.stop,\n        stop = _c === void 0 ? 40 : _c;\n\n    if (this.pulling) {\n      return;\n    }\n\n    this.pulling = true;\n    this.originalMinScrollY = this.scroll.minScrollY;\n    this.scroll.minScrollY = threshold;\n    this.scroll.scrollTo(this.scroll.x, threshold);\n    this.scroll.trigger('pullingDown');\n    this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\n  };\n\n  PullDown.pluginName = 'pullDownRefresh';\n  return PullDown;\n}();\n\nvar sourcePrefix$1 = 'plugins.pullUpLoad';\nvar propertiesMap$1 = [{\n  key: 'finishPullUp',\n  name: 'finish'\n}, {\n  key: 'openPullUp',\n  name: 'open'\n}, {\n  key: 'closePullUp',\n  name: 'close'\n}];\nvar propertiesProxyConfig$1 = propertiesMap$1.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$1 + \".\" + item.name\n  };\n});\n\nvar PullUp =\n/** @class */\nfunction () {\n  function PullUp(bscroll) {\n    this.bscroll = bscroll;\n    this.watching = false;\n\n    if (bscroll.options.pullUpLoad) {\n      this._watch();\n    }\n\n    this.bscroll.registerType(['pullingUp']);\n    this.bscroll.proxy(propertiesProxyConfig$1);\n  }\n\n  PullUp.prototype._watch = function () {\n    if (this.watching) {\n      return;\n    } // must watch scroll in real time\n\n\n    this.bscroll.options.probeType = 3\n    /* Realtime */\n    ;\n    this.watching = true;\n    this.bscroll.on('scroll', this._checkToEnd, this);\n  };\n\n  PullUp.prototype._checkToEnd = function (pos) {\n    var _this = this;\n\n    if (!this.bscroll.options.pullUpLoad) {\n      return;\n    }\n\n    var _a = this.bscroll.options.pullUpLoad.threshold,\n        threshold = _a === void 0 ? 0 : _a;\n\n    if (this.bscroll.movingDirectionY === 1\n    /* Positive */\n    && pos.y <= this.bscroll.maxScrollY + threshold) {\n      // reset pullupWatching status after scroll end to promise that trigger 'pullingUp' only once when pulling up\n      this.bscroll.once('scrollEnd', function () {\n        _this.watching = false;\n      });\n      this.bscroll.trigger('pullingUp');\n      this.bscroll.off('scroll', this._checkToEnd);\n    }\n  };\n\n  PullUp.prototype.finish = function () {\n    if (this.watching) {\n      this.bscroll.once('scrollEnd', this._watch, this);\n    } else {\n      this._watch();\n    }\n  };\n\n  PullUp.prototype.open = function (config) {\n    if (config === void 0) {\n      config = true;\n    }\n\n    this.bscroll.options.pullUpLoad = config;\n\n    this._watch();\n  };\n\n  PullUp.prototype.close = function () {\n    this.bscroll.options.pullUpLoad = false;\n\n    if (!this.watching) {\n      return;\n    }\n\n    this.watching = false;\n    this.bscroll.off('scroll', this._checkToEnd);\n  };\n\n  PullUp.pluginName = 'pullUpLoad';\n  return PullUp;\n}();\n\nvar EventHandler =\n/** @class */\nfunction () {\n  function EventHandler(indicator, options) {\n    this.indicator = indicator;\n    this.options = options;\n    this.bscroll = indicator.bscroll;\n    this.startEventRegister = new EventRegister(this.indicator.el, [{\n      name: options.disableMouse ? 'touchstart' : 'mousedown',\n      handler: this._start.bind(this)\n    }]);\n    this.endEventRegister = new EventRegister(window, [{\n      name: options.disableMouse ? 'touchend' : 'mouseup',\n      handler: this._end.bind(this)\n    }]);\n    this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\n  }\n\n  EventHandler.prototype._start = function (e) {\n    var point = e.touches ? e.touches[0] : e;\n    e.preventDefault();\n    e.stopPropagation();\n    this.initiated = true;\n    this.moved = false;\n    this.lastPoint = point[this.indicator.keysMap.pointPos];\n    var disableMouse = this.bscroll.options.disableMouse;\n    this.moveEventRegister = new EventRegister(window, [{\n      name: disableMouse ? 'touchmove' : 'mousemove',\n      handler: this._move.bind(this)\n    }]);\n    this.hooks.trigger('touchStart');\n  };\n\n  EventHandler.prototype._move = function (e) {\n    var point = e.touches ? e.touches[0] : e;\n    var pointPos = point[this.indicator.keysMap.pointPos];\n    e.preventDefault();\n    e.stopPropagation();\n    var delta = pointPos - this.lastPoint;\n    this.lastPoint = pointPos;\n\n    if (!this.moved) {\n      this.hooks.trigger('touchMove', this.moved, delta);\n      this.moved = true;\n      return;\n    }\n\n    this.hooks.trigger('touchMove', this.moved, delta);\n  };\n\n  EventHandler.prototype._end = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    this.initiated = false;\n    e.preventDefault();\n    e.stopPropagation();\n    this.moveEventRegister.destroy();\n    this.hooks.trigger('touchEnd', this.moved);\n  };\n\n  EventHandler.prototype.destroy = function () {\n    this.startEventRegister.destroy();\n    this.moveEventRegister && this.moveEventRegister.destroy();\n    this.endEventRegister.destroy();\n  };\n\n  return EventHandler;\n}();\n\nvar INDICATOR_MIN_LEN = 8;\n\nvar Indicator =\n/** @class */\nfunction () {\n  function Indicator(bscroll, options) {\n    this.bscroll = bscroll;\n    this.options = options;\n    this.keyVals = {\n      sizeRatio: 1,\n      maxPos: 0,\n      initialSize: 0\n    };\n    this.curPos = 0;\n    this.hooksHandlers = [];\n    this.wrapper = options.wrapper;\n    this.wrapperStyle = this.wrapper.style;\n    this.el = this.wrapper.children[0];\n    this.elStyle = this.el.style;\n    this.bscroll = bscroll;\n    this.direction = options.direction;\n    this.keysMap = this._getKeysMap();\n\n    if (options.fade) {\n      this.visible = 0;\n      this.wrapperStyle.opacity = '0';\n    } else {\n      this.visible = 1;\n    }\n\n    this._listenHooks(options.fade, options.interactive);\n\n    this.refresh();\n  }\n\n  Indicator.prototype._listenHooks = function (fade, interactive) {\n    var _this = this;\n\n    var bscroll = this.bscroll;\n    var bscrollHooks = bscroll;\n    var translaterHooks = bscroll.scroller.translater.hooks;\n    var animaterHooks = bscroll.scroller.animater.hooks;\n\n    this._listen(bscrollHooks, 'refresh', this.refresh);\n\n    this._listen(translaterHooks, 'translate', this.updatePosAndSize);\n\n    this._listen(animaterHooks, 'time', function (time) {\n      _this.setTransitionTime(time);\n    });\n\n    this._listen(animaterHooks, 'timeFunction', function (ease) {\n      _this.setTransitionTimingFunction(ease);\n    });\n\n    if (fade) {\n      this._listen(bscrollHooks, 'scrollEnd', function () {\n        _this.fade();\n      });\n\n      this._listen(bscrollHooks, 'scrollStart', function () {\n        _this.fade(true);\n      }); // for mousewheel event\n\n\n      if (bscroll.eventTypes.mousewheelStart && bscroll.eventTypes.mousewheelEnd) {\n        this._listen(bscrollHooks, 'mousewheelStart', function () {\n          _this.fade(true);\n        });\n\n        this._listen(bscrollHooks, 'mousewheelEnd', function () {\n          _this.fade();\n        });\n      }\n    }\n\n    if (interactive) {\n      var disableMouse = this.bscroll.options.disableMouse;\n      this.eventHandler = new EventHandler(this, {\n        disableMouse: disableMouse\n      });\n      var eventHandlerHooks = this.eventHandler.hooks;\n\n      this._listen(eventHandlerHooks, 'touchStart', this.startHandler);\n\n      this._listen(eventHandlerHooks, 'touchMove', this.moveHandler);\n\n      this._listen(eventHandlerHooks, 'touchEnd', this.endHandler);\n    }\n  };\n\n  Indicator.prototype._getKeysMap = function () {\n    if (this.direction === \"vertical\"\n    /* Vertical */\n    ) {\n        return {\n          hasScroll: 'hasVerticalScroll',\n          size: 'height',\n          wrapperSize: 'clientHeight',\n          scrollerSize: 'scrollerHeight',\n          maxScroll: 'maxScrollY',\n          pos: 'y',\n          pointPos: 'pageY',\n          translate: 'translateY'\n        };\n      }\n\n    return {\n      hasScroll: 'hasHorizontalScroll',\n      size: 'width',\n      wrapperSize: 'clientWidth',\n      scrollerSize: 'scrollerWidth',\n      maxScroll: 'maxScrollX',\n      pos: 'x',\n      pointPos: 'pageX',\n      translate: 'translateX'\n    };\n  };\n\n  Indicator.prototype.fade = function (visible) {\n    var time = visible ? 250 : 500;\n    this.wrapperStyle[style.transitionDuration] = time + 'ms';\n    this.wrapperStyle.opacity = visible ? '1' : '0';\n    this.visible = visible ? 1 : 0;\n  };\n\n  Indicator.prototype.refresh = function () {\n    var hasScroll = this.keysMap.hasScroll;\n\n    if (this._setShowBy(this.bscroll[hasScroll])) {\n      var _a = this.keysMap,\n          wrapperSize = _a.wrapperSize,\n          scrollerSize = _a.scrollerSize,\n          maxScroll = _a.maxScroll;\n      this.keyVals = this._refreshKeyValues(this.wrapper[wrapperSize], this.bscroll[scrollerSize], this.bscroll[maxScroll]);\n      this.updatePosAndSize({\n        x: this.bscroll.x,\n        y: this.bscroll.y\n      });\n    }\n  };\n\n  Indicator.prototype._setShowBy = function (hasScroll) {\n    if (hasScroll) {\n      this.wrapper.style.display = '';\n      return true;\n    }\n\n    this.wrapper.style.display = 'none';\n    return false;\n  };\n\n  Indicator.prototype._refreshKeyValues = function (wrapperSize, scrollerSize, maxScroll) {\n    var initialSize = Math.max(Math.round(wrapperSize * wrapperSize / (scrollerSize || wrapperSize || 1)), INDICATOR_MIN_LEN);\n    var maxPos = wrapperSize - initialSize; // sizeRatio is negative\n\n    var sizeRatio = maxPos / maxScroll;\n    return {\n      initialSize: initialSize,\n      maxPos: maxPos,\n      sizeRatio: sizeRatio\n    };\n  };\n\n  Indicator.prototype.updatePosAndSize = function (endPoint) {\n    var _a = this._refreshPosAndSizeValue(endPoint, this.keyVals),\n        pos = _a.pos,\n        size = _a.size;\n\n    this.curPos = pos;\n\n    this._refreshPosAndSizeStyle(size, pos);\n  };\n\n  Indicator.prototype._refreshPosAndSizeValue = function (endPoint, keyVals) {\n    var posKey = this.keysMap.pos;\n    var sizeRatio = keyVals.sizeRatio,\n        initialSize = keyVals.initialSize,\n        maxPos = keyVals.maxPos;\n    var pos = Math.round(sizeRatio * endPoint[posKey]);\n    var size;\n\n    if (pos < 0) {\n      size = Math.max(initialSize + pos * 3, INDICATOR_MIN_LEN);\n      pos = 0;\n    } else if (pos > maxPos) {\n      size = Math.max(initialSize - (pos - maxPos) * 3, INDICATOR_MIN_LEN);\n      pos = maxPos + initialSize - size;\n    } else {\n      size = initialSize;\n    }\n\n    return {\n      pos: pos,\n      size: size\n    };\n  };\n\n  Indicator.prototype._refreshPosAndSizeStyle = function (size, pos) {\n    var _a = this.keysMap,\n        translate = _a.translate,\n        sizeKey = _a.size;\n    this.elStyle[sizeKey] = size + \"px\";\n    this.elStyle[style.transform] = translate + \"(\" + pos + \"px)\" + this.bscroll.options.translateZ;\n  };\n\n  Indicator.prototype.setTransitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.elStyle[style.transitionDuration] = time + 'ms';\n  };\n\n  Indicator.prototype.setTransitionTimingFunction = function (easing) {\n    this.elStyle[style.transitionTimingFunction] = easing;\n  };\n\n  Indicator.prototype.startHandler = function () {\n    this.setTransitionTime();\n    this.bscroll.trigger('beforeScrollStart');\n  };\n\n  Indicator.prototype.moveHandler = function (moved, delta) {\n    if (!moved) {\n      this.bscroll.trigger('scrollStart');\n    }\n\n    var newScrollPos = this._calScrollDesPos(this.curPos, delta, this.keyVals); // TODO freeScroll ？\n\n\n    if (this.direction === \"vertical\"\n    /* Vertical */\n    ) {\n        this.bscroll.scrollTo(this.bscroll.x, newScrollPos);\n      } else {\n      this.bscroll.scrollTo(newScrollPos, this.bscroll.y);\n    }\n\n    this.bscroll.trigger('scroll', {\n      x: this.bscroll.x,\n      y: this.bscroll.y\n    });\n  };\n\n  Indicator.prototype._calScrollDesPos = function (curPos, delta, keyVals) {\n    var maxPos = keyVals.maxPos,\n        sizeRatio = keyVals.sizeRatio;\n    var newPos = curPos + delta;\n\n    if (newPos < 0) {\n      newPos = 0;\n    } else if (newPos > maxPos) {\n      newPos = maxPos;\n    }\n\n    return Math.round(newPos / sizeRatio);\n  };\n\n  Indicator.prototype.endHandler = function (moved) {\n    if (moved) {\n      this.bscroll.trigger('scrollEnd', {\n        x: this.bscroll.x,\n        y: this.bscroll.y\n      });\n    }\n  };\n\n  Indicator.prototype.destroy = function () {\n    if (this.options.interactive) {\n      this.eventHandler.destroy();\n    }\n\n    this.wrapper.parentNode.removeChild(this.wrapper);\n    this.hooksHandlers.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksHandlers.length = 0;\n  };\n\n  Indicator.prototype._listen = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksHandlers.push([hooks, name, handler]);\n  };\n\n  return Indicator;\n}();\n\nvar ScrollBar =\n/** @class */\nfunction () {\n  function ScrollBar(bscroll) {\n    this.indicators = [];\n\n    if (bscroll.options.scrollbar) {\n      this.indicators = this._initIndicators(bscroll);\n      bscroll.on('destroy', this.destroy, this);\n    }\n  }\n\n  ScrollBar.prototype._initIndicators = function (bscroll) {\n    var _this = this;\n\n    var _a = bscroll.options.scrollbar,\n        _b = _a.fade,\n        fade = _b === void 0 ? true : _b,\n        _c = _a.interactive,\n        interactive = _c === void 0 ? false : _c;\n    var indicatorOption;\n    var scrolls = {\n      scrollX: \"horizontal\"\n      /* Horizontal */\n      ,\n      scrollY: \"vertical\"\n      /* Vertical */\n\n    };\n    var indicators = [];\n    Object.keys(scrolls).forEach(function (key) {\n      var direction = scrolls[key];\n\n      if (bscroll.options[key]) {\n        indicatorOption = {\n          wrapper: _this._createIndicatorElement(direction),\n          direction: direction,\n          fade: fade,\n          interactive: interactive\n        };\n        bscroll.wrapper.appendChild(indicatorOption.wrapper);\n        indicators.push(new Indicator(bscroll, indicatorOption));\n      }\n    });\n    return indicators;\n  };\n\n  ScrollBar.prototype._createIndicatorElement = function (direction) {\n    var scrollbarEl = document.createElement('div');\n    var indicatorEl = document.createElement('div');\n    scrollbarEl.style.cssText = 'position:absolute;z-index:9999;pointerEvents:none';\n    indicatorEl.style.cssText = 'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\n    indicatorEl.className = 'bscroll-indicator';\n\n    if (direction === 'horizontal') {\n      scrollbarEl.style.cssText += ';height:7px;left:2px;right:2px;bottom:0';\n      indicatorEl.style.height = '100%';\n      scrollbarEl.className = 'bscroll-horizontal-scrollbar';\n    } else {\n      scrollbarEl.style.cssText += ';width:7px;bottom:2px;top:2px;right:1px';\n      indicatorEl.style.width = '100%';\n      scrollbarEl.className = 'bscroll-vertical-scrollbar';\n    }\n\n    scrollbarEl.style.cssText += ';overflow:hidden';\n    scrollbarEl.appendChild(indicatorEl);\n    return scrollbarEl;\n  };\n\n  ScrollBar.prototype.destroy = function () {\n    for (var _i = 0, _a = this.indicators; _i < _a.length; _i++) {\n      var indicator = _a[_i];\n      indicator.destroy();\n    }\n  };\n\n  ScrollBar.pluginName = 'scrollbar';\n  return ScrollBar;\n}();\n\nvar PagesPos =\n/** @class */\nfunction () {\n  function PagesPos(scroll, slideOpt) {\n    this.scroll = scroll;\n    this.slideOpt = slideOpt;\n    this.slideEl = null;\n    this.init();\n  }\n\n  PagesPos.prototype.init = function () {\n    var scrollerIns = this.scroll.scroller;\n    var scrollBehaviorX = scrollerIns.scrollBehaviorX;\n    var scrollBehaviorY = scrollerIns.scrollBehaviorY;\n    var wrapper = getRect(scrollerIns.wrapper);\n    var scroller = getRect(scrollerIns.content);\n    this.wrapperWidth = wrapper.width;\n    this.wrapperHeight = wrapper.height;\n    this.scrollerHeight = scrollBehaviorY.hasScroll ? scroller.height : wrapper.height;\n    this.scrollerWidth = scrollBehaviorX.hasScroll ? scroller.width : wrapper.width;\n    var stepX = this.slideOpt.stepX || this.wrapperWidth;\n    var stepY = this.slideOpt.stepY || this.wrapperHeight;\n    var slideEls = scrollerIns.content;\n    var el = this.slideOpt.el;\n\n    if (typeof el === 'string') {\n      this.slideEl = slideEls.querySelectorAll(el);\n    }\n\n    this.pages = this.slideEl ? this.computePagePosInfoByEl(this.slideEl) : this.computePagePosInfo(stepX, stepY);\n    this.xLen = this.pages ? this.pages.length : 0;\n    this.yLen = this.pages && this.pages[0] ? this.pages[0].length : 0;\n  };\n\n  PagesPos.prototype.hasInfo = function () {\n    if (!this.pages || !this.pages.length) {\n      return false;\n    }\n\n    return true;\n  };\n\n  PagesPos.prototype.getPos = function (x, y) {\n    return this.pages[x][y];\n  };\n\n  PagesPos.prototype.getNearestPage = function (x, y) {\n    if (!this.hasInfo()) {\n      return;\n    }\n\n    var pageX = 0;\n    var pageY = 0;\n    var l = this.pages.length;\n\n    for (; pageX < l - 1; pageX++) {\n      if (x >= this.pages[pageX][0].cx) {\n        break;\n      }\n    }\n\n    l = this.pages[pageX].length;\n\n    for (; pageY < l - 1; pageY++) {\n      if (y >= this.pages[0][pageY].cy) {\n        break;\n      }\n    }\n\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n\n  PagesPos.prototype.computePagePosInfo = function (stepX, stepY) {\n    var pages = [];\n    var x = 0;\n    var y;\n    var cx;\n    var cy;\n    var i = 0;\n    var l;\n    var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\n    var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\n    cx = Math.round(stepX / 2);\n    cy = Math.round(stepY / 2);\n\n    while (x > -this.scrollerWidth) {\n      pages[i] = [];\n      l = 0;\n      y = 0;\n\n      while (y > -this.scrollerHeight) {\n        pages[i][l] = {\n          x: Math.max(x, maxScrollPosX),\n          y: Math.max(y, maxScrollPosY),\n          width: stepX,\n          height: stepY,\n          cx: x - cx,\n          cy: y - cy\n        };\n        y -= stepY;\n        l++;\n      }\n\n      x -= stepX;\n      i++;\n    }\n\n    return pages;\n  };\n\n  PagesPos.prototype.computePagePosInfoByEl = function (el) {\n    var pages = [];\n    var x = 0;\n    var y = 0;\n    var cx;\n    var cy;\n    var i = 0;\n    var l = el.length;\n    var m = 0;\n    var n = -1;\n    var rect;\n    var maxScrollX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\n    var maxScrollY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\n\n    for (; i < l; i++) {\n      rect = getRect(el[i]);\n\n      if (i === 0 || rect.left <= getRect(el[i - 1]).left) {\n        m = 0;\n        n++;\n      }\n\n      if (!pages[m]) {\n        pages[m] = [];\n      }\n\n      x = Math.max(-rect.left, maxScrollX);\n      y = Math.max(-rect.top, maxScrollY);\n      cx = x - Math.round(rect.width / 2);\n      cy = y - Math.round(rect.height / 2);\n      pages[m][n] = {\n        x: x,\n        y: y,\n        width: rect.width,\n        height: rect.height,\n        cx: cx,\n        cy: cy\n      };\n\n      if (x > maxScrollX) {\n        m++;\n      }\n    }\n\n    return pages;\n  };\n\n  return PagesPos;\n}();\n\nvar PageInfo =\n/** @class */\nfunction () {\n  function PageInfo(scroll, slideOpt) {\n    this.scroll = scroll;\n    this.slideOpt = slideOpt;\n  }\n\n  PageInfo.prototype.init = function () {\n    this.currentPage = this.currentPage || {\n      x: 0,\n      y: 0,\n      pageX: 0,\n      pageY: 0\n    };\n    this.pagesPos = new PagesPos(this.scroll, this.slideOpt);\n    this.checkSlideLoop();\n  };\n\n  PageInfo.prototype.changeCurrentPage = function (newPage) {\n    this.currentPage = newPage;\n  };\n\n  PageInfo.prototype.change2safePage = function (pageX, pageY) {\n    if (!this.pagesPos.hasInfo()) {\n      return;\n    }\n\n    if (pageX >= this.pagesPos.xLen) {\n      pageX = this.pagesPos.xLen - 1;\n    } else if (pageX < 0) {\n      pageX = 0;\n    }\n\n    if (pageY >= this.pagesPos.yLen) {\n      pageY = this.pagesPos.yLen - 1;\n    } else if (pageY < 0) {\n      pageY = 0;\n    }\n\n    var _a = this.pagesPos.getPos(pageX, pageY),\n        x = _a.x,\n        y = _a.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  PageInfo.prototype.getInitPage = function () {\n    var initPageX = this.loopX ? 1 : 0;\n    var initPageY = this.loopY ? 1 : 0;\n    return {\n      pageX: this.currentPage.pageX || initPageX,\n      pageY: this.currentPage.pageY || initPageY\n    };\n  };\n\n  PageInfo.prototype.getRealPage = function (page) {\n    var fixedPage = function (page, realPageLen) {\n      var pageIndex = [];\n\n      for (var i = 0; i < realPageLen; i++) {\n        pageIndex.push(i);\n      }\n\n      pageIndex.unshift(realPageLen - 1);\n      pageIndex.push(0);\n      return pageIndex[page];\n    };\n\n    var currentPage = page ? extend({}, page) : extend({}, this.currentPage);\n\n    if (this.loopX) {\n      currentPage.pageX = fixedPage(currentPage.pageX, this.pagesPos.xLen - 2);\n    }\n\n    if (this.loopY) {\n      currentPage.pageY = fixedPage(currentPage.pageY, this.pagesPos.yLen - 2);\n    }\n\n    return {\n      pageX: currentPage.pageX,\n      pageY: currentPage.pageY\n    };\n  };\n\n  PageInfo.prototype.getPageSize = function () {\n    return this.pagesPos.getPos(this.currentPage.pageX, this.currentPage.pageY);\n  };\n\n  PageInfo.prototype.realPage2Page = function (x, y) {\n    if (!this.pagesPos.hasInfo()) {\n      return;\n    }\n\n    var lastX = this.pagesPos.xLen - 1;\n    var lastY = this.pagesPos.yLen - 1;\n    var firstX = 0;\n    var firstY = 0;\n\n    if (this.loopX) {\n      x += 1;\n      firstX = firstX + 1;\n      lastX = lastX - 1;\n    }\n\n    if (this.loopY) {\n      y += 1;\n      firstY = firstY + 1;\n      lastY = lastY - 1;\n    }\n\n    x = fixInboundValue(x, firstX, lastX);\n    y = fixInboundValue(y, firstY, lastY);\n    return {\n      realX: x,\n      realY: y\n    };\n  };\n\n  PageInfo.prototype.nextPage = function () {\n    return this.changedPageNum(\"positive\"\n    /* Positive */\n    );\n  };\n\n  PageInfo.prototype.prevPage = function () {\n    return this.changedPageNum(\"negative\"\n    /* Negative */\n    );\n  };\n\n  PageInfo.prototype.nearestPage = function (x, y, directionX, directionY) {\n    var pageInfo = this.pagesPos.getNearestPage(x, y);\n\n    if (!pageInfo) {\n      return {\n        x: 0,\n        y: 0,\n        pageX: 0,\n        pageY: 0\n      };\n    }\n\n    var pageX = pageInfo.pageX;\n    var pageY = pageInfo.pageY;\n    var newX;\n    var newY;\n\n    if (pageX === this.currentPage.pageX) {\n      pageX += directionX;\n      pageX = fixInboundValue(pageX, 0, this.pagesPos.xLen - 1);\n    }\n\n    if (pageY === this.currentPage.pageY) {\n      pageY += directionY;\n      pageY = fixInboundValue(pageInfo.pageY, 0, this.pagesPos.yLen - 1);\n    }\n\n    newX = this.pagesPos.getPos(pageX, 0).x;\n    newY = this.pagesPos.getPos(0, pageY).y;\n    return {\n      x: newX,\n      y: newY,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n\n  PageInfo.prototype.getLoopStage = function () {\n    if (!this.needLoop) {\n      return \"middle\"\n      /* Middle */\n      ;\n    }\n\n    if (this.loopX) {\n      if (this.currentPage.pageX === 0) {\n        return \"head\"\n        /* Head */\n        ;\n      }\n\n      if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\n        return \"tail\"\n        /* Tail */\n        ;\n      }\n    }\n\n    if (this.loopY) {\n      if (this.currentPage.pageY === 0) {\n        return \"head\"\n        /* Head */\n        ;\n      }\n\n      if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\n        return \"tail\"\n        /* Tail */\n        ;\n      }\n    }\n\n    return \"middle\"\n    /* Middle */\n    ;\n  };\n\n  PageInfo.prototype.resetLoopPage = function () {\n    if (this.loopX) {\n      if (this.currentPage.pageX === 0) {\n        return {\n          pageX: this.pagesPos.xLen - 2,\n          pageY: this.currentPage.pageY\n        };\n      }\n\n      if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\n        return {\n          pageX: 1,\n          pageY: this.currentPage.pageY\n        };\n      }\n    }\n\n    if (this.loopY) {\n      if (this.currentPage.pageY === 0) {\n        return {\n          pageX: this.currentPage.pageX,\n          pageY: this.pagesPos.yLen - 2\n        };\n      }\n\n      if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\n        return {\n          pageX: this.currentPage.pageX,\n          pageY: 1\n        };\n      }\n    }\n  };\n\n  PageInfo.prototype.isSameWithCurrent = function (page) {\n    if (page.pageX !== this.currentPage.pageX || page.pageY !== this.currentPage.pageY) {\n      return false;\n    }\n\n    return true;\n  };\n\n  PageInfo.prototype.changedPageNum = function (direction) {\n    var x = this.currentPage.pageX;\n    var y = this.currentPage.pageY;\n\n    if (this.slideX) {\n      x = direction === \"negative\"\n      /* Negative */\n      ? x - 1 : x + 1;\n    }\n\n    if (this.slideY) {\n      y = direction === \"negative\"\n      /* Negative */\n      ? y - 1 : y + 1;\n    }\n\n    return {\n      pageX: x,\n      pageY: y\n    };\n  };\n\n  PageInfo.prototype.checkSlideLoop = function () {\n    this.needLoop = this.slideOpt.loop;\n\n    if (this.pagesPos.xLen > 1) {\n      this.slideX = true;\n    }\n\n    if (this.pagesPos.pages[0] && this.pagesPos.yLen > 1) {\n      this.slideY = true;\n    }\n\n    this.loopX = this.needLoop && this.slideX;\n    this.loopY = this.needLoop && this.slideY;\n\n    if (this.slideX && this.slideY) {\n      warn('slide does not support two direction at the same time.');\n    }\n  };\n\n  return PageInfo;\n}();\n\nvar sourcePrefix$2 = 'plugins.slide';\nvar propertiesMap$2 = [{\n  key: 'next',\n  name: 'next'\n}, {\n  key: 'prev',\n  name: 'prev'\n}, {\n  key: 'goToPage',\n  name: 'goToPage'\n}, {\n  key: 'getCurrentPage',\n  name: 'getCurrentPage'\n}];\nvar propertiesConfig$1 = propertiesMap$2.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$2 + \".\" + item.name\n  };\n});\n\nvar Slide =\n/** @class */\nfunction () {\n  function Slide(scroll) {\n    this.scroll = scroll;\n    this.resetLooping = false;\n    this.isTouching = false;\n    this.scroll.proxy(propertiesConfig$1);\n    this.scroll.registerType(['slideWillChange']);\n    this.slideOpt = this.scroll.options.slide;\n    this.page = new PageInfo(scroll, this.slideOpt);\n    this.hooksFn = [];\n    this.willChangeToPage = {\n      pageX: 0,\n      pageY: 0\n    };\n    this.init();\n  }\n\n  Slide.prototype.init = function () {\n    var _this = this;\n\n    var slide = this.slideOpt;\n    var slideEls = this.scroll.scroller.content;\n    var lazyInitByRefresh = false;\n\n    if (slide.loop) {\n      var children = slideEls.children;\n\n      if (children.length > 1) {\n        this.cloneSlideEleForLoop(slideEls);\n        lazyInitByRefresh = true;\n      } else {\n        // Loop does not make any sense if there is only one child.\n        slide.loop = false;\n      }\n    }\n\n    var shouldRefreshByWidth = this.setSlideWidth(slideEls);\n    var shouldRefreshByHeight = this.setSlideHeight(this.scroll.scroller.wrapper, slideEls);\n    var shouldRefresh = shouldRefreshByWidth || shouldRefreshByHeight;\n    var scrollHooks = this.scroll.hooks;\n    var scrollerHooks = this.scroll.scroller.hooks;\n    this.registorHooks(scrollHooks, 'refresh', this.initSlideState);\n    this.registorHooks(scrollHooks, 'destroy', this.destroy);\n    this.registorHooks(scrollerHooks, 'momentum', this.modifyScrollMetaHandler); // scrollEnd handler should be called before customized handlers\n\n    this.registorHooks(this.scroll, 'scrollEnd', this.amendCurrentPage);\n    this.registorHooks(scrollerHooks, 'beforeStart', this.setTouchFlag);\n    this.registorHooks(scrollerHooks, 'scroll', this.scrollMoving);\n    this.registorHooks(scrollerHooks, 'resize', this.resize); // for mousewheel event\n\n    if (this.scroll.eventTypes.mousewheelMove && this.scroll.eventTypes.mousewheelEnd) {\n      this.registorHooks(this.scroll, 'mousewheelMove', function () {\n        // prevent default action of mousewheelMove\n        return true;\n      });\n      this.registorHooks(this.scroll, 'mousewheelEnd', function (delta) {\n        if (delta.directionX === 1\n        /* Positive */\n        || delta.directionY === 1\n        /* Positive */\n        ) {\n            _this.next();\n          }\n\n        if (delta.directionX === -1\n        /* Negative */\n        || delta.directionY === -1\n        /* Negative */\n        ) {\n            _this.prev();\n          }\n      });\n    }\n\n    if (slide.listenFlick !== false) {\n      this.registorHooks(scrollerHooks, 'flick', this.flickHandler);\n    }\n\n    if (!lazyInitByRefresh && !shouldRefresh) {\n      this.initSlideState();\n    } else {\n      this.scroll.refresh();\n    }\n  };\n\n  Slide.prototype.resize = function () {\n    var _this = this;\n\n    var slideEls = this.scroll.scroller.content;\n    var slideWrapper = this.scroll.scroller.wrapper;\n    clearTimeout(this.resizeTimeout);\n    this.resizeTimeout = window.setTimeout(function () {\n      _this.clearSlideWidth(slideEls);\n\n      _this.clearSlideHeight(slideEls);\n\n      _this.setSlideWidth(slideEls);\n\n      _this.setSlideHeight(slideWrapper, slideEls);\n\n      _this.scroll.refresh();\n    }, this.scroll.options.resizePolling);\n    return true;\n  };\n\n  Slide.prototype.next = function (time, easing) {\n    var _a = this.page.nextPage(),\n        pageX = _a.pageX,\n        pageY = _a.pageY;\n\n    this.goTo(pageX, pageY, time, easing);\n  };\n\n  Slide.prototype.prev = function (time, easing) {\n    var _a = this.page.prevPage(),\n        pageX = _a.pageX,\n        pageY = _a.pageY;\n\n    this.goTo(pageX, pageY, time, easing);\n  };\n\n  Slide.prototype.goToPage = function (x, y, time, easing) {\n    var pageInfo = this.page.realPage2Page(x, y);\n\n    if (!pageInfo) {\n      return;\n    }\n\n    this.goTo(pageInfo.realX, pageInfo.realY, time, easing);\n  };\n\n  Slide.prototype.getCurrentPage = function () {\n    return this.page.getRealPage();\n  };\n\n  Slide.prototype.nearestPage = function (x, y) {\n    var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n    var triggerThreshold = true;\n\n    if (Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX && Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY) {\n      triggerThreshold = false;\n    }\n\n    if (!triggerThreshold) {\n      return this.page.currentPage;\n    }\n\n    return this.page.nearestPage(fixInboundValue(x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos), fixInboundValue(y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos), scrollBehaviorX.direction, scrollBehaviorY.direction);\n  };\n\n  Slide.prototype.destroy = function () {\n    var slideEls = this.scroll.scroller.content;\n\n    if (this.slideOpt.loop) {\n      var children = slideEls.children;\n\n      if (children.length > 2) {\n        removeChild(slideEls, children[children.length - 1]);\n        removeChild(slideEls, children[0]);\n      }\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n\n      if (hooks.eventTypes[hooksName]) {\n        hooks.off(hooksName, handlerFn);\n      }\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Slide.prototype.initSlideState = function () {\n    this.page.init();\n    this.initThreshold();\n    var initPage = this.page.getInitPage();\n    this.goTo(initPage.pageX, initPage.pageY, 0);\n  };\n\n  Slide.prototype.initThreshold = function () {\n    var slideThreshold = this.slideOpt.threshold || 0.1;\n\n    if (slideThreshold % 1 === 0) {\n      this.thresholdX = slideThreshold;\n      this.thresholdY = slideThreshold;\n    } else {\n      var pageSize = this.page.getPageSize();\n      this.thresholdX = Math.round(pageSize.width * slideThreshold);\n      this.thresholdY = Math.round(pageSize.height * slideThreshold);\n    }\n  };\n\n  Slide.prototype.cloneSlideEleForLoop = function (slideEls) {\n    var children = slideEls.children;\n    prepend(children[children.length - 1].cloneNode(true), slideEls);\n    slideEls.appendChild(children[1].cloneNode(true));\n  };\n\n  Slide.prototype.amendCurrentPage = function () {\n    this.isTouching = false;\n\n    if (!this.slideOpt.loop) {\n      return;\n    } // triggered by resetLoop\n\n\n    if (this.resetLooping) {\n      this.resetLooping = false;\n      return;\n    } // fix bug: scroll two page or even more page at once and fetch the boundary.\n    // In this case, momentum won't be trigger, so the pageIndex will be wrong and won't be trigger reset.\n\n\n    var isScrollToBoundary = false;\n\n    if (this.page.loopX && (this.scroll.x === this.scroll.scroller.scrollBehaviorX.minScrollPos || this.scroll.x === this.scroll.scroller.scrollBehaviorX.maxScrollPos)) {\n      isScrollToBoundary = true;\n    }\n\n    if (this.page.loopY && (this.scroll.y === this.scroll.scroller.scrollBehaviorY.minScrollPos || this.scroll.y === this.scroll.scroller.scrollBehaviorY.maxScrollPos)) {\n      isScrollToBoundary = true;\n    }\n\n    if (isScrollToBoundary) {\n      var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\n      var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n      var newPos = this.page.nearestPage(fixInboundValue(this.scroll.x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos), fixInboundValue(this.scroll.y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos), 0, 0);\n      var newPage = {\n        x: newPos.x,\n        y: newPos.y,\n        pageX: newPos.pageX,\n        pageY: newPos.pageY\n      };\n\n      if (!this.page.isSameWithCurrent(newPage)) {\n        this.page.changeCurrentPage(newPage);\n      }\n    }\n\n    var changePage = this.page.resetLoopPage();\n\n    if (changePage) {\n      this.resetLooping = true;\n      this.goTo(changePage.pageX, changePage.pageY, 0);\n      return true; // stop trigger chain\n    } // amend willChangeToPage, because willChangeToPage maybe wrong when sliding quickly\n\n\n    this.pageWillChangeTo(this.page.currentPage);\n  };\n\n  Slide.prototype.shouldSetWidthHeight = function (checkType) {\n    var checkMap = {\n      width: ['scrollX', 'disableSetWidth'],\n      height: ['scrollY', 'disableSetHeight']\n    };\n    var checkOption = checkMap[checkType];\n\n    if (!this.scroll.options[checkOption[0]]) {\n      return false;\n    }\n\n    if (this.slideOpt[checkOption[1]]) {\n      return false;\n    }\n\n    return true;\n  };\n\n  Slide.prototype.clearSlideWidth = function (slideEls) {\n    if (!this.shouldSetWidthHeight('width')) {\n      return;\n    }\n\n    var children = slideEls.children;\n\n    for (var i = 0; i < children.length; i++) {\n      var slideItemDom = children[i];\n      slideItemDom.removeAttribute('style');\n    }\n\n    slideEls.removeAttribute('style');\n  };\n\n  Slide.prototype.setSlideWidth = function (slideEls) {\n    if (!this.shouldSetWidthHeight('width')) {\n      return false;\n    }\n\n    var children = slideEls.children;\n    var slideItemWidth = children[0].clientWidth;\n\n    for (var i = 0; i < children.length; i++) {\n      var slideItemDom = children[i];\n      slideItemDom.style.width = slideItemWidth + 'px';\n    }\n\n    slideEls.style.width = slideItemWidth * children.length + 'px';\n    return true;\n  };\n\n  Slide.prototype.clearSlideHeight = function (slideEls) {\n    if (!this.shouldSetWidthHeight('height')) {\n      return;\n    }\n\n    var children = slideEls.children;\n\n    for (var i = 0; i < children.length; i++) {\n      var slideItemDom = children[i];\n      slideItemDom.removeAttribute('style');\n    }\n\n    slideEls.removeAttribute('style');\n  }; // height change will not effect minScrollY & maxScrollY\n\n\n  Slide.prototype.setSlideHeight = function (slideWrapper, slideEls) {\n    if (!this.shouldSetWidthHeight('height')) {\n      return false;\n    }\n\n    var wrapperHeight = slideWrapper.clientHeight;\n    var children = slideEls.children;\n\n    for (var i = 0; i < children.length; i++) {\n      var slideItemDom = children[i];\n      slideItemDom.style.height = wrapperHeight + 'px';\n    }\n\n    slideEls.style.height = wrapperHeight * children.length + 'px';\n    return true;\n  };\n\n  Slide.prototype.goTo = function (pageX, pageY, time, easing) {\n    if (pageY === void 0) {\n      pageY = 0;\n    }\n\n    var newPageInfo = this.page.change2safePage(pageX, pageY);\n\n    if (!newPageInfo) {\n      return;\n    }\n\n    var scrollEasing = easing || this.slideOpt.easing || ease.bounce;\n    var posX = newPageInfo.x;\n    var posY = newPageInfo.y;\n    var deltaX = posX - this.scroll.scroller.scrollBehaviorX.currentPos;\n    var deltaY = posY - this.scroll.scroller.scrollBehaviorY.currentPos;\n\n    if (!deltaX && !deltaY) {\n      return;\n    }\n\n    time = time === undefined ? this.getAnimateTime(deltaX, deltaY) : time;\n    this.page.changeCurrentPage({\n      x: posX,\n      y: posY,\n      pageX: newPageInfo.pageX,\n      pageY: newPageInfo.pageY\n    });\n    this.pageWillChangeTo(this.page.currentPage);\n    this.scroll.scroller.scrollTo(posX, posY, time, scrollEasing);\n  };\n\n  Slide.prototype.flickHandler = function () {\n    var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n    var deltaX = scrollBehaviorX.currentPos - scrollBehaviorX.startPos;\n    var deltaY = scrollBehaviorY.currentPos - scrollBehaviorY.startPos;\n    var time = this.getAnimateTime(deltaX, deltaY);\n    this.goTo(this.page.currentPage.pageX + scrollBehaviorX.direction, this.page.currentPage.pageY + scrollBehaviorY.direction, time);\n  };\n\n  Slide.prototype.getAnimateTime = function (deltaX, deltaY) {\n    if (this.slideOpt.speed) {\n      return this.slideOpt.speed;\n    }\n\n    return Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300);\n  };\n\n  Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\n    var newPos = this.nearestPage(scrollMeta.newX, scrollMeta.newY);\n    scrollMeta.time = this.getAnimateTime(scrollMeta.newX - newPos.x, scrollMeta.newY - newPos.y);\n    scrollMeta.newX = newPos.x;\n    scrollMeta.newY = newPos.y;\n    scrollMeta.easing = this.slideOpt.easing || ease.bounce;\n    this.page.changeCurrentPage({\n      x: scrollMeta.newX,\n      y: scrollMeta.newY,\n      pageX: newPos.pageX,\n      pageY: newPos.pageY\n    });\n    this.pageWillChangeTo(this.page.currentPage);\n  };\n\n  Slide.prototype.scrollMoving = function (point) {\n    if (this.isTouching) {\n      var newPos = this.nearestPage(point.x, point.y);\n      this.pageWillChangeTo(newPos);\n    }\n  };\n\n  Slide.prototype.pageWillChangeTo = function (newPage) {\n    var changeToPage = this.page.getRealPage(newPage);\n\n    if (changeToPage.pageX === this.willChangeToPage.pageX && changeToPage.pageY === this.willChangeToPage.pageY) {\n      return;\n    }\n\n    this.willChangeToPage = changeToPage;\n    this.scroll.trigger('slideWillChange', this.willChangeToPage);\n  };\n\n  Slide.prototype.setTouchFlag = function () {\n    this.isTouching = true;\n  };\n\n  Slide.prototype.registorHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Slide.pluginName = 'slide';\n  return Slide;\n}();\n\nvar sourcePrefix$3 = 'plugins.wheel';\nvar propertiesMap$3 = [{\n  key: 'wheelTo',\n  name: 'wheelTo'\n}, {\n  key: 'getSelectedIndex',\n  name: 'getSelectedIndex'\n}];\nvar propertiesConfig$2 = propertiesMap$3.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$3 + \".\" + item.name\n  };\n});\nvar CONSTANTS = {\n  rate: 4\n};\n\nvar Wheel =\n/** @class */\nfunction () {\n  function Wheel(scroll) {\n    this.scroll = scroll;\n    this.options = this.scroll.options.wheel;\n    this.init();\n  }\n\n  Wheel.prototype.init = function () {\n    if (this.options) {\n      this.normalizeOptions();\n      this.refresh();\n      this.tapIntoHooks();\n      this.wheelTo(this.selectedIndex);\n      this.scroll.proxy(propertiesConfig$2);\n    }\n  };\n\n  Wheel.prototype.tapIntoHooks = function () {\n    var _this = this;\n\n    var scroller = this.scroll.scroller;\n    var actionsHandler = scroller.actionsHandler;\n    var scrollBehaviorY = scroller.scrollBehaviorY;\n    var animater = scroller.animater; // BScroll\n\n    this.scroll.on(this.scroll.hooks.eventTypes.refresh, function () {\n      _this.refresh();\n    }); // Scroller\n\n    scroller.hooks.on(scroller.hooks.eventTypes.checkClick, function () {\n      var index = Array.from(_this.items).indexOf(_this.target);\n      if (index === -1) return true;\n\n      _this.wheelTo(index, _this.options.adjustTime, ease.swipe);\n\n      return true;\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.scrollTo, function (endPoint) {\n      endPoint.y = _this.findNearestValidWheel(endPoint.y).y;\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.scrollToElement, function (el, pos) {\n      if (!hasClass(el, _this.options.wheelItemClass)) {\n        return true;\n      } else {\n        pos.top = _this.findNearestValidWheel(pos.top).y;\n      }\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.ignoreDisMoveForSamePos, function () {\n      return true;\n    }); // ActionsHandler\n\n    actionsHandler.hooks.on(actionsHandler.hooks.eventTypes.beforeStart, function (e) {\n      _this.target = e.target;\n    }); // ScrollBehaviorY\n\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.momentum, function (momentumInfo, distance) {\n      momentumInfo.rate = CONSTANTS.rate;\n      momentumInfo.destination = _this.findNearestValidWheel(momentumInfo.destination).y;\n      var maxDistance = 1000;\n      var minDuration = 800;\n\n      if (distance < maxDistance) {\n        momentumInfo.duration = Math.max(minDuration, distance / maxDistance * _this.scroll.options.swipeTime);\n      }\n    });\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.end, function (momentumInfo) {\n      var validWheel = _this.findNearestValidWheel(scrollBehaviorY.currentPos);\n\n      momentumInfo.destination = validWheel.y;\n      momentumInfo.duration = _this.options.adjustTime;\n      _this.selectedIndex = validWheel.index;\n    }); // Animater\n\n    animater.hooks.on(animater.hooks.eventTypes.time, function (time) {\n      _this.transitionDuration(time);\n    });\n    animater.hooks.on(animater.hooks.eventTypes.timeFunction, function (easing) {\n      _this.timeFunction(easing);\n    });\n    animater.hooks.on(animater.hooks.eventTypes.beforeForceStop, function (_a) {\n      var y = _a.y;\n      _this.target = _this.items[_this.findNearestValidWheel(y).index]; // don't dispatch scrollEnd when it is a click operation\n\n      return true;\n    }); // Translater\n\n    animater.translater.hooks.on(animater.translater.hooks.eventTypes.translate, function (endPoint) {\n      _this.rotateX(endPoint.y);\n\n      _this.selectedIndex = _this.findNearestValidWheel(endPoint.y).index;\n    });\n  };\n\n  Wheel.prototype.refresh = function () {\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorY = scroller.scrollBehaviorY; // adjust contentSize\n\n    var contentRect = getRect(scroller.content);\n    scrollBehaviorY.contentSize = contentRect.height;\n    this.items = scroller.content.children;\n    this.checkWheelAllDisabled();\n    this.itemHeight = this.items.length ? scrollBehaviorY.contentSize / this.items.length : 0;\n\n    if (this.selectedIndex === undefined) {\n      this.selectedIndex = this.options.selectedIndex || 0;\n    }\n\n    this.scroll.maxScrollX = 0;\n    this.scroll.maxScrollY = -this.itemHeight * (this.items.length - 1);\n    this.scroll.minScrollX = 0;\n    this.scroll.minScrollY = 0;\n    scrollBehaviorY.hasScroll = scrollBehaviorY.options && this.scroll.maxScrollY < this.scroll.minScrollY;\n  };\n\n  Wheel.prototype.getSelectedIndex = function () {\n    return this.selectedIndex;\n  };\n\n  Wheel.prototype.wheelTo = function (index, time, ease, isSlient) {\n    if (index === void 0) {\n      index = 0;\n    }\n\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var y = -index * this.itemHeight;\n    this.scroll.scrollTo(0, y, time, ease, isSlient);\n  };\n\n  Wheel.prototype.transitionDuration = function (time) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].style[style.transitionDuration] = time + 'ms';\n    }\n  };\n\n  Wheel.prototype.timeFunction = function (easing) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].style[style.transitionTimingFunction] = easing;\n    }\n  };\n\n  Wheel.prototype.rotateX = function (y) {\n    var _a = this.options.rotate,\n        rotate = _a === void 0 ? 25 : _a;\n\n    for (var i = 0; i < this.items.length; i++) {\n      var deg = rotate * (y / this.itemHeight + i);\n      this.items[i].style[style.transform] = \"rotateX(\" + deg + \"deg)\";\n    }\n  };\n\n  Wheel.prototype.findNearestValidWheel = function (y) {\n    y = y > 0 ? 0 : y < this.scroll.maxScrollY ? this.scroll.maxScrollY : y;\n    var currentIndex = Math.abs(Math.round(-y / this.itemHeight));\n    var cacheIndex = currentIndex;\n    var items = this.items;\n    var wheelDisabledItemClassName = this.options.wheelDisabledItemClass; // Impersonation web native select\n    // first, check whether there is a enable item whose index is smaller than currentIndex\n    // then, check whether there is a enable item whose index is bigger than currentIndex\n    // otherwise, there are all disabled items, just keep currentIndex unchange\n\n    while (currentIndex >= 0) {\n      if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\n        break;\n      }\n\n      currentIndex--;\n    }\n\n    if (currentIndex < 0) {\n      currentIndex = cacheIndex;\n\n      while (currentIndex <= items.length - 1) {\n        if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\n          break;\n        }\n\n        currentIndex++;\n      }\n    } // keep it unchange when all the items are disabled\n\n\n    if (currentIndex === items.length) {\n      currentIndex = cacheIndex;\n    } // when all the items are disabled, this.selectedIndex should always be -1\n\n\n    return {\n      index: this.wheelItemsAllDisabled ? -1 : currentIndex,\n      y: -currentIndex * this.itemHeight\n    };\n  };\n\n  Wheel.prototype.normalizeOptions = function () {\n    var options = this.options = isPlainObject(this.options) ? this.options : {};\n\n    if (!options.wheelWrapperClass) {\n      options.wheelWrapperClass = 'wheel-scroll';\n    }\n\n    if (!options.wheelItemClass) {\n      options.wheelItemClass = 'wheel-item';\n    }\n\n    if (!options.rotate) {\n      options.rotate = 25;\n    }\n\n    if (!options.adjustTime) {\n      options.adjustTime = 400;\n    }\n\n    if (!options.wheelDisabledItemClass) {\n      options.wheelDisabledItemClass = 'wheel-disabled-item';\n    }\n  };\n\n  Wheel.prototype.checkWheelAllDisabled = function () {\n    var wheelDisabledItemClassName = this.options.wheelDisabledItemClass;\n    var items = this.items;\n    this.wheelItemsAllDisabled = true;\n\n    for (var i = 0; i < items.length; i++) {\n      if (!hasClass(items[i], wheelDisabledItemClassName)) {\n        this.wheelItemsAllDisabled = false;\n        break;\n      }\n    }\n  };\n\n  Wheel.pluginName = 'wheel';\n  return Wheel;\n}();\n\nvar sourcePrefix$4 = 'plugins.zoom';\nvar propertiesMap$4 = [{\n  key: 'zoomTo',\n  name: 'zoomTo'\n}];\nvar propertiesConfig$3 = propertiesMap$4.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$4 + \".\" + item.name\n  };\n});\n\nvar Zoom =\n/** @class */\nfunction () {\n  function Zoom(scroll) {\n    this.scroll = scroll;\n    this.scale = 1;\n    this.scroll.proxy(propertiesConfig$3);\n    this.scroll.registerType(['zoomStart', 'zoomEnd']);\n    this.zoomOpt = this.scroll.options.zoom;\n    this.lastTransformScale = this.scale;\n    this.hooksFn = [];\n    this.init();\n  }\n\n  Zoom.prototype.init = function () {\n    var _this = this;\n\n    var scrollerIns = this.scroll.scroller;\n    this.wrapper = this.scroll.scroller.wrapper;\n    this.scaleElement = this.scroll.scroller.content;\n    this.scaleElement.style[style.transformOrigin] = '0 0';\n    this.scaleElementInitSize = getRect(this.scaleElement);\n    var scrollBehaviorX = scrollerIns.scrollBehaviorX;\n    var scrollBehaviorY = scrollerIns.scrollBehaviorY;\n    this.initScrollBoundary = {\n      x: [scrollBehaviorX.minScrollPos, scrollBehaviorX.maxScrollPos],\n      y: [scrollBehaviorY.minScrollPos, scrollBehaviorY.maxScrollPos]\n    };\n    this.registorHooks(scrollerIns.actions.hooks, 'start', function (e) {\n      if (e.touches && e.touches.length > 1) {\n        _this.zoomStart(e);\n      }\n    });\n    this.registorHooks(scrollerIns.actions.hooks, 'beforeMove', function (e) {\n      if (!e.touches || e.touches.length < 2) {\n        return false;\n      }\n\n      _this.zoom(e);\n\n      return true;\n    });\n    this.registorHooks(scrollerIns.actions.hooks, 'beforeEnd', function (e) {\n      if (!_this.zooming) {\n        return false;\n      }\n\n      _this.zoomEnd();\n\n      return true;\n    });\n    this.registorHooks(scrollerIns.translater.hooks, 'beforeTranslate', function (transformStyle, point) {\n      var scale = point.scale ? point.scale : _this.lastTransformScale;\n      _this.lastTransformScale = scale;\n      transformStyle.push(\"scale(\" + scale + \")\");\n    });\n    this.registorHooks(scrollerIns.hooks, 'ignoreDisMoveForSamePos', function () {\n      return true;\n    });\n    this.registorHooks(this.scroll.hooks, 'destroy', this.destroy);\n  };\n\n  Zoom.prototype.zoomTo = function (scale, x, y) {\n    var _a = offsetToBody(this.wrapper),\n        left = _a.left,\n        top = _a.top;\n\n    var originX = x + left - this.scroll.x;\n    var originY = y + top - this.scroll.y;\n    this.zooming = true;\n\n    this._zoomTo(scale, {\n      x: originX,\n      y: originY\n    }, this.scale);\n\n    this.zooming = false;\n  };\n\n  Zoom.prototype.zoomStart = function (e) {\n    this.zooming = true;\n    var firstFinger = e.touches[0];\n    var secondFinger = e.touches[1];\n    this.startDistance = this.getFingerDistance(e);\n    this.startScale = this.scale;\n\n    var _a = offsetToBody(this.wrapper),\n        left = _a.left,\n        top = _a.top;\n\n    this.origin = {\n      x: Math.abs(firstFinger.pageX + secondFinger.pageX) / 2 + left - this.scroll.x,\n      y: Math.abs(firstFinger.pageY + secondFinger.pageY) / 2 + top - this.scroll.y\n    };\n    this.scroll.trigger(this.scroll.eventTypes.zoomStart);\n  };\n\n  Zoom.prototype.zoom = function (e) {\n    var scrollerIns = this.scroll.scroller;\n    var currentDistance = this.getFingerDistance(e);\n    var currentScale = currentDistance / this.startDistance * this.startScale;\n    this.scale = this.scaleCure(currentScale);\n    var lastScale = this.scale / this.startScale;\n    var scrollBehaviorX = scrollerIns.scrollBehaviorX;\n    var scrollBehaviorY = scrollerIns.scrollBehaviorY;\n    var x = this.getNewPos(this.origin.x, lastScale, scrollBehaviorX);\n    var y = this.getNewPos(this.origin.y, lastScale, scrollBehaviorY);\n    this.resetBoundaries(this.scale, scrollBehaviorX, 'x', x);\n    this.resetBoundaries(this.scale, scrollBehaviorY, 'y', y);\n    scrollerIns.scrollTo(x, y, 0, undefined, {\n      start: {\n        scale: this.lastTransformScale\n      },\n      end: {\n        scale: this.scale\n      }\n    });\n  };\n\n  Zoom.prototype.getFingerDistance = function (e) {\n    var firstFinger = e.touches[0];\n    var secondFinger = e.touches[1];\n    var deltaX = Math.abs(firstFinger.pageX - secondFinger.pageX);\n    var deltaY = Math.abs(firstFinger.pageY - secondFinger.pageY);\n    return getDistance(deltaX, deltaY);\n  };\n\n  Zoom.prototype.zoomEnd = function () {\n    this._zoomTo(this.scale, this.origin, this.startScale || this.scale);\n\n    this.zooming = false;\n    this.scroll.trigger(this.scroll.eventTypes.zoomEnd);\n  };\n\n  Zoom.prototype.destroy = function () {\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Zoom.prototype._zoomTo = function (scale, origin, startScale) {\n    this.scale = this.fixInScaleLimit(scale);\n    var lastScale = this.scale / startScale;\n    var scrollerIns = this.scroll.scroller;\n    var scrollBehaviorX = scrollerIns.scrollBehaviorX;\n    var scrollBehaviorY = scrollerIns.scrollBehaviorY;\n    this.resetBoundaries(this.scale, scrollBehaviorX, 'x');\n    this.resetBoundaries(this.scale, scrollBehaviorY, 'y'); // resetPosition\n\n    var newX = this.getNewPos(origin.x, lastScale, scrollBehaviorX, true);\n    var newY = this.getNewPos(origin.y, lastScale, scrollBehaviorY, true);\n\n    if (scrollBehaviorX.currentPos !== Math.round(newX) || scrollBehaviorY.currentPos !== Math.round(newY) || this.scale !== this.lastTransformScale) {\n      scrollerIns.scrollTo(newX, newY, this.scroll.options.bounceTime, undefined, {\n        start: {\n          scale: this.lastTransformScale\n        },\n        end: {\n          scale: this.scale\n        }\n      });\n    }\n  };\n\n  Zoom.prototype.resetBoundaries = function (scale, scrollBehavior, direction, extendValue) {\n    var min = this.initScrollBoundary[direction][0];\n    var max = this.initScrollBoundary[direction][1];\n    var hasScroll = false;\n\n    if (scale > 1) {\n      var sideName = direction === 'x' ? 'width' : 'height';\n      max = -this.scaleElementInitSize[sideName] * (scale - 1) - this.initScrollBoundary[direction][1];\n      hasScroll = true;\n    }\n\n    if (!isUndef(extendValue)) {\n      max = Math.min(extendValue, max);\n      min = Math.max(extendValue, min); // max & min & curValue is negative value\n\n      hasScroll = !!(min || max);\n    }\n\n    scrollBehavior.minScrollPos = Math.floor(min);\n    scrollBehavior.maxScrollPos = Math.floor(max);\n    scrollBehavior.hasScroll = hasScroll;\n  };\n\n  Zoom.prototype.getNewPos = function (origin, lastScale, scrollBehavior, fixInBound) {\n    var newPos = origin - origin * lastScale + scrollBehavior.startPos;\n\n    if (fixInBound) {\n      newPos = fixInboundValue(newPos, scrollBehavior.maxScrollPos, 0);\n    }\n\n    return Math.floor(newPos);\n  };\n\n  Zoom.prototype.scaleCure = function (scale) {\n    var _a = this.zoomOpt,\n        _b = _a.min,\n        min = _b === void 0 ? 1 : _b,\n        _c = _a.max,\n        max = _c === void 0 ? 4 : _c;\n\n    if (scale < min) {\n      scale = 0.5 * min * Math.pow(2.0, scale / min);\n    } else if (scale > max) {\n      scale = 2.0 * max * Math.pow(0.5, max / scale);\n    }\n\n    return scale;\n  };\n\n  Zoom.prototype.fixInScaleLimit = function (scale) {\n    var _a = this.zoomOpt,\n        _b = _a.min,\n        min = _b === void 0 ? 1 : _b,\n        _c = _a.max,\n        max = _c === void 0 ? 4 : _c;\n\n    if (scale > max) {\n      scale = max;\n    } else if (scale < min) {\n      scale = min;\n    }\n\n    return scale;\n  };\n\n  Zoom.prototype.registorHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Zoom.pluginName = 'zoom';\n  return Zoom;\n}();\n\nvar compatibleFeatures = {\n  duplicateClick: function (_a) {\n    var parentScroll = _a[0],\n        childScroll = _a[1]; // no need to make childScroll's click true\n\n    if (parentScroll.options.click && childScroll.options.click) {\n      childScroll.options.click = false;\n    }\n  },\n  nestedScroll: function (scrollsPair) {\n    var parentScroll = scrollsPair[0],\n        childScroll = scrollsPair[1];\n    var parentScrollX = parentScroll.options.scrollX;\n    var parentScrollY = parentScroll.options.scrollY;\n    var childScrollX = childScroll.options.scrollX;\n    var childScrollY = childScroll.options.scrollY; // vertical nested in vertical scroll and horizontal nested in horizontal\n    // otherwise, no need to handle.\n\n    if (parentScrollX === childScrollX || parentScrollY === childScrollY) {\n      scrollsPair.forEach(function (scroll, index) {\n        var oppositeScroll = scrollsPair[(index + 1) % 2];\n        scroll.on('beforeScrollStart', function () {\n          if (oppositeScroll.pending) {\n            oppositeScroll.stop();\n            oppositeScroll.resetPosition();\n          }\n\n          setupData(oppositeScroll);\n          oppositeScroll.disable();\n        });\n        scroll.on('touchEnd', function () {\n          oppositeScroll.enable();\n        });\n      });\n      childScroll.on('scrollStart', function () {\n        if (checkBeyondBoundary(childScroll)) {\n          childScroll.disable();\n          parentScroll.enable();\n        }\n      });\n    }\n  }\n};\n\nvar NestedScroll =\n/** @class */\nfunction () {\n  function NestedScroll(scroll) {\n    var singleton = NestedScroll.nestedScroll;\n\n    if (!(singleton instanceof NestedScroll)) {\n      singleton = NestedScroll.nestedScroll = this;\n      singleton.stores = [];\n    }\n\n    singleton.setup(scroll);\n    singleton.addHooks(scroll);\n    return singleton;\n  }\n\n  NestedScroll.prototype.setup = function (scroll) {\n    this.appendBScroll(scroll);\n    this.handleContainRelationship();\n    this.handleCompatible();\n  };\n\n  NestedScroll.prototype.addHooks = function (scroll) {\n    var _this = this;\n\n    scroll.on('destroy', function () {\n      _this.teardown(scroll);\n    });\n  };\n\n  NestedScroll.prototype.teardown = function (scroll) {\n    this.removeBScroll(scroll);\n    this.handleContainRelationship();\n    this.handleCompatible();\n  };\n\n  NestedScroll.prototype.appendBScroll = function (scroll) {\n    this.stores.push(scroll);\n  };\n\n  NestedScroll.prototype.removeBScroll = function (scroll) {\n    var index = this.stores.indexOf(scroll);\n    if (index === -1) return;\n    scroll.wrapper.isBScrollContainer = undefined;\n    this.stores.splice(index, 1);\n  };\n\n  NestedScroll.prototype.handleContainRelationship = function () {\n    // bs's length <= 1\n    var stores = this.stores;\n\n    if (stores.length <= 1) {\n      // there is only a childBScroll left.\n      if (stores[0] && stores[0].__parentInfo) {\n        stores[0].__parentInfo = undefined;\n      }\n\n      return;\n    }\n\n    var outerBS;\n    var outerBSWrapper;\n    var innerBS;\n    var innerBSWrapper; // Need two layers of \"For loop\" to calculate parent-child relationship\n\n    for (var i = 0; i < stores.length; i++) {\n      outerBS = stores[i];\n      outerBSWrapper = outerBS.wrapper;\n\n      for (var j = 0; j < stores.length; j++) {\n        innerBS = stores[j];\n        innerBSWrapper = innerBS.wrapper; // same bs\n\n        if (outerBS === innerBS) continue; // now start calculating\n\n        if (!innerBSWrapper.contains(outerBSWrapper)) continue; // now innerBS contains outerBS\n        // no parentInfo yet\n\n        if (!outerBS.__parentInfo) {\n          outerBS.__parentInfo = {\n            parent: innerBS,\n            depth: calculateDepths(outerBSWrapper, innerBSWrapper)\n          };\n        } else {\n          // has parentInfo already!\n          // just judge the \"true\" parent by depth\n          // we regard the latest node as parent, not the furthest\n          var currentDepths = calculateDepths(outerBSWrapper, innerBSWrapper);\n          var prevDepths = outerBS.__parentInfo.depth; // refresh currentBS as parentScroll\n\n          if (prevDepths > currentDepths) {\n            outerBS.__parentInfo = {\n              parent: innerBS,\n              depth: currentDepths\n            };\n          }\n        }\n      }\n    }\n  };\n\n  NestedScroll.prototype.handleCompatible = function () {\n    var pairs = this.availableBScrolls();\n    var keys = ['duplicateClick', 'nestedScroll'];\n    pairs.forEach(function (pair) {\n      keys.forEach(function (key) {\n        compatibleFeatures[key](pair);\n      });\n    });\n  };\n\n  NestedScroll.prototype.availableBScrolls = function () {\n    var ret = [];\n    ret = this.stores.filter(function (bs) {\n      return !!bs.__parentInfo;\n    }).map(function (bs) {\n      return [bs.__parentInfo.parent, bs];\n    });\n    return ret;\n  };\n\n  NestedScroll.pluginName = 'nestedScroll';\n  return NestedScroll;\n}();\n\nfunction calculateDepths(childNode, parentNode) {\n  var depth = 0;\n  var parent = childNode.parentNode;\n\n  while (parent && parent !== parentNode) {\n    depth++;\n    parent = parent.parentNode;\n  }\n\n  return depth;\n}\n\nfunction checkBeyondBoundary(scroll) {\n  var _a = hasScroll(scroll),\n      hasHorizontalScroll = _a.hasHorizontalScroll,\n      hasVerticalScroll = _a.hasVerticalScroll;\n\n  var _b = scroll.scroller,\n      scrollBehaviorX = _b.scrollBehaviorX,\n      scrollBehaviorY = _b.scrollBehaviorY;\n  var hasReachLeft = scroll.x >= scroll.minScrollX && scrollBehaviorX.movingDirection === -1;\n  var hasReachRight = scroll.x <= scroll.maxScrollX && scrollBehaviorX.movingDirection === 1;\n  var hasReachTop = scroll.y >= scroll.minScrollY && scrollBehaviorY.movingDirection === -1;\n  var hasReachBottom = scroll.y <= scroll.maxScrollY && scrollBehaviorY.movingDirection === 1;\n\n  if (hasVerticalScroll) {\n    return hasReachTop || hasReachBottom;\n  } else if (hasHorizontalScroll) {\n    return hasReachLeft || hasReachRight;\n  }\n\n  return false;\n}\n\nfunction setupData(scroll) {\n  var _a = hasScroll(scroll),\n      hasHorizontalScroll = _a.hasHorizontalScroll,\n      hasVerticalScroll = _a.hasVerticalScroll;\n\n  var _b = scroll.scroller,\n      actions = _b.actions,\n      scrollBehaviorX = _b.scrollBehaviorX,\n      scrollBehaviorY = _b.scrollBehaviorY;\n  actions.startTime = +new Date();\n\n  if (hasVerticalScroll) {\n    scrollBehaviorY.startPos = scrollBehaviorY.currentPos;\n  } else if (hasHorizontalScroll) {\n    scrollBehaviorX.startPos = scrollBehaviorX.currentPos;\n  }\n}\n\nfunction hasScroll(scroll) {\n  return {\n    hasHorizontalScroll: scroll.scroller.scrollBehaviorX.hasScroll,\n    hasVerticalScroll: scroll.scroller.scrollBehaviorY.hasScroll\n  };\n}\n\nvar PRE_NUM = 10;\nvar POST_NUM = 30;\n\nvar IndexCalculator =\n/** @class */\nfunction () {\n  function IndexCalculator(wrapperHeight, tombstoneHeight) {\n    this.wrapperHeight = wrapperHeight;\n    this.tombstoneHeight = tombstoneHeight;\n    this.lastDirection = 1\n    /* DOWN */\n    ;\n    this.lastPos = 0;\n  }\n\n  IndexCalculator.prototype.calculate = function (pos, list) {\n    var offset = pos - this.lastPos;\n    this.lastPos = pos;\n    var direction = this.getDirection(offset); // important! start index is much more important than end index.\n\n    var start = this.calculateIndex(0, pos, list);\n    var end = this.calculateIndex(start, pos + this.wrapperHeight, list);\n\n    if (direction === 1\n    /* DOWN */\n    ) {\n        start -= PRE_NUM;\n        end += POST_NUM;\n      } else {\n      start -= POST_NUM;\n      end += PRE_NUM;\n    }\n\n    if (start < 0) {\n      start = 0;\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  IndexCalculator.prototype.getDirection = function (offset) {\n    var direction;\n\n    if (offset > 0) {\n      direction = 1\n      /* DOWN */\n      ;\n    } else if (offset < 0) {\n      direction = 0\n      /* UP */\n      ;\n    } else {\n      return this.lastDirection;\n    }\n\n    this.lastDirection = direction;\n    return direction;\n  };\n\n  IndexCalculator.prototype.calculateIndex = function (start, offset, list) {\n    if (offset <= 0) {\n      return start;\n    }\n\n    var i = start;\n    var startPos = list[i] && list[i].pos !== -1 ? list[i].pos : 0;\n    var lastPos = startPos;\n    var tombstone = 0;\n\n    while (i < list.length && list[i].pos < offset) {\n      lastPos = list[i].pos;\n      i++;\n    }\n\n    if (i === list.length) {\n      tombstone = Math.floor((offset - lastPos) / this.tombstoneHeight);\n    }\n\n    i += tombstone;\n    return i;\n  };\n\n  return IndexCalculator;\n}();\n\nvar ListItem =\n/** @class */\nfunction () {\n  function ListItem() {\n    this.data = null;\n    this.dom = null;\n    this.tombstone = null;\n    this.width = 0;\n    this.height = 0;\n    this.pos = 0;\n  }\n\n  return ListItem;\n}();\n\nvar DataManager =\n/** @class */\nfunction () {\n  function DataManager(list, fetchFn, onFetchFinish) {\n    this.fetchFn = fetchFn;\n    this.onFetchFinish = onFetchFinish;\n    this.loadedNum = 0;\n    this.fetching = false;\n    this.hasMore = true;\n    this.list = list || [];\n  }\n\n  DataManager.prototype.update = function (end) {\n    return __awaiter(this, void 0, void 0, function () {\n      var len;\n      return __generator(this, function (_a) {\n        if (!this.hasMore) {\n          end = Math.min(end, this.list.length);\n        } // add data placeholder\n\n\n        if (end > this.list.length) {\n          len = end - this.list.length;\n          this.addEmptyData(len);\n        } // tslint:disable-next-line: no-floating-promises\n\n\n        return [2\n        /*return*/\n        , this.checkToFetch(end)];\n      });\n    });\n  };\n\n  DataManager.prototype.add = function (data) {\n    for (var i = 0; i < data.length; i++) {\n      if (!this.list[this.loadedNum]) {\n        this.list[this.loadedNum] = {\n          data: data[i]\n        };\n      } else {\n        this.list[this.loadedNum] = __assign({}, this.list[this.loadedNum], {\n          data: data[i]\n        });\n      }\n\n      this.loadedNum++;\n    }\n\n    return this.list;\n  };\n\n  DataManager.prototype.addEmptyData = function (len) {\n    for (var i = 0; i < len; i++) {\n      this.list.push(new ListItem());\n    }\n\n    return this.list;\n  };\n\n  DataManager.prototype.fetch = function (len) {\n    return __awaiter(this, void 0, void 0, function () {\n      var data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (this.fetching) {\n              return [2\n              /*return*/\n              , []];\n            }\n\n            this.fetching = true;\n            return [4\n            /*yield*/\n            , this.fetchFn(len)];\n\n          case 1:\n            data = _a.sent();\n            this.fetching = false;\n            return [2\n            /*return*/\n            , data];\n        }\n      });\n    });\n  };\n\n  DataManager.prototype.checkToFetch = function (end) {\n    return __awaiter(this, void 0, void 0, function () {\n      var min, newData, currentEnd;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!this.hasMore) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            if (end <= this.loadedNum) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            min = end - this.loadedNum;\n            return [4\n            /*yield*/\n            , this.fetch(min)];\n\n          case 1:\n            newData = _a.sent();\n\n            if (newData instanceof Array && newData.length) {\n              this.add(newData);\n              currentEnd = this.onFetchFinish(this.list, true);\n              return [2\n              /*return*/\n              , this.checkToFetch(currentEnd)];\n            } else if (typeof newData === 'boolean' && newData === false) {\n              this.hasMore = false;\n              this.list.splice(this.loadedNum);\n              this.onFetchFinish(this.list, false);\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  DataManager.prototype.getList = function () {\n    return this.list;\n  };\n\n  return DataManager;\n}();\n\nvar Tombstone =\n/** @class */\nfunction () {\n  function Tombstone(create) {\n    this.create = create;\n    this.cached = [];\n    this.width = 0;\n    this.height = 0;\n    this.initialed = false;\n    this.getSize();\n  }\n\n  Tombstone.isTombstone = function (el) {\n    if (el && el.classList) {\n      return el.classList.contains('tombstone');\n    }\n\n    return false;\n  };\n\n  Tombstone.prototype.getSize = function () {\n    if (!this.initialed) {\n      var tombstone = this.create();\n      tombstone.style.position = 'absolute';\n      document.body.appendChild(tombstone);\n      tombstone.style.display = '';\n      this.height = tombstone.offsetHeight;\n      this.width = tombstone.offsetWidth;\n      document.body.removeChild(tombstone);\n      this.cached.push(tombstone);\n    }\n  };\n\n  Tombstone.prototype.getOne = function () {\n    var tombstone = this.cached.pop();\n\n    if (tombstone) {\n      var tombstoneStyle = tombstone.style;\n      tombstoneStyle.display = '';\n      tombstoneStyle.opacity = '1';\n      tombstoneStyle[style.transform] = '';\n      tombstoneStyle[style.transition] = '';\n      return tombstone;\n    }\n\n    return this.create();\n  };\n\n  Tombstone.prototype.recycle = function (tombstones) {\n    for (var _i = 0, tombstones_1 = tombstones; _i < tombstones_1.length; _i++) {\n      var tombstone = tombstones_1[_i];\n      tombstone.style.display = 'none';\n      this.cached.push(tombstone);\n    }\n\n    return this.cached;\n  };\n\n  Tombstone.prototype.recycleOne = function (tombstone) {\n    this.cached.push(tombstone);\n    return this.cached;\n  };\n\n  return Tombstone;\n}();\n\nvar ANIMATION_DURATION_MS = 200;\n\nvar DomManager =\n/** @class */\nfunction () {\n  function DomManager(content, renderFn, tombstone) {\n    this.content = content;\n    this.renderFn = renderFn;\n    this.tombstone = tombstone;\n    this.unusedDom = [];\n    this.timers = [];\n  }\n\n  DomManager.prototype.update = function (list, start, end) {\n    if (start >= list.length) {\n      start = list.length - 1;\n    }\n\n    if (end > list.length) {\n      end = list.length;\n    }\n\n    this.collectUnusedDom(list, start, end);\n    this.createDom(list, start, end);\n    this.cacheHeight(list, start, end);\n\n    var _a = this.positionDom(list, start, end),\n        startPos = _a.startPos,\n        startDelta = _a.startDelta,\n        endPos = _a.endPos;\n\n    return {\n      start: start,\n      startPos: startPos,\n      startDelta: startDelta,\n      end: end,\n      endPos: endPos\n    };\n  };\n\n  DomManager.prototype.collectUnusedDom = function (list, start, end) {\n    // TODO optimise\n    for (var i = 0; i < list.length; i++) {\n      if (i === start) {\n        i = end - 1;\n        continue;\n      }\n\n      if (list[i].dom) {\n        var dom = list[i].dom;\n\n        if (Tombstone.isTombstone(dom)) {\n          this.tombstone.recycleOne(dom);\n          dom.style.display = 'none';\n        } else {\n          this.unusedDom.push(dom);\n        }\n\n        list[i].dom = null;\n      }\n    }\n\n    return list;\n  };\n\n  DomManager.prototype.createDom = function (list, start, end) {\n    for (var i = start; i < end; i++) {\n      var dom = list[i].dom;\n      var data = list[i].data;\n\n      if (dom) {\n        if (Tombstone.isTombstone(dom) && data) {\n          list[i].tombstone = dom;\n          list[i].dom = null;\n        } else {\n          continue;\n        }\n      }\n\n      dom = data ? this.renderFn(data, this.unusedDom.pop()) : this.tombstone.getOne();\n      dom.style.position = 'absolute';\n      list[i].dom = dom;\n      list[i].pos = -1;\n      this.content.appendChild(dom);\n    }\n  };\n\n  DomManager.prototype.cacheHeight = function (list, start, end) {\n    for (var i = start; i < end; i++) {\n      if (list[i].data && !list[i].height) {\n        list[i].height = list[i].dom.offsetHeight;\n      }\n    }\n  };\n\n  DomManager.prototype.positionDom = function (list, start, end) {\n    var _this = this;\n\n    var tombstoneEles = [];\n\n    var _a = this.getStartPos(list, start, end),\n        startPos = _a.start,\n        startDelta = _a.delta;\n\n    var pos = startPos; // TODO transition\n\n    for (var i = start; i < end; i++) {\n      var tombstone = list[i].tombstone;\n\n      if (tombstone) {\n        var tombstoneStyle = tombstone.style;\n        tombstoneStyle[style.transition] = cssVendor + \"transform \" + ANIMATION_DURATION_MS + \"ms, opacity \" + ANIMATION_DURATION_MS + \"ms\";\n        tombstoneStyle[style.transform] = \"translateY(\" + pos + \"px)\";\n        tombstoneStyle.opacity = '0';\n        list[i].tombstone = null;\n        tombstoneEles.push(tombstone);\n      }\n\n      if (list[i].dom && list[i].pos !== pos) {\n        list[i].dom.style[style.transform] = \"translateY(\" + pos + \"px)\";\n        list[i].pos = pos;\n      }\n\n      pos += list[i].height || this.tombstone.height;\n    }\n\n    var timerId = window.setTimeout(function () {\n      _this.tombstone.recycle(tombstoneEles);\n    }, ANIMATION_DURATION_MS);\n    this.timers.push(timerId);\n    return {\n      startPos: startPos,\n      startDelta: startDelta,\n      endPos: pos\n    };\n  };\n\n  DomManager.prototype.getStartPos = function (list, start, end) {\n    if (list[start] && list[start].pos !== -1) {\n      return {\n        start: list[start].pos,\n        delta: 0\n      };\n    } // TODO optimise\n\n\n    var pos = list[0].pos === -1 ? 0 : list[0].pos;\n\n    for (var i_1 = 0; i_1 < start; i_1++) {\n      pos += list[i_1].height || this.tombstone.height;\n    }\n\n    var originPos = pos;\n    var i;\n\n    for (i = start; i < end; i++) {\n      if (!Tombstone.isTombstone(list[i].dom) && list[i].pos !== -1) {\n        pos = list[i].pos;\n        break;\n      }\n    }\n\n    var x = i;\n\n    if (x < end) {\n      while (x > start) {\n        pos -= list[x - 1].height;\n        x--;\n      }\n    }\n\n    var delta = originPos - pos;\n    return {\n      start: pos,\n      delta: delta\n    };\n  };\n\n  DomManager.prototype.removeTombstone = function () {\n    var tombstones = this.content.querySelectorAll('.tombstone');\n\n    for (var i = tombstones.length - 1; i >= 0; i--) {\n      this.content.removeChild(tombstones[i]);\n    }\n  };\n\n  DomManager.prototype.destroy = function () {\n    this.removeTombstone();\n    this.timers.forEach(function (id) {\n      clearTimeout(id);\n    });\n  };\n\n  return DomManager;\n}();\n\nvar EXTRA_SCROLL_Y = -2000;\n\nvar InfinityScroll =\n/** @class */\nfunction () {\n  function InfinityScroll(bscroll) {\n    this.bscroll = bscroll;\n    this.start = 0;\n    this.end = 0;\n\n    if (bscroll.options.infinity) {\n      this.bscroll.options.probeType = 3\n      /* Realtime */\n      ;\n      this.bscroll.scroller.scrollBehaviorY.hasScroll = true;\n      this.bscroll.scroller.scrollBehaviorY.maxScrollPos = EXTRA_SCROLL_Y;\n      this.init(bscroll.options.infinity);\n    }\n  }\n\n  InfinityScroll.prototype.init = function (options) {\n    var fetchFn = options.fetch,\n        renderFn = options.render,\n        createTombstoneFn = options.createTombstone;\n    this.tombstone = new Tombstone(createTombstoneFn);\n    this.indexCalculator = new IndexCalculator(this.bscroll.scroller.scrollBehaviorY.wrapperSize, this.tombstone.height);\n    this.domManager = new DomManager(this.bscroll.scroller.content, renderFn, this.tombstone);\n    this.dataManager = new DataManager([], fetchFn, this.onFetchFinish.bind(this));\n    this.bscroll.on('destroy', this.destroy, this);\n    this.bscroll.on('scroll', this.update, this);\n    this.update({\n      y: 0\n    });\n  };\n\n  InfinityScroll.prototype.update = function (pos) {\n    var position = Math.round(-pos.y); // important! calculate start/end index to render\n\n    var _a = this.indexCalculator.calculate(position, this.dataManager.getList()),\n        start = _a.start,\n        end = _a.end;\n\n    this.start = start;\n    this.end = end; // tslint:disable-next-line: no-floating-promises\n\n    this.dataManager.update(end);\n    this.updateDom(this.dataManager.getList());\n  };\n\n  InfinityScroll.prototype.onFetchFinish = function (list, hasMore) {\n    var end = this.updateDom(list).end;\n\n    if (!hasMore) {\n      this.domManager.removeTombstone();\n      this.bscroll.scroller.animater.stop();\n      this.bscroll.resetPosition();\n    } // tslint:disable-next-line: no-floating-promises\n\n\n    return end;\n  };\n\n  InfinityScroll.prototype.updateDom = function (list) {\n    var _a = this.domManager.update(list, this.start, this.end),\n        end = _a.end,\n        startPos = _a.startPos,\n        endPos = _a.endPos,\n        startDelta = _a.startDelta;\n\n    if (startDelta) {\n      this.bscroll.minScrollY = startDelta;\n    }\n\n    if (endPos > this.bscroll.maxScrollY) {\n      this.bscroll.maxScrollY = -(endPos - this.bscroll.scroller.scrollBehaviorY.wrapperSize);\n    }\n\n    return {\n      end: end,\n      startPos: startPos,\n      endPos: endPos\n    };\n  };\n\n  InfinityScroll.prototype.destroy = function () {\n    var content = this.bscroll.scroller.content;\n\n    while (content.firstChild) {\n      content.removeChild(content.firstChild);\n    }\n\n    this.domManager.destroy();\n    this.bscroll.off('scroll', this.update);\n    this.bscroll.off('destroy', this.destroy);\n  };\n\n  InfinityScroll.pluginName = 'infinity';\n  return InfinityScroll;\n}();\n\nBScroll.use(MouseWheel).use(ObserveDOM).use(PullDown).use(PullUp).use(ScrollBar).use(Slide).use(Wheel).use(Zoom).use(NestedScroll).use(InfinityScroll);\nexport default BScroll;","map":{"version":3,"sources":["C:/Users/86136/Desktop/学习进度/new_html/fullstack_yyf/react/cloud-music/node_modules/better-scroll/dist/better-scroll.esm.js"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","warn","msg","console","error","inBrowser","window","ua","navigator","userAgent","toLowerCase","isWeChatDevTools","test","isAndroid","indexOf","getNow","performance","now","timing","navigationStart","Date","extend","target","rest","_i","source","key","isUndef","undefined","isPlainObject","getDistance","x","Math","sqrt","fixInboundValue","min","max","elementStyle","document","createElement","style","vendor","transformNames","webkit","Moz","O","ms","standard","prefixStyle","charAt","toUpperCase","substr","getElement","el","querySelector","addEvent","type","fn","capture","addEventListener","passive","removeEvent","removeEventListener","offset","left","top","offsetLeft","offsetTop","offsetParent","offsetToBody","rect","getBoundingClientRect","pageXOffset","pageYOffset","cssVendor","transform","transition","hasPerspective","hasTouch","hasTransition","transitionTimingFunction","transitionDuration","transitionDelay","transformOrigin","transitionEnd","eventTypeMap","touchstart","touchmove","touchend","mousedown","mousemove","mouseup","getRect","SVGElement","width","height","offsetWidth","offsetHeight","preventDefaultExceptionFn","exceptions","tagExceptionFn","tap","eventName","ev","createEvent","initEvent","pageX","pageY","dispatchEvent","click","event","eventSource","changedTouches","posSrc","screenX","screenY","clientX","clientY","bubbles","cancelable","MouseEvent","forwardedTouchEvent","_constructed","dblclick","prepend","firstChild","before","appendChild","parentNode","insertBefore","removeChild","child","hasClass","className","reg","RegExp","ease","swipe","swipeBounce","bounce","DEFAULT_INTERVAL","windowCompat","noop","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","callback","setTimeout","interval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","id","clearTimeout","noop$1","val","sharedPropertyDefinition","enumerable","configurable","get","set","getProperty","obj","keys","split","lastKey","setProperty","temp","propertiesProxy","sourceKey","proxyGetter","proxySetter","defineProperty","EventEmitter","names","events","eventTypes","registerType","on","context","hasType","once","_this","magic","args","off","count","splice","trigger","len","eventsCopy","slice","ret","event_1","forEach","destroy","types","isType","map","JSON","stringify","EventRegister","wrapper","addDOMEvents","removeDOMEvents","handleDOMEvents","eventOperation","name","handleEvent","eventType","some","handler","Options","startX","startY","scrollX","scrollY","freeScroll","directionLockThreshold","eventPassthrough","bottom","right","bounceTime","momentum","momentumLimitTime","momentumLimitDistance","swipeTime","swipeBounceTime","deceleration","flickLimitTime","flickLimitDistance","resizePolling","probeType","stopPropagation","preventDefault","preventDefaultException","tagName","tagException","HWCompositing","useTransition","bindToWrapper","disableMouse","disableTouch","autoBlur","merge","options","process","translateZ","resolveBounce","directions","makeMap","ActionsHandler","hooks","_a","wrapperEvents","targetEvents","shouldRegisterTouch","shouldRegisterMouse","bind","start","move","end","wrapperEventRegister","targetEventRegister","beforeHandler","preventDefaultConditions","setInitiated","initiated","_eventType","button","beforeStart","point","touches","pointX","pointY","deltaX","deltaY","scrollLeft","documentElement","scrollTop","pX","pY","clientWidth","clientHeight","translaterMetaData","Translater","content","getComputedPosition","cssStyle","getComputedStyle","matrix","translate","transformStyle","transformFnName","transformFnArgUnit","transformFnArg","beforeTranslate","join","Base","translater","endPoint","setPending","pending","setForceStopped","forceStopped","timer","Transition","_super","startProbe","probe","pos","transitionTime","time","easing","timeFunction","startPoint","easingFn","isSlient","_reflow","stop","beforeForceStop","forceStop","Animation","animate","duration","startTime","destTime","newPoint","startValue","endValue","createAnimater","element","animaterOptions","Behavior","children","currentPos","startPos","direction","movingDirection","dist","delta","hasScroll","newPos","minScrollPos","maxScrollPos","bounces","momentumInfo","absDist","abs","wrapperSize","destination","current","lowerMargin","upperMargin","distance","speed","momentumData","rate","round","updateDirection","absStartPos","refresh","size","position","isWrapperStatic","wrapperRect","contentRect","contentSize","relativeOffset","scrollable","updatePosition","getCurrentPos","checkInBoundary","adjustPosition","inBoundary","roundPos","updateStartPos","updateAbsStartPos","resetStartPos","getAbsDist","_b","_c","_d","PassthroughHandlers","DirectionMap","DirectionLockAction","reset","directionLocked","checkMovingDirection","absDistX","absDistY","computeDirectionLock","handleEventPassthrough","adjustDelta","handleMap","ScrollerActions","scrollBehaviorX","scrollBehaviorY","actionsHandler","animater","directionLockAction","enabled","bindActionsHandler","handleStart","handleMove","handleEnd","handleClick","timestamp","moved","beforeMove","checkMomentum","newX","newY","scrollStart","dispatchScroll","scroll","endTime","beforeEnd","scrollEnd","createActionsHandlerOptions","bsOptions","reduce","prev","cur","createBehaviorOptions","extraProp","bubbling","sourceEvent","targetEvent","concat","Scroller","_e","actions","resizeHandler","resize","resizeRegister","transitionEndRegister","init","bindTranslater","bindAnimater","bindActions","togglePointerEvents","updatePositions","resetPosition","beforeScrollStart","touchEnd","checkClick","scrollCancel","checkFlick","flick","meta","swiper","momentumX","momentumY","scrollTo","preventClick","_dblclick","dblclickTrigged","lastClickTime","delay","resizeTimeout","pointerEvents","node","isBScrollContainer","wrapperOffset","scrollBy","extraTransform","isSilent","ignoreDisMoveForSamePos","scrollToElement","offsetX","offsetY","targetEle","getOffset","getPos","wrapperPos","scrollBehavior","xInBoundary","yInBoundary","enable","disable","propertiesConfig","BScroll","plugins","use","ctor","pluginName","installed","plugin","pluginsMap","applyOrder","scroller","eventBubbling","handleAutoBlur","innerRefresh","proxy","applyPlugins","sort","a","applyOrderMap","aOrder","bOrder","item","activeElement","blur","eventRegister","MouseWheel","wheelStart","mouseWheelOpt","mouseWheel","deltaCache","registorEvent","hooksFn","registorHooks","eventRegistor","wheelEndTimer","wheelMoveTimer","hooksName","handlerFn","wheelHandler","wheelStartHandler","getWheelDelta","wheelMove","wheelStopDetactor","mousewheelStart","delayTime","throttle","mousewheelEnd","invert","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","detail","directionX","directionY","debounce","cachedDelta","mousewheelMove","easeTime","getEaseTime","DEFAULT_EASETIME","SAFE_EASETIME","ObserveDOM","stopObserver","stopObserve","MutationObserver","timer_1","observer","mutations","mutationObserverHandler","startObserve","checkDOMUpdate","shouldNotRefresh","immediateRefresh","deferredRefresh","mutation","config","attributes","childList","subtree","observe","isPullingDown","pullDownRefresh","pulling","outsideBoundaries","me","scrollIns","scrollerEl","scrollerRect","oldWidth","oldHeight","check","newWidth","newHeight","disconnect","sourcePrefix","propertiesMap","propertiesProxyConfig","PullDown","_watch","_checkPullDown","threshold","originalMinScrollY","minScrollY","finish","open","close","autoPull","sourcePrefix$1","propertiesMap$1","propertiesProxyConfig$1","PullUp","bscroll","watching","pullUpLoad","_checkToEnd","movingDirectionY","maxScrollY","EventHandler","indicator","startEventRegister","_start","endEventRegister","_end","lastPoint","keysMap","pointPos","moveEventRegister","_move","INDICATOR_MIN_LEN","Indicator","keyVals","sizeRatio","maxPos","initialSize","curPos","hooksHandlers","wrapperStyle","elStyle","_getKeysMap","fade","visible","opacity","_listenHooks","interactive","bscrollHooks","translaterHooks","animaterHooks","_listen","updatePosAndSize","setTransitionTime","setTransitionTimingFunction","eventHandler","eventHandlerHooks","startHandler","moveHandler","endHandler","scrollerSize","maxScroll","_setShowBy","_refreshKeyValues","display","_refreshPosAndSizeValue","_refreshPosAndSizeStyle","posKey","sizeKey","newScrollPos","_calScrollDesPos","ScrollBar","indicators","scrollbar","_initIndicators","indicatorOption","scrolls","_createIndicatorElement","scrollbarEl","indicatorEl","cssText","PagesPos","slideOpt","slideEl","scrollerIns","wrapperWidth","wrapperHeight","scrollerHeight","scrollerWidth","stepX","stepY","slideEls","querySelectorAll","pages","computePagePosInfoByEl","computePagePosInfo","xLen","yLen","hasInfo","getNearestPage","l","cx","cy","maxScrollPosX","maxScrollPosY","m","maxScrollX","PageInfo","currentPage","pagesPos","checkSlideLoop","changeCurrentPage","newPage","change2safePage","getInitPage","initPageX","loopX","initPageY","loopY","getRealPage","page","fixedPage","realPageLen","pageIndex","unshift","getPageSize","realPage2Page","lastX","lastY","firstX","firstY","realX","realY","nextPage","changedPageNum","prevPage","nearestPage","pageInfo","getLoopStage","needLoop","resetLoopPage","isSameWithCurrent","slideX","slideY","loop","sourcePrefix$2","propertiesMap$2","propertiesConfig$1","Slide","resetLooping","isTouching","slide","willChangeToPage","lazyInitByRefresh","cloneSlideEleForLoop","shouldRefreshByWidth","setSlideWidth","shouldRefreshByHeight","setSlideHeight","shouldRefresh","scrollHooks","scrollerHooks","initSlideState","modifyScrollMetaHandler","amendCurrentPage","setTouchFlag","scrollMoving","listenFlick","flickHandler","slideWrapper","clearSlideWidth","clearSlideHeight","goTo","goToPage","getCurrentPage","triggerThreshold","thresholdX","thresholdY","initThreshold","initPage","slideThreshold","pageSize","cloneNode","isScrollToBoundary","changePage","pageWillChangeTo","shouldSetWidthHeight","checkType","checkMap","checkOption","slideItemDom","removeAttribute","slideItemWidth","newPageInfo","scrollEasing","posX","posY","getAnimateTime","scrollMeta","changeToPage","sourcePrefix$3","propertiesMap$3","propertiesConfig$2","CONSTANTS","Wheel","wheel","normalizeOptions","tapIntoHooks","wheelTo","selectedIndex","index","from","items","adjustTime","findNearestValidWheel","wheelItemClass","maxDistance","minDuration","validWheel","rotateX","checkWheelAllDisabled","itemHeight","minScrollX","getSelectedIndex","rotate","deg","currentIndex","cacheIndex","wheelDisabledItemClassName","wheelDisabledItemClass","wheelItemsAllDisabled","wheelWrapperClass","sourcePrefix$4","propertiesMap$4","propertiesConfig$3","Zoom","scale","zoomOpt","zoom","lastTransformScale","scaleElement","scaleElementInitSize","initScrollBoundary","zoomStart","zooming","zoomEnd","zoomTo","originX","originY","_zoomTo","firstFinger","secondFinger","startDistance","getFingerDistance","startScale","origin","currentDistance","currentScale","scaleCure","lastScale","getNewPos","resetBoundaries","fixInScaleLimit","extendValue","sideName","floor","fixInBound","pow","compatibleFeatures","duplicateClick","parentScroll","childScroll","nestedScroll","scrollsPair","parentScrollX","parentScrollY","childScrollX","childScrollY","oppositeScroll","setupData","checkBeyondBoundary","NestedScroll","singleton","stores","setup","addHooks","appendBScroll","handleContainRelationship","handleCompatible","teardown","removeBScroll","__parentInfo","outerBS","outerBSWrapper","innerBS","innerBSWrapper","j","contains","parent","depth","calculateDepths","currentDepths","prevDepths","pairs","availableBScrolls","pair","filter","bs","childNode","hasHorizontalScroll","hasVerticalScroll","hasReachLeft","hasReachRight","hasReachTop","hasReachBottom","PRE_NUM","POST_NUM","IndexCalculator","tombstoneHeight","lastDirection","lastPos","calculate","list","getDirection","calculateIndex","tombstone","ListItem","data","dom","DataManager","fetchFn","onFetchFinish","loadedNum","fetching","hasMore","update","addEmptyData","checkToFetch","add","fetch","newData","currentEnd","getList","Tombstone","cached","initialed","getSize","isTombstone","classList","getOne","tombstoneStyle","recycle","tombstones","tombstones_1","recycleOne","ANIMATION_DURATION_MS","DomManager","renderFn","unusedDom","timers","collectUnusedDom","createDom","cacheHeight","positionDom","startDelta","endPos","tombstoneEles","getStartPos","timerId","i_1","originPos","removeTombstone","EXTRA_SCROLL_Y","InfinityScroll","infinity","render","createTombstoneFn","createTombstone","indexCalculator","domManager","dataManager","updateDom"],"mappings":"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","sourcesContent":["/*!\n * better-scroll / better-scroll\n * (c) 2016-2020 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = ua && /wechatdevtools/.test(ua);\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\n\nfunction getNow() {\r\n    return window.performance && window.performance.now && window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nfunction extend(target) {\r\n    var rest = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        rest[_i - 1] = arguments[_i];\r\n    }\r\n    for (var i = 0; i < rest.length; i++) {\r\n        var source = rest[i];\r\n        for (var key in source) {\r\n            target[key] = source[key];\r\n        }\r\n    }\r\n    return target;\r\n}\r\nfunction isUndef(v) {\r\n    return v === undefined || v === null;\r\n}\r\nfunction isPlainObject(v) {\r\n    return typeof v === 'object' && v !== null;\r\n}\r\nfunction getDistance(x, y) {\r\n    return Math.sqrt(x * x + y * y);\r\n}\r\nfunction fixInboundValue(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = {\r\n        webkit: 'webkitTransform',\r\n        Moz: 'MozTransform',\r\n        O: 'OTransform',\r\n        ms: 'msTransform',\r\n        standard: 'transform'\r\n    };\r\n    for (var key in transformNames) {\r\n        if (elementStyle[transformNames[key]] !== undefined) {\r\n            return key;\r\n        }\r\n    }\r\n    return false;\r\n})();\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction getElement(el) {\r\n    return (typeof el === 'string'\r\n        ? document.querySelector(el)\r\n        : el);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    el.addEventListener(type, fn, {\r\n        passive: false,\r\n        capture: !!capture\r\n    });\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture\r\n    });\r\n}\r\nfunction offset(el) {\r\n    var left = 0;\r\n    var top = 0;\r\n    while (el) {\r\n        left -= el.offsetLeft;\r\n        top -= el.offsetTop;\r\n        el = el.offsetParent;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top\r\n    };\r\n}\r\nfunction offsetToBody(el) {\r\n    var rect = el.getBoundingClientRect();\r\n    return {\r\n        left: -(rect.left + window.pageXOffset),\r\n        top: -(rect.top + window.pageYOffset)\r\n    };\r\n}\r\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\n// fix issue #361\r\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\r\nvar hasTransition = inBrowser && transition in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd')\r\n};\r\nvar eventTypeMap = {\r\n    touchstart: 1,\r\n    touchmove: 1,\r\n    touchend: 1,\r\n    mousedown: 2,\r\n    mousemove: 2,\r\n    mouseup: 2\r\n};\r\nfunction getRect(el) {\r\n    if (el instanceof window.SVGElement) {\r\n        var rect = el.getBoundingClientRect();\r\n        return {\r\n            top: rect.top,\r\n            left: rect.left,\r\n            width: rect.width,\r\n            height: rect.height\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            top: el.offsetTop,\r\n            left: el.offsetLeft,\r\n            width: el.offsetWidth,\r\n            height: el.offsetHeight\r\n        };\r\n    }\r\n}\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar tagExceptionFn = preventDefaultExceptionFn;\r\nfunction tap(e, eventName) {\r\n    var ev = document.createEvent('Event');\r\n    ev.initEvent(eventName, true, true);\r\n    ev.pageX = e.pageX;\r\n    ev.pageY = e.pageY;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction click(e, event) {\r\n    if (event === void 0) { event = 'click'; }\r\n    var eventSource;\r\n    if (e.type === 'mouseup') {\r\n        eventSource = e;\r\n    }\r\n    else if (e.type === 'touchend' || e.type === 'touchcancel') {\r\n        eventSource = e.changedTouches[0];\r\n    }\r\n    var posSrc = {};\r\n    if (eventSource) {\r\n        posSrc.screenX = eventSource.screenX || 0;\r\n        posSrc.screenY = eventSource.screenY || 0;\r\n        posSrc.clientX = eventSource.clientX || 0;\r\n        posSrc.clientY = eventSource.clientY || 0;\r\n    }\r\n    var ev;\r\n    var bubbles = true;\r\n    var cancelable = true;\r\n    if (typeof MouseEvent !== 'undefined') {\r\n        try {\r\n            ev = new MouseEvent(event, extend({\r\n                bubbles: bubbles,\r\n                cancelable: cancelable\r\n            }, posSrc));\r\n        }\r\n        catch (e) {\r\n            createEvent();\r\n        }\r\n    }\r\n    else {\r\n        createEvent();\r\n    }\r\n    function createEvent() {\r\n        ev = document.createEvent('Event');\r\n        ev.initEvent(event, bubbles, cancelable);\r\n        extend(ev, posSrc);\r\n    }\r\n    // forwardedTouchEvent set to true in case of the conflict with fastclick\r\n    ev.forwardedTouchEvent = true;\r\n    ev._constructed = true;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction dblclick(e) {\r\n    click(e, 'dblclick');\r\n}\r\nfunction prepend(el, target) {\r\n    var firstChild = target.firstChild;\r\n    if (firstChild) {\r\n        before(el, firstChild);\r\n    }\r\n    else {\r\n        target.appendChild(el);\r\n    }\r\n}\r\nfunction before(el, target) {\r\n    target.parentNode.insertBefore(el, target);\r\n}\r\nfunction removeChild(el, child) {\r\n    el.removeChild(child);\r\n}\r\nfunction hasClass(el, className) {\r\n    var reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)');\r\n    return reg.test(el.className);\r\n}\n\nvar ease = {\r\n    // easeOutQuint\r\n    swipe: {\r\n        style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n        fn: function (t) {\r\n            return 1 + --t * t * t * t * t;\r\n        }\r\n    },\r\n    // easeOutQuard\r\n    swipeBounce: {\r\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n        fn: function (t) {\r\n            return t * (2 - t);\r\n        }\r\n    },\r\n    // easeOutQuart\r\n    bounce: {\r\n        style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n        fn: function (t) {\r\n            return 1 - --t * t * t * t;\r\n        }\r\n    }\r\n};\n\nvar DEFAULT_INTERVAL = 100 / 60;\r\nvar windowCompat = inBrowser && window;\r\nfunction noop() { }\r\nvar requestAnimationFrame = (function () {\r\n    if (!inBrowser) {\r\n        /* istanbul ignore if */\r\n        return noop;\r\n    }\r\n    return (windowCompat.requestAnimationFrame ||\r\n        windowCompat.webkitRequestAnimationFrame ||\r\n        windowCompat.mozRequestAnimationFrame ||\r\n        windowCompat.oRequestAnimationFrame ||\r\n        // if all else fails, use setTimeout\r\n        function (callback) {\r\n            return window.setTimeout(callback, (callback.interval || DEFAULT_INTERVAL) / 2); // make interval as precise as possible.\r\n        });\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n    if (!inBrowser) {\r\n        /* istanbul ignore if */\r\n        return noop;\r\n    }\r\n    return (windowCompat.cancelAnimationFrame ||\r\n        windowCompat.webkitCancelAnimationFrame ||\r\n        windowCompat.mozCancelAnimationFrame ||\r\n        windowCompat.oCancelAnimationFrame ||\r\n        function (id) {\r\n            window.clearTimeout(id);\r\n        });\r\n})();\n\nvar noop$1 = function (val) { };\r\nvar sharedPropertyDefinition = {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: noop$1,\r\n    set: noop$1\r\n};\r\nvar getProperty = function (obj, key) {\r\n    var keys = key.split('.');\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        obj = obj[keys[i]];\r\n        if (typeof obj !== 'object' || !obj)\r\n            return;\r\n    }\r\n    var lastKey = keys.pop();\r\n    if (typeof obj[lastKey] === 'function') {\r\n        return function () {\r\n            return obj[lastKey].apply(obj, arguments);\r\n        };\r\n    }\r\n    else {\r\n        return obj[lastKey];\r\n    }\r\n};\r\nvar setProperty = function (obj, key, value) {\r\n    var keys = key.split('.');\r\n    var temp;\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        temp = keys[i];\r\n        if (!obj[temp])\r\n            obj[temp] = {};\r\n        obj = obj[temp];\r\n    }\r\n    obj[keys.pop()] = value;\r\n};\r\nfunction propertiesProxy(target, sourceKey, key) {\r\n    sharedPropertyDefinition.get = function proxyGetter() {\r\n        return getProperty(this, sourceKey);\r\n    };\r\n    sharedPropertyDefinition.set = function proxySetter(val) {\r\n        setProperty(this, sourceKey, val);\r\n    };\r\n    Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            fn.apply(context, args);\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = events.slice();\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar Options = /** @class */ (function () {\r\n    function Options() {\r\n        this.startX = 0;\r\n        this.startY = 0;\r\n        this.scrollX = false;\r\n        this.scrollY = true;\r\n        this.freeScroll = false;\r\n        this.directionLockThreshold = 5;\r\n        this.eventPassthrough = \"\" /* None */;\r\n        this.click = false;\r\n        this.dblclick = false;\r\n        this.tap = '';\r\n        this.bounce = {\r\n            top: true,\r\n            bottom: true,\r\n            left: true,\r\n            right: true\r\n        };\r\n        this.bounceTime = 800;\r\n        this.momentum = true;\r\n        this.momentumLimitTime = 300;\r\n        this.momentumLimitDistance = 15;\r\n        this.swipeTime = 2500;\r\n        this.swipeBounceTime = 500;\r\n        this.deceleration = 0.0015;\r\n        this.flickLimitTime = 200;\r\n        this.flickLimitDistance = 100;\r\n        this.resizePolling = 60;\r\n        this.probeType = 0 /* Default */;\r\n        this.stopPropagation = false;\r\n        this.preventDefault = true;\r\n        this.preventDefaultException = {\r\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/\r\n        };\r\n        this.tagException = {\r\n            tagName: /^TEXTAREA$/\r\n        };\r\n        this.HWCompositing = true;\r\n        this.useTransition = true;\r\n        this.bindToWrapper = false;\r\n        this.disableMouse = hasTouch;\r\n        this.disableTouch = !hasTouch;\r\n        this.autoBlur = true;\r\n    }\r\n    Options.prototype.merge = function (options) {\r\n        if (!options)\r\n            return this;\r\n        for (var key in options) {\r\n            this[key] = options[key];\r\n        }\r\n        return this;\r\n    };\r\n    Options.prototype.process = function () {\r\n        this.translateZ =\r\n            this.HWCompositing && hasPerspective ? ' translateZ(0)' : '';\r\n        this.useTransition = this.useTransition && hasTransition;\r\n        this.preventDefault = !this.eventPassthrough && this.preventDefault;\r\n        this.resolveBounce();\r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.scrollX =\r\n            this.eventPassthrough === \"horizontal\" /* Horizontal */\r\n                ? false\r\n                : this.scrollX;\r\n        this.scrollY =\r\n            this.eventPassthrough === \"vertical\" /* Vertical */ ? false : this.scrollY;\r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.freeScroll = this.freeScroll && !this.eventPassthrough;\r\n        // force true when freeScroll is true\r\n        this.scrollX = this.freeScroll ? true : this.scrollX;\r\n        this.scrollY = this.freeScroll ? true : this.scrollY;\r\n        this.directionLockThreshold = this.eventPassthrough\r\n            ? 0\r\n            : this.directionLockThreshold;\r\n        return this;\r\n    };\r\n    Options.prototype.resolveBounce = function () {\r\n        var directions = ['top', 'right', 'bottom', 'left'];\r\n        var bounce = this.bounce;\r\n        if (bounce === false || bounce === true) {\r\n            this.bounce = makeMap(directions, bounce);\r\n        }\r\n    };\r\n    return Options;\r\n}());\r\nfunction makeMap(keys, val) {\r\n    if (val === void 0) { val = true; }\r\n    var ret = {};\r\n    keys.forEach(function (key) {\r\n        ret[key] = val;\r\n    });\r\n    return ret;\r\n}\n\nvar ActionsHandler = /** @class */ (function () {\r\n    function ActionsHandler(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'start',\r\n            'move',\r\n            'end',\r\n            'click'\r\n        ]);\r\n        this.handleDOMEvents();\r\n    }\r\n    ActionsHandler.prototype.handleDOMEvents = function () {\r\n        var _a = this.options, bindToWrapper = _a.bindToWrapper, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch, click = _a.click;\r\n        var wrapper = this.wrapper;\r\n        var target = bindToWrapper ? wrapper : window;\r\n        var wrapperEvents = [];\r\n        var targetEvents = [];\r\n        var shouldRegisterTouch = hasTouch && !disableTouch;\r\n        var shouldRegisterMouse = !disableMouse;\r\n        if (click) {\r\n            wrapperEvents.push({\r\n                name: 'click',\r\n                handler: this.click.bind(this),\r\n                capture: true\r\n            });\r\n        }\r\n        if (shouldRegisterTouch) {\r\n            wrapperEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this)\r\n            });\r\n            targetEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this)\r\n            }, {\r\n                name: 'touchend',\r\n                handler: this.end.bind(this)\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this)\r\n            });\r\n        }\r\n        if (shouldRegisterMouse) {\r\n            wrapperEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this)\r\n            });\r\n            targetEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this)\r\n            }, {\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this)\r\n            });\r\n        }\r\n        this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\r\n        this.targetEventRegister = new EventRegister(target, targetEvents);\r\n    };\r\n    ActionsHandler.prototype.beforeHandler = function (e, type) {\r\n        var _a = this.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        var preventDefaultConditions = {\r\n            start: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            end: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            move: function () {\r\n                return preventDefault;\r\n            }\r\n        };\r\n        if (preventDefaultConditions[type]()) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.setInitiated = function (type) {\r\n        if (type === void 0) { type = 0; }\r\n        this.initiated = type;\r\n    };\r\n    ActionsHandler.prototype.start = function (e) {\r\n        var _eventType = eventTypeMap[e.type];\r\n        if (this.initiated && this.initiated !== _eventType) {\r\n            return;\r\n        }\r\n        this.setInitiated(_eventType);\r\n        // if textarea or other html tags in options.tagException is manipulated\r\n        // do not make bs scroll\r\n        if (tagExceptionFn(e.target, this.options.tagException)) {\r\n            this.setInitiated();\r\n            return;\r\n        }\r\n        // no mouse left button\r\n        if (_eventType === 2 /* Mouse */ && e.button !== 0 /* Left */)\r\n            return;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'start');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ActionsHandler.prototype.move = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'move');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var deltaX = point.pageX - this.pointX;\r\n        var deltaY = point.pageY - this.pointY;\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.move, {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n            e: e\r\n        })) {\r\n            return;\r\n        }\r\n        // auto end when out of wrapper\r\n        var scrollLeft = document.documentElement.scrollLeft ||\r\n            window.pageXOffset ||\r\n            document.body.scrollLeft;\r\n        var scrollTop = document.documentElement.scrollTop ||\r\n            window.pageYOffset ||\r\n            document.body.scrollTop;\r\n        var pX = this.pointX - scrollLeft;\r\n        var pY = this.pointY - scrollTop;\r\n        if (pX >\r\n            document.documentElement.clientWidth -\r\n                this.options.momentumLimitDistance ||\r\n            pX < this.options.momentumLimitDistance ||\r\n            pY < this.options.momentumLimitDistance ||\r\n            pY >\r\n                document.documentElement.clientHeight -\r\n                    this.options.momentumLimitDistance) {\r\n            this.end(e);\r\n        }\r\n    };\r\n    ActionsHandler.prototype.end = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.setInitiated();\r\n        this.beforeHandler(e, 'end');\r\n        this.hooks.trigger(this.hooks.eventTypes.end, e);\r\n    };\r\n    ActionsHandler.prototype.click = function (e) {\r\n        this.hooks.trigger(this.hooks.eventTypes.click, e);\r\n    };\r\n    ActionsHandler.prototype.destroy = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.hooks.destroy();\r\n    };\r\n    return ActionsHandler;\r\n}());\n\nvar translaterMetaData = {\r\n    x: ['translateX', 'px'],\r\n    y: ['translateY', 'px']\r\n};\r\nvar Translater = /** @class */ (function () {\r\n    function Translater(content) {\r\n        this.content = content;\r\n        this.style = content.style;\r\n        this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\r\n    }\r\n    Translater.prototype.getComputedPosition = function () {\r\n        var cssStyle = window.getComputedStyle(this.content, null);\r\n        var matrix = cssStyle[style.transform].split(')')[0].split(', ');\r\n        var x = +(matrix[12] || matrix[4]);\r\n        var y = +(matrix[13] || matrix[5]);\r\n        return {\r\n            x: x,\r\n            y: y\r\n        };\r\n    };\r\n    Translater.prototype.translate = function (point) {\r\n        var transformStyle = [];\r\n        Object.keys(point).forEach(function (key) {\r\n            if (!translaterMetaData[key]) {\r\n                return;\r\n            }\r\n            var transformFnName = translaterMetaData[key][0];\r\n            if (transformFnName) {\r\n                var transformFnArgUnit = translaterMetaData[key][1];\r\n                var transformFnArg = point[key];\r\n                transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\r\n            }\r\n        });\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\r\n        this.style[style.transform] = transformStyle.join(' ');\r\n        this.hooks.trigger(this.hooks.eventTypes.translate, point);\r\n    };\r\n    Translater.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Translater;\r\n}());\n\nvar Base = /** @class */ (function () {\r\n    function Base(content, translater, options) {\r\n        this.content = content;\r\n        this.translater = translater;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'move',\r\n            'end',\r\n            'beforeForceStop',\r\n            'forceStop',\r\n            'time',\r\n            'timeFunction'\r\n        ]);\r\n        this.style = content.style;\r\n    }\r\n    Base.prototype.translate = function (endPoint) {\r\n        this.translater.translate(endPoint);\r\n    };\r\n    Base.prototype.setPending = function (pending) {\r\n        this.pending = pending;\r\n    };\r\n    Base.prototype.setForceStopped = function (forceStopped) {\r\n        this.forceStopped = forceStopped;\r\n    };\r\n    Base.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n        cancelAnimationFrame(this.timer);\r\n    };\r\n    return Base;\r\n}());\n\nvar Transition = /** @class */ (function (_super) {\r\n    __extends(Transition, _super);\r\n    function Transition() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Transition.prototype.startProbe = function () {\r\n        var _this = this;\r\n        var probe = function () {\r\n            var pos = _this.translater.getComputedPosition();\r\n            _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\r\n            // excute when transition ends\r\n            if (!_this.pending) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\r\n                return;\r\n            }\r\n            _this.timer = requestAnimationFrame(probe);\r\n        };\r\n        cancelAnimationFrame(this.timer);\r\n        this.timer = requestAnimationFrame(probe);\r\n    };\r\n    Transition.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.style[style.transitionDuration] = time + 'ms';\r\n        this.hooks.trigger(this.hooks.eventTypes.time, time);\r\n    };\r\n    Transition.prototype.transitionTimingFunction = function (easing) {\r\n        this.style[style.transitionTimingFunction] = easing;\r\n        this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\r\n    };\r\n    Transition.prototype.move = function (startPoint, endPoint, time, easingFn, isSlient) {\r\n        this.setPending(time > 0 && (startPoint.x !== endPoint.x || startPoint.y !== endPoint.y));\r\n        this.transitionTimingFunction(easingFn);\r\n        this.transitionTime(time);\r\n        this.translate(endPoint);\r\n        if (time && this.options.probeType === 3 /* Realtime */) {\r\n            this.startProbe();\r\n        }\r\n        // if we change content's transformY in a tick\r\n        // such as: 0 -> 50px -> 0\r\n        // transitionend will not be triggered\r\n        // so we forceupdate by reflow\r\n        if (!time) {\r\n            this._reflow = this.content.offsetHeight;\r\n        }\r\n        // no need to dispatch move and end when slient\r\n        if (!time && !isSlient) {\r\n            this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n        }\r\n    };\r\n    Transition.prototype.stop = function () {\r\n        // still in transition\r\n        if (this.pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var _a = this.translater.getComputedPosition(), x = _a.x, y = _a.y;\r\n            this.transitionTime();\r\n            this.translate({ x: x, y: y });\r\n            this.setForceStopped(true);\r\n            if (this.hooks.trigger(this.hooks.eventTypes.beforeForceStop, { x: x, y: y })) {\r\n                return;\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, { x: x, y: y });\r\n        }\r\n    };\r\n    return Transition;\r\n}(Base));\n\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Animation.prototype.move = function (startPoint, endPoint, time, easingFn, isSlient) {\r\n        // time is 0\r\n        if (!time) {\r\n            this.translate(endPoint);\r\n            // if we change content's transformY in a tick\r\n            // such as: 0 -> 50px -> 0\r\n            // transitionend will not be triggered\r\n            // so we forceupdate by reflow\r\n            this._reflow = this.content.offsetHeight;\r\n            // no need to dispatch move and end when slient\r\n            if (isSlient)\r\n                return;\r\n            this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n            return;\r\n        }\r\n        this.animate(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\r\n        var _this = this;\r\n        var startTime = getNow();\r\n        var destTime = startTime + duration;\r\n        var step = function () {\r\n            var now = getNow();\r\n            // js animation end\r\n            if (now >= destTime) {\r\n                _this.translate(endPoint);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                return;\r\n            }\r\n            now = (now - startTime) / duration;\r\n            var easing = easingFn(now);\r\n            var newPoint = {};\r\n            Object.keys(endPoint).forEach(function (key) {\r\n                var startValue = startPoint[key];\r\n                var endValue = endPoint[key];\r\n                newPoint[key] = (endValue - startValue) * easing + startValue;\r\n            });\r\n            _this.translate(newPoint);\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(step);\r\n            }\r\n            if (_this.options.probeType === 3 /* Realtime */) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\r\n            }\r\n        };\r\n        this.setPending(true);\r\n        cancelAnimationFrame(this.timer);\r\n        step();\r\n    };\r\n    Animation.prototype.stop = function () {\r\n        // still in requestFrameAnimation\r\n        if (this.pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var pos = this.translater.getComputedPosition();\r\n            this.setForceStopped(true);\r\n            if (this.hooks.trigger(this.hooks.eventTypes.beforeForceStop, pos)) {\r\n                return;\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\r\n        }\r\n    };\r\n    return Animation;\r\n}(Base));\n\nfunction createAnimater(element, translater, options) {\r\n    var useTransition = options.useTransition;\r\n    var animaterOptions = {};\r\n    Object.defineProperty(animaterOptions, 'probeType', {\r\n        enumerable: true,\r\n        configurable: false,\r\n        get: function () {\r\n            return options.probeType;\r\n        }\r\n    });\r\n    if (useTransition) {\r\n        return new Transition(element, translater, animaterOptions);\r\n    }\r\n    else {\r\n        return new Animation(element, translater, animaterOptions);\r\n    }\r\n}\n\nvar Behavior = /** @class */ (function () {\r\n    function Behavior(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter(['momentum', 'end']);\r\n        this.content = this.wrapper.children[0];\r\n        this.currentPos = 0;\r\n        this.startPos = 0;\r\n    }\r\n    Behavior.prototype.start = function () {\r\n        this.direction = 0 /* Default */;\r\n        this.movingDirection = 0 /* Default */;\r\n        this.dist = 0;\r\n    };\r\n    Behavior.prototype.move = function (delta) {\r\n        delta = this.hasScroll ? delta : 0;\r\n        this.movingDirection =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n        var newPos = this.currentPos + delta;\r\n        // Slow down or stop if outside of the boundaries\r\n        if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\r\n            if ((newPos > this.minScrollPos && this.options.bounces[0]) ||\r\n                (newPos < this.maxScrollPos && this.options.bounces[1])) {\r\n                newPos = this.currentPos + delta / 3;\r\n            }\r\n            else {\r\n                newPos =\r\n                    newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\r\n            }\r\n        }\r\n        return newPos;\r\n    };\r\n    Behavior.prototype.end = function (duration) {\r\n        var momentumInfo = {\r\n            duration: 0\r\n        };\r\n        var absDist = Math.abs(this.currentPos - this.startPos);\r\n        // start momentum animation if needed\r\n        if (this.options.momentum &&\r\n            duration < this.options.momentumLimitTime &&\r\n            absDist > this.options.momentumLimitDistance) {\r\n            var wrapperSize = (this.direction === -1 /* Negative */ && this.options.bounces[0]) ||\r\n                (this.direction === 1 /* Positive */ && this.options.bounces[1])\r\n                ? this.wrapperSize\r\n                : 0;\r\n            momentumInfo = this.hasScroll\r\n                ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options)\r\n                : { destination: this.currentPos, duration: 0 };\r\n        }\r\n        else {\r\n            this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\r\n        }\r\n        return momentumInfo;\r\n    };\r\n    Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n        if (options === void 0) { options = this.options; }\r\n        var distance = current - start;\r\n        var speed = Math.abs(distance) / time;\r\n        var deceleration = options.deceleration, swipeBounceTime = options.swipeBounceTime, swipeTime = options.swipeTime;\r\n        var momentumData = {\r\n            destination: current + (speed / deceleration) * (distance < 0 ? -1 : 1),\r\n            duration: swipeTime,\r\n            rate: 15\r\n        };\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n        if (momentumData.destination < lowerMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n                : lowerMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        else if (momentumData.destination > upperMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n                : upperMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        momentumData.destination = Math.round(momentumData.destination);\r\n        return momentumData;\r\n    };\r\n    Behavior.prototype.updateDirection = function () {\r\n        var absDist = Math.round(this.currentPos) - this.absStartPos;\r\n        this.direction =\r\n            absDist > 0\r\n                ? -1 /* Negative */\r\n                : absDist < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.refresh = function () {\r\n        var _a = this.options.rect, size = _a.size, position = _a.position;\r\n        var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\r\n        var wrapperRect = getRect(this.wrapper);\r\n        this.wrapperSize = wrapperRect[size];\r\n        var contentRect = getRect(this.content);\r\n        this.contentSize = contentRect[size];\r\n        this.relativeOffset = contentRect[position];\r\n        if (isWrapperStatic) {\r\n            this.relativeOffset -= wrapperRect[position];\r\n        }\r\n        this.minScrollPos = 0;\r\n        this.maxScrollPos = this.wrapperSize - this.contentSize;\r\n        if (this.maxScrollPos < 0) {\r\n            this.maxScrollPos -= this.relativeOffset;\r\n            this.minScrollPos = -this.relativeOffset;\r\n        }\r\n        this.hasScroll =\r\n            this.options.scrollable && this.maxScrollPos < this.minScrollPos;\r\n        if (!this.hasScroll) {\r\n            this.maxScrollPos = this.minScrollPos;\r\n            this.contentSize = this.wrapperSize;\r\n        }\r\n        this.direction = 0;\r\n    };\r\n    Behavior.prototype.updatePosition = function (pos) {\r\n        this.currentPos = pos;\r\n    };\r\n    Behavior.prototype.getCurrentPos = function () {\r\n        return Math.round(this.currentPos);\r\n    };\r\n    Behavior.prototype.checkInBoundary = function () {\r\n        var position = this.adjustPosition(this.currentPos);\r\n        var inBoundary = position === this.getCurrentPos();\r\n        return {\r\n            position: position,\r\n            inBoundary: inBoundary\r\n        };\r\n    };\r\n    // adjust position when out of boundary\r\n    Behavior.prototype.adjustPosition = function (pos) {\r\n        var roundPos = Math.round(pos);\r\n        if (!this.hasScroll || roundPos > this.minScrollPos) {\r\n            roundPos = this.minScrollPos;\r\n        }\r\n        else if (roundPos < this.maxScrollPos) {\r\n            roundPos = this.maxScrollPos;\r\n        }\r\n        return roundPos;\r\n    };\r\n    Behavior.prototype.updateStartPos = function () {\r\n        this.startPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.updateAbsStartPos = function () {\r\n        this.absStartPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.resetStartPos = function () {\r\n        this.updateStartPos();\r\n        this.updateAbsStartPos();\r\n    };\r\n    Behavior.prototype.getAbsDist = function (delta) {\r\n        this.dist += delta;\r\n        return Math.abs(this.dist);\r\n    };\r\n    Behavior.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Behavior;\r\n}());\n\nvar _a, _b, _c, _d;\r\nvar PassthroughHandlers = (_a = {},\r\n    _a[\"yes\" /* Yes */] = function (e) {\r\n        return true;\r\n    },\r\n    _a[\"no\" /* No */] = function (e) {\r\n        e.preventDefault();\r\n        return false;\r\n    },\r\n    _a);\r\nvar DirectionMap = (_b = {},\r\n    _b[\"horizontal\" /* Horizontal */] = (_c = {},\r\n        _c[\"yes\" /* Yes */] = \"horizontal\" /* Horizontal */,\r\n        _c[\"no\" /* No */] = \"vertical\" /* Vertical */,\r\n        _c),\r\n    _b[\"vertical\" /* Vertical */] = (_d = {},\r\n        _d[\"yes\" /* Yes */] = \"vertical\" /* Vertical */,\r\n        _d[\"no\" /* No */] = \"horizontal\" /* Horizontal */,\r\n        _d),\r\n    _b);\r\nvar DirectionLockAction = /** @class */ (function () {\r\n    function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\r\n        this.directionLockThreshold = directionLockThreshold;\r\n        this.freeScroll = freeScroll;\r\n        this.eventPassthrough = eventPassthrough;\r\n        this.reset();\r\n    }\r\n    DirectionLockAction.prototype.reset = function () {\r\n        this.directionLocked = \"\" /* Default */;\r\n    };\r\n    DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\r\n        this.computeDirectionLock(absDistX, absDistY);\r\n        return this.handleEventPassthrough(e);\r\n    };\r\n    DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\r\n        if (this.directionLocked === \"horizontal\" /* Horizontal */) {\r\n            deltaY = 0;\r\n        }\r\n        else if (this.directionLocked === \"vertical\" /* Vertical */) {\r\n            deltaX = 0;\r\n        }\r\n        return {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY\r\n        };\r\n    };\r\n    DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\r\n        // If you are scrolling in one direction, lock it\r\n        if (this.directionLocked === \"\" /* Default */ && !this.freeScroll) {\r\n            if (absDistX > absDistY + this.directionLockThreshold) {\r\n                this.directionLocked = \"horizontal\" /* Horizontal */; // lock horizontally\r\n            }\r\n            else if (absDistY >= absDistX + this.directionLockThreshold) {\r\n                this.directionLocked = \"vertical\" /* Vertical */; // lock vertically\r\n            }\r\n            else {\r\n                this.directionLocked = \"none\" /* None */; // no lock\r\n            }\r\n        }\r\n    };\r\n    DirectionLockAction.prototype.handleEventPassthrough = function (e) {\r\n        var handleMap = DirectionMap[this.directionLocked];\r\n        if (handleMap) {\r\n            if (this.eventPassthrough === handleMap[\"yes\" /* Yes */]) {\r\n                return PassthroughHandlers[\"yes\" /* Yes */](e);\r\n            }\r\n            else if (this.eventPassthrough === handleMap[\"no\" /* No */]) {\r\n                return PassthroughHandlers[\"no\" /* No */](e);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return DirectionLockAction;\r\n}());\n\nvar ScrollerActions = /** @class */ (function () {\r\n    function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\r\n        this.hooks = new EventEmitter([\r\n            'start',\r\n            'beforeMove',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'end',\r\n            'scrollEnd'\r\n        ]);\r\n        this.scrollBehaviorX = scrollBehaviorX;\r\n        this.scrollBehaviorY = scrollBehaviorY;\r\n        this.actionsHandler = actionsHandler;\r\n        this.animater = animater;\r\n        this.options = options;\r\n        this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\r\n        this.enabled = true;\r\n        this.bindActionsHandler();\r\n    }\r\n    ScrollerActions.prototype.bindActionsHandler = function () {\r\n        var _this = this;\r\n        // [mouse|touch]start event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleStart(e);\r\n        });\r\n        // [mouse|touch]move event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\r\n            var deltaX = _a.deltaX, deltaY = _a.deltaY, e = _a.e;\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleMove(deltaX, deltaY, e);\r\n        });\r\n        // [mouse|touch]end event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleEnd(e);\r\n        });\r\n        // click\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\r\n            // handle native click event\r\n            if (_this.enabled && !e._constructed) {\r\n                _this.handleClick(e);\r\n            }\r\n        });\r\n    };\r\n    ScrollerActions.prototype.handleStart = function (e) {\r\n        var timestamp = getNow();\r\n        this.moved = false;\r\n        this.startTime = timestamp;\r\n        this.directionLockAction.reset();\r\n        this.scrollBehaviorX.start();\r\n        this.scrollBehaviorY.start();\r\n        // force stopping last transition or animation\r\n        this.animater.stop();\r\n        this.scrollBehaviorX.resetStartPos();\r\n        this.scrollBehaviorY.resetStartPos();\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\r\n            return;\r\n        }\r\n        var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\r\n        var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\r\n        var timestamp = getNow();\r\n        // We need to move at least momentumLimitDistance pixels\r\n        // for the scrolling to initiate\r\n        if (this.checkMomentum(absDistX, absDistY, timestamp)) {\r\n            return true;\r\n        }\r\n        if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\r\n            this.actionsHandler.setInitiated();\r\n            return true;\r\n        }\r\n        var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\r\n        var newX = this.scrollBehaviorX.move(delta.deltaX);\r\n        var newY = this.scrollBehaviorY.move(delta.deltaY);\r\n        if (!this.moved) {\r\n            this.moved = true;\r\n            this.hooks.trigger(this.hooks.eventTypes.scrollStart);\r\n        }\r\n        this.animater.translate({\r\n            x: newX,\r\n            y: newY\r\n        });\r\n        this.dispatchScroll(timestamp);\r\n    };\r\n    ScrollerActions.prototype.dispatchScroll = function (timestamp) {\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > this.options.momentumLimitTime) {\r\n            // refresh time and starting position to initiate a momentum\r\n            this.startTime = timestamp;\r\n            this.scrollBehaviorX.updateStartPos();\r\n            this.scrollBehaviorY.updateStartPos();\r\n            if (this.options.probeType === 1 /* Throttle */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (this.options.probeType > 1 /* Throttle */) {\r\n            this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n        }\r\n    };\r\n    ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\r\n        return (timestamp - this.endTime > this.options.momentumLimitTime &&\r\n            absDistY < this.options.momentumLimitDistance &&\r\n            absDistX < this.options.momentumLimitDistance);\r\n    };\r\n    ScrollerActions.prototype.handleEnd = function (e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\r\n            return;\r\n        }\r\n        var currentPos = this.getCurrentPos();\r\n        this.scrollBehaviorX.updateDirection();\r\n        this.scrollBehaviorY.updateDirection();\r\n        if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\r\n            return true;\r\n        }\r\n        this.animater.translate(currentPos);\r\n        this.endTime = getNow();\r\n        var duration = this.endTime - this.startTime;\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\r\n    };\r\n    ScrollerActions.prototype.handleClick = function (e) {\r\n        if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ScrollerActions.prototype.getCurrentPos = function () {\r\n        return {\r\n            x: this.scrollBehaviorX.getCurrentPos(),\r\n            y: this.scrollBehaviorY.getCurrentPos()\r\n        };\r\n    };\r\n    ScrollerActions.prototype.refresh = function () {\r\n        this.endTime = 0;\r\n    };\r\n    ScrollerActions.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return ScrollerActions;\r\n}());\n\nfunction createActionsHandlerOptions(bsOptions) {\r\n    var options = [\r\n        'click',\r\n        'bindToWrapper',\r\n        'disableMouse',\r\n        'disableTouch',\r\n        'preventDefault',\r\n        'stopPropagation',\r\n        'tagException',\r\n        'preventDefaultException'\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    return options;\r\n}\r\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\r\n    var options = [\r\n        'momentum',\r\n        'momentumLimitTime',\r\n        'momentumLimitDistance',\r\n        'deceleration',\r\n        'swipeBounceTime',\r\n        'swipeTime'\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    // add extra property\r\n    options.scrollable = bsOptions[extraProp];\r\n    options.bounces = bounces;\r\n    options.rect = rect;\r\n    return options;\r\n}\n\nfunction bubbling(source, target, events) {\r\n    events.forEach(function (event) {\r\n        var sourceEvent;\r\n        var targetEvent;\r\n        if (typeof event === 'string') {\r\n            sourceEvent = targetEvent = event;\r\n        }\r\n        else {\r\n            sourceEvent = event.source;\r\n            targetEvent = event.target;\r\n        }\r\n        source.on(sourceEvent, function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return target.trigger.apply(target, [targetEvent].concat(args));\r\n        });\r\n    });\r\n}\n\nvar Scroller = /** @class */ (function () {\r\n    function Scroller(wrapper, options) {\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'beforeMove',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'scrollEnd',\r\n            'refresh',\r\n            'touchEnd',\r\n            'end',\r\n            'flick',\r\n            'scrollCancel',\r\n            'momentum',\r\n            'scrollTo',\r\n            'ignoreDisMoveForSamePos',\r\n            'scrollToElement',\r\n            'resize'\r\n        ]);\r\n        this.wrapper = wrapper;\r\n        this.content = wrapper.children[0];\r\n        this.options = options;\r\n        var _a = this\r\n            .options.bounce, _b = _a.left, left = _b === void 0 ? true : _b, _c = _a.right, right = _c === void 0 ? true : _c, _d = _a.top, top = _d === void 0 ? true : _d, _e = _a.bottom, bottom = _e === void 0 ? true : _e;\r\n        // direction X\r\n        this.scrollBehaviorX = new Behavior(wrapper, createBehaviorOptions(options, 'scrollX', [left, right], {\r\n            size: 'width',\r\n            position: 'left'\r\n        }));\r\n        // direction Y\r\n        this.scrollBehaviorY = new Behavior(wrapper, createBehaviorOptions(options, 'scrollY', [top, bottom], {\r\n            size: 'height',\r\n            position: 'top'\r\n        }));\r\n        this.translater = new Translater(this.content);\r\n        this.animater = createAnimater(this.content, this.translater, this.options);\r\n        this.actionsHandler = new ActionsHandler(wrapper, createActionsHandlerOptions(this.options));\r\n        this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\r\n        var resizeHandler = this.resize.bind(this);\r\n        this.resizeRegister = new EventRegister(window, [\r\n            {\r\n                name: 'orientationchange',\r\n                handler: resizeHandler\r\n            },\r\n            {\r\n                name: 'resize',\r\n                handler: resizeHandler\r\n            }\r\n        ]);\r\n        this.transitionEndRegister = new EventRegister(this.content, [\r\n            {\r\n                name: style.transitionEnd,\r\n                handler: this.transitionEnd.bind(this)\r\n            }\r\n        ]);\r\n        this.init();\r\n    }\r\n    Scroller.prototype.init = function () {\r\n        var _this = this;\r\n        this.bindTranslater();\r\n        this.bindAnimater();\r\n        this.bindActions();\r\n        // enable pointer events when scrolling ends\r\n        this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\r\n            _this.togglePointerEvents(true);\r\n        });\r\n    };\r\n    Scroller.prototype.bindTranslater = function () {\r\n        var _this = this;\r\n        var hooks = this.translater.hooks;\r\n        hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\r\n            if (_this.options.translateZ) {\r\n                transformStyle.push(_this.options.translateZ);\r\n            }\r\n        });\r\n        // disable pointer events when scrolling\r\n        hooks.on(hooks.eventTypes.translate, function (pos) {\r\n            _this.updatePositions(pos);\r\n            _this.togglePointerEvents(false);\r\n        });\r\n    };\r\n    Scroller.prototype.bindAnimater = function () {\r\n        var _this = this;\r\n        // reset position\r\n        this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\r\n            if (!_this.resetPosition(_this.options.bounceTime)) {\r\n                _this.animater.setPending(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n        });\r\n        bubbling(this.animater.hooks, this.hooks, [\r\n            {\r\n                source: this.animater.hooks.eventTypes.move,\r\n                target: this.hooks.eventTypes.scroll\r\n            },\r\n            {\r\n                source: this.animater.hooks.eventTypes.forceStop,\r\n                target: this.hooks.eventTypes.scrollEnd\r\n            }\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindActions = function () {\r\n        var _this = this;\r\n        var actions = this.actions;\r\n        bubbling(actions.hooks, this.hooks, [\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeStart\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeScrollStart // just for event api\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeMove,\r\n                target: this.hooks.eventTypes.beforeMove\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scrollStart,\r\n                target: this.hooks.eventTypes.scrollStart\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scroll,\r\n                target: this.hooks.eventTypes.scroll\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeEnd,\r\n                target: this.hooks.eventTypes.beforeEnd\r\n            }\r\n        ]);\r\n        actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\r\n            if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\r\n                return true;\r\n            }\r\n            // check if it is a click operation\r\n            if (!actions.moved && _this.checkClick(e)) {\r\n                _this.animater.setForceStopped(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\r\n                return true;\r\n            }\r\n            _this.animater.setForceStopped(false);\r\n            // reset if we are outside of the boundaries\r\n            if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\r\n                return true;\r\n            }\r\n        });\r\n        actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\r\n            var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\r\n            var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\r\n            if (_this.checkFlick(duration, deltaX, deltaY)) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.flick);\r\n                return;\r\n            }\r\n            if (_this.momentum(pos, duration)) {\r\n                return;\r\n            }\r\n            _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n        });\r\n    };\r\n    Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\r\n        // flick\r\n        if (this.hooks.events.flick.length > 1 &&\r\n            duration < this.options.flickLimitTime &&\r\n            deltaX < this.options.flickLimitDistance &&\r\n            deltaY < this.options.flickLimitDistance) {\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.momentum = function (pos, duration) {\r\n        var meta = {\r\n            time: 0,\r\n            easing: ease.swiper,\r\n            newX: pos.x,\r\n            newY: pos.y\r\n        };\r\n        // start momentum animation if needed\r\n        var momentumX = this.scrollBehaviorX.end(duration);\r\n        var momentumY = this.scrollBehaviorY.end(duration);\r\n        meta.newX = isUndef(momentumX.destination)\r\n            ? meta.newX\r\n            : momentumX.destination;\r\n        meta.newY = isUndef(momentumY.destination)\r\n            ? meta.newY\r\n            : momentumY.destination;\r\n        meta.time = Math.max(momentumX.duration, momentumY.duration);\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this);\r\n        // when x or y changed, do momentum animation now!\r\n        if (meta.newX !== pos.x || meta.newY !== pos.y) {\r\n            // change easing function when scroller goes out of the boundaries\r\n            if (meta.newX > this.scrollBehaviorX.minScrollPos ||\r\n                meta.newX < this.scrollBehaviorX.maxScrollPos ||\r\n                meta.newY > this.scrollBehaviorY.minScrollPos ||\r\n                meta.newY < this.scrollBehaviorY.maxScrollPos) {\r\n                meta.easing = ease.swipeBounce;\r\n            }\r\n            this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.checkClick = function (e) {\r\n        // when in the process of pulling down, it should not prevent click\r\n        var cancelable = {\r\n            preventClick: this.animater.forceStopped\r\n        };\r\n        // we scrolled less than momentumLimitDistance pixels\r\n        if (this.hooks.trigger(this.hooks.eventTypes.checkClick))\r\n            return true;\r\n        if (!cancelable.preventClick) {\r\n            var _dblclick = this.options.dblclick;\r\n            var dblclickTrigged = false;\r\n            if (_dblclick && this.lastClickTime) {\r\n                var _a = _dblclick.delay, delay = _a === void 0 ? 300 : _a;\r\n                if (getNow() - this.lastClickTime < delay) {\r\n                    dblclickTrigged = true;\r\n                    dblclick(e);\r\n                }\r\n            }\r\n            if (this.options.tap) {\r\n                tap(e, this.options.tap);\r\n            }\r\n            if (this.options.click &&\r\n                !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n                click(e);\r\n            }\r\n            this.lastClickTime = dblclickTrigged ? null : getNow();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Scroller.prototype.resize = function () {\r\n        var _this = this;\r\n        if (!this.actions.enabled) {\r\n            return;\r\n        }\r\n        // fix a scroll problem under Android condition\r\n        if (isAndroid) {\r\n            this.wrapper.scrollTop = 0;\r\n        }\r\n        if (!this.hooks.trigger(this.hooks.eventTypes.resize)) {\r\n            clearTimeout(this.resizeTimeout);\r\n            this.resizeTimeout = window.setTimeout(function () {\r\n                _this.refresh();\r\n            }, this.options.resizePolling);\r\n        }\r\n    };\r\n    Scroller.prototype.transitionEnd = function (e) {\r\n        if (e.target !== this.content || !this.animater.pending) {\r\n            return;\r\n        }\r\n        var animater = this.animater;\r\n        animater.transitionTime();\r\n        if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\r\n            this.animater.setPending(false);\r\n            if (this.options.probeType !== 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\r\n            }\r\n        }\r\n    };\r\n    Scroller.prototype.togglePointerEvents = function (enabled) {\r\n        if (enabled === void 0) { enabled = true; }\r\n        var el = this.content.children.length\r\n            ? this.content.children\r\n            : [this.content];\r\n        var pointerEvents = enabled ? 'auto' : 'none';\r\n        for (var i = 0; i < el.length; i++) {\r\n            var node = el[i];\r\n            // ignore BetterScroll instance's wrapper DOM\r\n            if (node.isBScrollContainer) {\r\n                continue;\r\n            }\r\n            node.style.pointerEvents = pointerEvents;\r\n        }\r\n    };\r\n    Scroller.prototype.refresh = function () {\r\n        this.scrollBehaviorX.refresh();\r\n        this.scrollBehaviorY.refresh();\r\n        this.actions.refresh();\r\n        this.wrapperOffset = offset(this.wrapper);\r\n    };\r\n    Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        var _a = this.getCurrentPos(), x = _a.x, y = _a.y;\r\n        easing = !easing ? ease.bounce : easing;\r\n        deltaX += x;\r\n        deltaY += y;\r\n        this.scrollTo(deltaX, deltaY, time, easing);\r\n    };\r\n    Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform, isSilent) {\r\n        if (time === void 0) { time = 0; }\r\n        if (extraTransform === void 0) { extraTransform = {\r\n            start: {},\r\n            end: {}\r\n        }; }\r\n        easing = !easing ? ease.bounce : easing;\r\n        var easingFn = this.options.useTransition ? easing.style : easing.fn;\r\n        var currentPos = this.getCurrentPos();\r\n        var startPoint = __assign({ x: currentPos.x, y: currentPos.y }, extraTransform.start);\r\n        var endPoint = __assign({ x: x,\r\n            y: y }, extraTransform.end);\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\r\n        if (!this.hooks.trigger(this.hooks.eventTypes.ignoreDisMoveForSamePos)) {\r\n            // it is an useless move\r\n            if (startPoint.x === endPoint.x && startPoint.y === endPoint.y) {\r\n                return;\r\n            }\r\n        }\r\n        this.animater.move(startPoint, endPoint, time, easingFn, isSilent);\r\n    };\r\n    Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\r\n        var targetEle = getElement(el);\r\n        var pos = offset(targetEle);\r\n        var getOffset = function (offset, size, wrapperSize) {\r\n            if (typeof offset === 'number') {\r\n                return offset;\r\n            }\r\n            // if offsetX/Y are true we center the element to the screen\r\n            return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\r\n        };\r\n        offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\r\n        offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\r\n        var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\r\n            pos -= wrapperPos;\r\n            pos = scrollBehavior.adjustPosition(pos - offset);\r\n            return pos;\r\n        };\r\n        pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\r\n        pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\r\n            return;\r\n        }\r\n        this.scrollTo(pos.left, pos.top, time, easing);\r\n    };\r\n    Scroller.prototype.resetPosition = function (time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        easing = !easing ? ease.bounce : easing;\r\n        var _a = this.scrollBehaviorX.checkInBoundary(), x = _a.position, xInBoundary = _a.inBoundary;\r\n        var _b = this.scrollBehaviorY.checkInBoundary(), y = _b.position, yInBoundary = _b.inBoundary;\r\n        if (xInBoundary && yInBoundary) {\r\n            return false;\r\n        }\r\n        // fix ios 13.4 bouncing\r\n        // see it in issues 982\r\n        this._reflow = this.content.offsetHeight;\r\n        // out of boundary\r\n        this.scrollTo(x, y, time, easing);\r\n        return true;\r\n    };\r\n    Scroller.prototype.updatePositions = function (pos) {\r\n        this.scrollBehaviorX.updatePosition(pos.x);\r\n        this.scrollBehaviorY.updatePosition(pos.y);\r\n    };\r\n    Scroller.prototype.getCurrentPos = function () {\r\n        return this.actions.getCurrentPos();\r\n    };\r\n    Scroller.prototype.enable = function () {\r\n        this.actions.enabled = true;\r\n    };\r\n    Scroller.prototype.disable = function () {\r\n        cancelAnimationFrame(this.animater.timer);\r\n        this.actions.enabled = false;\r\n    };\r\n    Scroller.prototype.destroy = function () {\r\n        var _this = this;\r\n        var keys = [\r\n            'resizeRegister',\r\n            'transitionEndRegister',\r\n            'actionsHandler',\r\n            'actions',\r\n            'hooks',\r\n            'animater',\r\n            'translater',\r\n            'scrollBehaviorX',\r\n            'scrollBehaviorY'\r\n        ];\r\n        keys.forEach(function (key) { return _this[key].destroy(); });\r\n    };\r\n    return Scroller;\r\n}());\n\nvar propertiesConfig = [\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.currentPos',\r\n        key: 'x'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.currentPos',\r\n        key: 'y'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.hasScroll',\r\n        key: 'hasHorizontalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.hasScroll',\r\n        key: 'hasVerticalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.contentSize',\r\n        key: 'scrollerWidth'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.contentSize',\r\n        key: 'scrollerHeight'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\r\n        key: 'maxScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\r\n        key: 'maxScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\r\n        key: 'minScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\r\n        key: 'minScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.movingDirection',\r\n        key: 'movingDirectionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.movingDirection',\r\n        key: 'movingDirectionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.direction',\r\n        key: 'directionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.direction',\r\n        key: 'directionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.actions.enabled',\r\n        key: 'enabled'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.pending',\r\n        key: 'pending'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.stop',\r\n        key: 'stop'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollTo',\r\n        key: 'scrollTo'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBy',\r\n        key: 'scrollBy'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollToElement',\r\n        key: 'scrollToElement'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.resetPosition',\r\n        key: 'resetPosition'\r\n    }\r\n];\n\nvar BScroll = /** @class */ (function (_super) {\r\n    __extends(BScroll, _super);\r\n    function BScroll(el, options) {\r\n        var _this = _super.call(this, [\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick',\r\n            'destroy'\r\n        ]) || this;\r\n        var wrapper = getElement(el);\r\n        if (!wrapper) {\r\n            warn('Can not resolve the wrapper DOM.');\r\n            return _this;\r\n        }\r\n        var content = wrapper.children[0];\r\n        if (!content) {\r\n            warn('The wrapper need at least one child element to be scroller.');\r\n            return _this;\r\n        }\r\n        _this.plugins = {};\r\n        _this.options = new Options().merge(options).process();\r\n        _this.hooks = new EventEmitter([\r\n            'init',\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'destroy'\r\n        ]);\r\n        _this.init(wrapper);\r\n        return _this;\r\n    }\r\n    BScroll.use = function (ctor) {\r\n        var name = ctor.pluginName;\r\n        var installed = this.plugins.some(function (plugin) { return ctor === plugin.ctor; });\r\n        if (installed)\r\n            return this;\r\n        if (isUndef(name)) {\r\n            warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\r\n            return this;\r\n        }\r\n        if (this.pluginsMap[name]) {\r\n            warn(\"This plugin has been registered, maybe you need change plugin's name\");\r\n            return this;\r\n        }\r\n        this.pluginsMap[name] = true;\r\n        this.plugins.push({\r\n            name: name,\r\n            applyOrder: ctor.applyOrder,\r\n            ctor: ctor\r\n        });\r\n        return this;\r\n    };\r\n    BScroll.prototype.init = function (wrapper) {\r\n        this.wrapper = wrapper;\r\n        wrapper.isBScrollContainer = true;\r\n        this.scroller = new Scroller(wrapper, this.options);\r\n        this.eventBubbling();\r\n        this.handleAutoBlur();\r\n        this.innerRefresh();\r\n        this.scroller.scrollTo(this.options.startX, this.options.startY);\r\n        this.enable();\r\n        this.proxy(propertiesConfig);\r\n        this.applyPlugins();\r\n    };\r\n    BScroll.prototype.applyPlugins = function () {\r\n        var _this = this;\r\n        var options = this.options;\r\n        this.constructor.plugins\r\n            .sort(function (a, b) {\r\n            var _a;\r\n            var applyOrderMap = (_a = {},\r\n                _a[\"pre\" /* Pre */] = -1,\r\n                _a[\"post\" /* Post */] = 1,\r\n                _a);\r\n            var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\r\n            var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\r\n            return aOrder - bOrder;\r\n        })\r\n            .forEach(function (item) {\r\n            var ctor = item.ctor;\r\n            if (options[item.name] && typeof ctor === 'function') {\r\n                _this.plugins[item.name] = new ctor(_this);\r\n            }\r\n        });\r\n    };\r\n    BScroll.prototype.handleAutoBlur = function () {\r\n        if (this.options.autoBlur) {\r\n            this.on(this.eventTypes.beforeScrollStart, function () {\r\n                var activeElement = document.activeElement;\r\n                if (activeElement &&\r\n                    (activeElement.tagName === 'INPUT' ||\r\n                        activeElement.tagName === 'TEXTAREA')) {\r\n                    activeElement.blur();\r\n                }\r\n            });\r\n        }\r\n    };\r\n    BScroll.prototype.eventBubbling = function () {\r\n        bubbling(this.scroller.hooks, this, [\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick'\r\n        ]);\r\n    };\r\n    BScroll.prototype.innerRefresh = function () {\r\n        this.scroller.refresh();\r\n        this.hooks.trigger(this.hooks.eventTypes.refresh);\r\n        this.trigger(this.eventTypes.refresh);\r\n    };\r\n    BScroll.prototype.proxy = function (propertiesConfig) {\r\n        var _this = this;\r\n        propertiesConfig.forEach(function (_a) {\r\n            var key = _a.key, sourceKey = _a.sourceKey;\r\n            propertiesProxy(_this, sourceKey, key);\r\n        });\r\n    };\r\n    BScroll.prototype.refresh = function () {\r\n        this.innerRefresh();\r\n        this.scroller.resetPosition();\r\n    };\r\n    BScroll.prototype.enable = function () {\r\n        this.scroller.enable();\r\n        this.hooks.trigger(this.hooks.eventTypes.enable);\r\n        this.trigger(this.eventTypes.enable);\r\n    };\r\n    BScroll.prototype.disable = function () {\r\n        this.scroller.disable();\r\n        this.hooks.trigger(this.hooks.eventTypes.disable);\r\n        this.trigger(this.eventTypes.disable);\r\n    };\r\n    BScroll.prototype.destroy = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.destroy);\r\n        this.trigger(this.eventTypes.destroy);\r\n        this.scroller.destroy();\r\n    };\r\n    BScroll.prototype.eventRegister = function (names) {\r\n        this.registerType(names);\r\n    };\r\n    BScroll.plugins = [];\r\n    BScroll.pluginsMap = {};\r\n    return BScroll;\r\n}(EventEmitter));\n\nvar MouseWheel = /** @class */ (function () {\r\n    function MouseWheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.wheelStart = false;\r\n        scroll.registerType(['mousewheelMove', 'mousewheelStart', 'mousewheelEnd']);\r\n        this.mouseWheelOpt = scroll.options.mouseWheel;\r\n        this.deltaCache = [];\r\n        this.registorEvent();\r\n        this.hooksFn = [];\r\n        this.registorHooks(scroll.hooks, 'destroy', this.destroy);\r\n    }\r\n    MouseWheel.prototype.destroy = function () {\r\n        this.eventRegistor.destroy();\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        window.clearTimeout(this.wheelMoveTimer);\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n    };\r\n    MouseWheel.prototype.registorEvent = function () {\r\n        this.eventRegistor = new EventRegister(this.scroll.scroller.wrapper, [\r\n            {\r\n                name: 'wheel',\r\n                handler: this.wheelHandler.bind(this)\r\n            },\r\n            {\r\n                name: 'mousewheel',\r\n                handler: this.wheelHandler.bind(this)\r\n            },\r\n            {\r\n                name: 'DOMMouseScroll',\r\n                handler: this.wheelHandler.bind(this)\r\n            }\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.wheelHandler = function (e) {\r\n        this.beforeHandler(e);\r\n        // start\r\n        if (!this.wheelStart) {\r\n            this.wheelStartHandler(e);\r\n            this.wheelStart = true;\r\n        }\r\n        // move\r\n        var delta = this.getWheelDelta(e);\r\n        this.wheelMove(delta);\r\n        // end\r\n        this.wheelStopDetactor(e, delta);\r\n    };\r\n    MouseWheel.prototype.wheelStartHandler = function (e) {\r\n        this.deltaCache = [];\r\n        this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\r\n    };\r\n    MouseWheel.prototype.wheelStopDetactor = function (e, delta) {\r\n        var _this = this;\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        var delayTime = this.mouseWheelOpt.throttle || 400;\r\n        this.wheelEndTimer = window.setTimeout(function () {\r\n            _this.wheelStart = false;\r\n            window.clearTimeout(_this.wheelMoveTimer);\r\n            _this.wheelMoveTimer = 0;\r\n            _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\r\n        }, delayTime);\r\n    };\r\n    MouseWheel.prototype.getWheelDelta = function (e) {\r\n        var _a = this.mouseWheelOpt, _b = _a.speed, speed = _b === void 0 ? 20 : _b, _c = _a.invert, invert = _c === void 0 ? false : _c;\r\n        var wheelDeltaX = 0;\r\n        var wheelDeltaY = 0;\r\n        var direction = invert ? -1 /* Negative */ : 1 /* Positive */;\r\n        switch (true) {\r\n            case 'deltaX' in e:\r\n                if (e.deltaMode === 1) {\r\n                    wheelDeltaX = -e.deltaX * speed;\r\n                    wheelDeltaY = -e.deltaY * speed;\r\n                }\r\n                else {\r\n                    wheelDeltaX = -e.deltaX;\r\n                    wheelDeltaY = -e.deltaY;\r\n                }\r\n                break;\r\n            case 'wheelDeltaX' in e:\r\n                wheelDeltaX = (e.wheelDeltaX / 120) * speed;\r\n                wheelDeltaY = (e.wheelDeltaY / 120) * speed;\r\n                break;\r\n            case 'wheelDelta' in e:\r\n                wheelDeltaX = wheelDeltaY = (e.wheelDelta / 120) * speed;\r\n                break;\r\n            case 'detail' in e:\r\n                wheelDeltaX = wheelDeltaY = (-e.detail / 3) * speed;\r\n                break;\r\n        }\r\n        wheelDeltaX *= direction;\r\n        wheelDeltaY *= direction;\r\n        if (!this.scroll.scroller.scrollBehaviorY.hasScroll) {\r\n            wheelDeltaX = wheelDeltaY;\r\n            wheelDeltaY = 0;\r\n        }\r\n        if (!this.scroll.scroller.scrollBehaviorX.hasScroll) {\r\n            wheelDeltaX = 0;\r\n        }\r\n        var directionX = wheelDeltaX > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaX < 0\r\n                ? 1 /* Positive */\r\n                : 0;\r\n        var directionY = wheelDeltaY > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaY < 0\r\n                ? 1 /* Positive */\r\n                : 0;\r\n        return {\r\n            x: wheelDeltaX,\r\n            y: wheelDeltaY,\r\n            directionX: directionX,\r\n            directionY: directionY\r\n        };\r\n    };\r\n    MouseWheel.prototype.beforeHandler = function (e) {\r\n        var _a = this.scroll.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        if (preventDefault &&\r\n            !preventDefaultExceptionFn(e.target, preventDefaultException)) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    MouseWheel.prototype.wheelMove = function (delta) {\r\n        var _this = this;\r\n        if (this.mouseWheelOpt.debounce && this.wheelMoveTimer) {\r\n            this.deltaCache.push(delta);\r\n        }\r\n        else {\r\n            var cachedDelta = this.deltaCache.reduce(function (prev, current) {\r\n                return {\r\n                    x: prev.x + current.x,\r\n                    y: prev.y + current.y\r\n                };\r\n            }, { x: 0, y: 0 });\r\n            this.deltaCache = [];\r\n            var newX = this.scroll.x + Math.round(delta.x) + cachedDelta.x;\r\n            var newY = this.scroll.y + Math.round(delta.y) + cachedDelta.y;\r\n            var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n            var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n            newX = fixInboundValue(newX, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos);\r\n            newY = fixInboundValue(newY, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos);\r\n            if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\r\n                x: newX,\r\n                y: newY\r\n            })) {\r\n                var easeTime = this.getEaseTime();\r\n                if (newX !== this.scroll.x || newY !== this.scroll.y) {\r\n                    this.scroll.scrollTo(newX, newY, easeTime);\r\n                }\r\n            }\r\n            if (this.mouseWheelOpt.debounce) {\r\n                this.wheelMoveTimer = window.setTimeout(function () {\r\n                    _this.wheelMoveTimer = 0;\r\n                }, this.mouseWheelOpt.debounce);\r\n            }\r\n        }\r\n    };\r\n    MouseWheel.prototype.registorHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    MouseWheel.prototype.getEaseTime = function () {\r\n        var DEFAULT_EASETIME = 300;\r\n        var SAFE_EASETIME = 100;\r\n        var easeTime = this.mouseWheelOpt.easeTime || DEFAULT_EASETIME;\r\n        // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\r\n        // easeTime needs to be greater than 100\r\n        if (easeTime < SAFE_EASETIME) {\r\n            warn(\"easeTime should be greater than 100.\\n      If mouseWheel easeTime is too small, scrollEnd will be triggered many times.\");\r\n        }\r\n        return easeTime;\r\n    };\r\n    MouseWheel.pluginName = 'mouseWheel';\r\n    MouseWheel.applyOrder = \"pre\" /* Pre */;\r\n    return MouseWheel;\r\n}());\n\nvar ObserveDOM = /** @class */ (function () {\r\n    function ObserveDOM(scroll) {\r\n        var _this = this;\r\n        this.scroll = scroll;\r\n        this.stopObserver = false;\r\n        this.hooksFn = [];\r\n        this.init();\r\n        this.registorHooks(this.scroll.hooks, 'enable', function () {\r\n            if (_this.stopObserver) {\r\n                _this.init();\r\n            }\r\n        });\r\n        this.registorHooks(this.scroll.hooks, 'disable', function () {\r\n            _this.stopObserve();\r\n        });\r\n        this.registorHooks(this.scroll.hooks, 'destroy', function () {\r\n            _this.destroy();\r\n        });\r\n    }\r\n    ObserveDOM.prototype.init = function () {\r\n        var _this = this;\r\n        if (typeof MutationObserver !== 'undefined') {\r\n            var timer_1 = 0;\r\n            this.observer = new MutationObserver(function (mutations) {\r\n                _this.mutationObserverHandler(mutations, timer_1);\r\n            });\r\n            this.startObserve(this.observer);\r\n        }\r\n        else {\r\n            this.checkDOMUpdate();\r\n        }\r\n    };\r\n    ObserveDOM.prototype.destroy = function () {\r\n        this.stopObserve();\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    ObserveDOM.prototype.mutationObserverHandler = function (mutations, timer) {\r\n        var _this = this;\r\n        if (this.shouldNotRefresh()) {\r\n            return;\r\n        }\r\n        var immediateRefresh = false;\r\n        var deferredRefresh = false;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            var mutation = mutations[i];\r\n            if (mutation.type !== 'attributes') {\r\n                immediateRefresh = true;\r\n                break;\r\n            }\r\n            else {\r\n                if (mutation.target !== this.scroll.scroller.content) {\r\n                    deferredRefresh = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (immediateRefresh) {\r\n            this.scroll.refresh();\r\n        }\r\n        else if (deferredRefresh) {\r\n            // attributes changes too often\r\n            clearTimeout(timer);\r\n            timer = window.setTimeout(function () {\r\n                if (!_this.shouldNotRefresh()) {\r\n                    _this.scroll.refresh();\r\n                }\r\n            }, 60);\r\n        }\r\n    };\r\n    ObserveDOM.prototype.startObserve = function (observer) {\r\n        var config = {\r\n            attributes: true,\r\n            childList: true,\r\n            subtree: true\r\n        };\r\n        observer.observe(this.scroll.scroller.content, config);\r\n    };\r\n    ObserveDOM.prototype.shouldNotRefresh = function () {\r\n        var _a = this.scroll, plugins = _a.plugins, scroller = _a.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        // perform an pulldown action\r\n        var isPullingDown = (plugins.pullDownRefresh || {}).pulling;\r\n        var outsideBoundaries = scrollBehaviorX.currentPos > scrollBehaviorX.minScrollPos ||\r\n            scrollBehaviorX.currentPos < scrollBehaviorX.maxScrollPos ||\r\n            scrollBehaviorY.currentPos > scrollBehaviorY.minScrollPos ||\r\n            scrollBehaviorY.currentPos < scrollBehaviorY.maxScrollPos;\r\n        return scroller.animater.pending || outsideBoundaries || isPullingDown;\r\n    };\r\n    ObserveDOM.prototype.checkDOMUpdate = function () {\r\n        var me = this;\r\n        var scrollIns = this.scroll;\r\n        var scrollerEl = scrollIns.scroller.content;\r\n        var scrollerRect = getRect(scrollerEl);\r\n        var oldWidth = scrollerRect.width;\r\n        var oldHeight = scrollerRect.height;\r\n        function check() {\r\n            if (me.stopObserver) {\r\n                return;\r\n            }\r\n            scrollerRect = getRect(scrollerEl);\r\n            var newWidth = scrollerRect.width;\r\n            var newHeight = scrollerRect.height;\r\n            if (oldWidth !== newWidth || oldHeight !== newHeight) {\r\n                scrollIns.refresh();\r\n            }\r\n            oldWidth = newWidth;\r\n            oldHeight = newHeight;\r\n            next();\r\n        }\r\n        function next() {\r\n            setTimeout(function () {\r\n                check();\r\n            }, 1000);\r\n        }\r\n        next();\r\n    };\r\n    ObserveDOM.prototype.registorHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    ObserveDOM.prototype.stopObserve = function () {\r\n        this.stopObserver = true;\r\n        if (this.observer) {\r\n            this.observer.disconnect();\r\n        }\r\n    };\r\n    ObserveDOM.pluginName = 'observeDOM';\r\n    return ObserveDOM;\r\n}());\n\nvar sourcePrefix = 'plugins.pullDownRefresh';\r\nvar propertiesMap = [\r\n    {\r\n        key: 'finishPullDown',\r\n        name: 'finish'\r\n    },\r\n    {\r\n        key: 'openPullDown',\r\n        name: 'open'\r\n    },\r\n    {\r\n        key: 'closePullDown',\r\n        name: 'close'\r\n    },\r\n    {\r\n        key: 'autoPullDownRefresh',\r\n        name: 'autoPull'\r\n    }\r\n];\r\nvar propertiesProxyConfig = propertiesMap.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix + \".\" + item.name\r\n    };\r\n});\n\nvar PullDown = /** @class */ (function () {\r\n    function PullDown(scroll) {\r\n        this.scroll = scroll;\r\n        this.pulling = false;\r\n        if (scroll.options.pullDownRefresh) {\r\n            this._watch();\r\n        }\r\n        this.scroll.registerType(['pullingDown']);\r\n        this.scroll.proxy(propertiesProxyConfig);\r\n    }\r\n    PullDown.prototype._watch = function () {\r\n        // 需要设置 probe = 3 吗？\r\n        // must watch scroll in real time\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n        this.scroll.scroller.hooks.on('end', this._checkPullDown, this);\r\n    };\r\n    PullDown.prototype._checkPullDown = function () {\r\n        if (!this.scroll.options.pullDownRefresh) {\r\n            return;\r\n        }\r\n        var _a = this.scroll.options\r\n            .pullDownRefresh, _b = _a.threshold, threshold = _b === void 0 ? 90 : _b, _c = _a.stop, stop = _c === void 0 ? 40 : _c;\r\n        // check if a real pull down action\r\n        if (this.scroll.directionY !== -1 /* Negative */ ||\r\n            this.scroll.y < threshold) {\r\n            return false;\r\n        }\r\n        if (!this.pulling) {\r\n            this.pulling = true;\r\n            this.scroll.trigger('pullingDown');\r\n            this.originalMinScrollY = this.scroll.minScrollY;\r\n            this.scroll.minScrollY = stop;\r\n        }\r\n        this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\r\n        return this.pulling;\r\n    };\r\n    PullDown.prototype.finish = function () {\r\n        this.pulling = false;\r\n        this.scroll.minScrollY = this.originalMinScrollY;\r\n        this.scroll.resetPosition(this.scroll.options.bounceTime, ease.bounce);\r\n    };\r\n    PullDown.prototype.open = function (config) {\r\n        if (config === void 0) { config = true; }\r\n        this.scroll.options.pullDownRefresh = config;\r\n        this._watch();\r\n    };\r\n    PullDown.prototype.close = function () {\r\n        this.scroll.options.pullDownRefresh = false;\r\n    };\r\n    PullDown.prototype.autoPull = function () {\r\n        var _a = this.scroll.options\r\n            .pullDownRefresh, _b = _a.threshold, threshold = _b === void 0 ? 90 : _b, _c = _a.stop, stop = _c === void 0 ? 40 : _c;\r\n        if (this.pulling) {\r\n            return;\r\n        }\r\n        this.pulling = true;\r\n        this.originalMinScrollY = this.scroll.minScrollY;\r\n        this.scroll.minScrollY = threshold;\r\n        this.scroll.scrollTo(this.scroll.x, threshold);\r\n        this.scroll.trigger('pullingDown');\r\n        this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\r\n    };\r\n    PullDown.pluginName = 'pullDownRefresh';\r\n    return PullDown;\r\n}());\n\nvar sourcePrefix$1 = 'plugins.pullUpLoad';\r\nvar propertiesMap$1 = [\r\n    {\r\n        key: 'finishPullUp',\r\n        name: 'finish'\r\n    },\r\n    {\r\n        key: 'openPullUp',\r\n        name: 'open'\r\n    },\r\n    {\r\n        key: 'closePullUp',\r\n        name: 'close'\r\n    }\r\n];\r\nvar propertiesProxyConfig$1 = propertiesMap$1.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$1 + \".\" + item.name\r\n    };\r\n});\n\nvar PullUp = /** @class */ (function () {\r\n    function PullUp(bscroll) {\r\n        this.bscroll = bscroll;\r\n        this.watching = false;\r\n        if (bscroll.options.pullUpLoad) {\r\n            this._watch();\r\n        }\r\n        this.bscroll.registerType(['pullingUp']);\r\n        this.bscroll.proxy(propertiesProxyConfig$1);\r\n    }\r\n    PullUp.prototype._watch = function () {\r\n        if (this.watching) {\r\n            return;\r\n        }\r\n        // must watch scroll in real time\r\n        this.bscroll.options.probeType = 3 /* Realtime */;\r\n        this.watching = true;\r\n        this.bscroll.on('scroll', this._checkToEnd, this);\r\n    };\r\n    PullUp.prototype._checkToEnd = function (pos) {\r\n        var _this = this;\r\n        if (!this.bscroll.options.pullUpLoad) {\r\n            return;\r\n        }\r\n        var _a = this.bscroll.options\r\n            .pullUpLoad.threshold, threshold = _a === void 0 ? 0 : _a;\r\n        if (this.bscroll.movingDirectionY === 1 /* Positive */ &&\r\n            pos.y <= this.bscroll.maxScrollY + threshold) {\r\n            // reset pullupWatching status after scroll end to promise that trigger 'pullingUp' only once when pulling up\r\n            this.bscroll.once('scrollEnd', function () {\r\n                _this.watching = false;\r\n            });\r\n            this.bscroll.trigger('pullingUp');\r\n            this.bscroll.off('scroll', this._checkToEnd);\r\n        }\r\n    };\r\n    PullUp.prototype.finish = function () {\r\n        if (this.watching) {\r\n            this.bscroll.once('scrollEnd', this._watch, this);\r\n        }\r\n        else {\r\n            this._watch();\r\n        }\r\n    };\r\n    PullUp.prototype.open = function (config) {\r\n        if (config === void 0) { config = true; }\r\n        this.bscroll.options.pullUpLoad = config;\r\n        this._watch();\r\n    };\r\n    PullUp.prototype.close = function () {\r\n        this.bscroll.options.pullUpLoad = false;\r\n        if (!this.watching) {\r\n            return;\r\n        }\r\n        this.watching = false;\r\n        this.bscroll.off('scroll', this._checkToEnd);\r\n    };\r\n    PullUp.pluginName = 'pullUpLoad';\r\n    return PullUp;\r\n}());\n\nvar EventHandler = /** @class */ (function () {\r\n    function EventHandler(indicator, options) {\r\n        this.indicator = indicator;\r\n        this.options = options;\r\n        this.bscroll = indicator.bscroll;\r\n        this.startEventRegister = new EventRegister(this.indicator.el, [\r\n            {\r\n                name: options.disableMouse ? 'touchstart' : 'mousedown',\r\n                handler: this._start.bind(this)\r\n            }\r\n        ]);\r\n        this.endEventRegister = new EventRegister(window, [\r\n            {\r\n                name: options.disableMouse ? 'touchend' : 'mouseup',\r\n                handler: this._end.bind(this)\r\n            }\r\n        ]);\r\n        this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\r\n    }\r\n    EventHandler.prototype._start = function (e) {\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.initiated = true;\r\n        this.moved = false;\r\n        this.lastPoint = point[this.indicator.keysMap.pointPos];\r\n        var disableMouse = this.bscroll.options.disableMouse;\r\n        this.moveEventRegister = new EventRegister(window, [\r\n            {\r\n                name: disableMouse ? 'touchmove' : 'mousemove',\r\n                handler: this._move.bind(this)\r\n            }\r\n        ]);\r\n        this.hooks.trigger('touchStart');\r\n    };\r\n    EventHandler.prototype._move = function (e) {\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointPos = point[this.indicator.keysMap.pointPos];\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var delta = pointPos - this.lastPoint;\r\n        this.lastPoint = pointPos;\r\n        if (!this.moved) {\r\n            this.hooks.trigger('touchMove', this.moved, delta);\r\n            this.moved = true;\r\n            return;\r\n        }\r\n        this.hooks.trigger('touchMove', this.moved, delta);\r\n    };\r\n    EventHandler.prototype._end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.moveEventRegister.destroy();\r\n        this.hooks.trigger('touchEnd', this.moved);\r\n    };\r\n    EventHandler.prototype.destroy = function () {\r\n        this.startEventRegister.destroy();\r\n        this.moveEventRegister && this.moveEventRegister.destroy();\r\n        this.endEventRegister.destroy();\r\n    };\r\n    return EventHandler;\r\n}());\n\nvar INDICATOR_MIN_LEN = 8;\r\nvar Indicator = /** @class */ (function () {\r\n    function Indicator(bscroll, options) {\r\n        this.bscroll = bscroll;\r\n        this.options = options;\r\n        this.keyVals = {\r\n            sizeRatio: 1,\r\n            maxPos: 0,\r\n            initialSize: 0\r\n        };\r\n        this.curPos = 0;\r\n        this.hooksHandlers = [];\r\n        this.wrapper = options.wrapper;\r\n        this.wrapperStyle = this.wrapper.style;\r\n        this.el = this.wrapper.children[0];\r\n        this.elStyle = this.el.style;\r\n        this.bscroll = bscroll;\r\n        this.direction = options.direction;\r\n        this.keysMap = this._getKeysMap();\r\n        if (options.fade) {\r\n            this.visible = 0;\r\n            this.wrapperStyle.opacity = '0';\r\n        }\r\n        else {\r\n            this.visible = 1;\r\n        }\r\n        this._listenHooks(options.fade, options.interactive);\r\n        this.refresh();\r\n    }\r\n    Indicator.prototype._listenHooks = function (fade, interactive) {\r\n        var _this = this;\r\n        var bscroll = this.bscroll;\r\n        var bscrollHooks = bscroll;\r\n        var translaterHooks = bscroll.scroller.translater.hooks;\r\n        var animaterHooks = bscroll.scroller.animater.hooks;\r\n        this._listen(bscrollHooks, 'refresh', this.refresh);\r\n        this._listen(translaterHooks, 'translate', this.updatePosAndSize);\r\n        this._listen(animaterHooks, 'time', function (time) {\r\n            _this.setTransitionTime(time);\r\n        });\r\n        this._listen(animaterHooks, 'timeFunction', function (ease) {\r\n            _this.setTransitionTimingFunction(ease);\r\n        });\r\n        if (fade) {\r\n            this._listen(bscrollHooks, 'scrollEnd', function () {\r\n                _this.fade();\r\n            });\r\n            this._listen(bscrollHooks, 'scrollStart', function () {\r\n                _this.fade(true);\r\n            });\r\n            // for mousewheel event\r\n            if (bscroll.eventTypes.mousewheelStart &&\r\n                bscroll.eventTypes.mousewheelEnd) {\r\n                this._listen(bscrollHooks, 'mousewheelStart', function () {\r\n                    _this.fade(true);\r\n                });\r\n                this._listen(bscrollHooks, 'mousewheelEnd', function () {\r\n                    _this.fade();\r\n                });\r\n            }\r\n        }\r\n        if (interactive) {\r\n            var disableMouse = this.bscroll.options.disableMouse;\r\n            this.eventHandler = new EventHandler(this, { disableMouse: disableMouse });\r\n            var eventHandlerHooks = this.eventHandler.hooks;\r\n            this._listen(eventHandlerHooks, 'touchStart', this.startHandler);\r\n            this._listen(eventHandlerHooks, 'touchMove', this.moveHandler);\r\n            this._listen(eventHandlerHooks, 'touchEnd', this.endHandler);\r\n        }\r\n    };\r\n    Indicator.prototype._getKeysMap = function () {\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            return {\r\n                hasScroll: 'hasVerticalScroll',\r\n                size: 'height',\r\n                wrapperSize: 'clientHeight',\r\n                scrollerSize: 'scrollerHeight',\r\n                maxScroll: 'maxScrollY',\r\n                pos: 'y',\r\n                pointPos: 'pageY',\r\n                translate: 'translateY'\r\n            };\r\n        }\r\n        return {\r\n            hasScroll: 'hasHorizontalScroll',\r\n            size: 'width',\r\n            wrapperSize: 'clientWidth',\r\n            scrollerSize: 'scrollerWidth',\r\n            maxScroll: 'maxScrollX',\r\n            pos: 'x',\r\n            pointPos: 'pageX',\r\n            translate: 'translateX'\r\n        };\r\n    };\r\n    Indicator.prototype.fade = function (visible) {\r\n        var time = visible ? 250 : 500;\r\n        this.wrapperStyle[style.transitionDuration] = time + 'ms';\r\n        this.wrapperStyle.opacity = visible ? '1' : '0';\r\n        this.visible = visible ? 1 : 0;\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var hasScroll = this.keysMap.hasScroll;\r\n        if (this._setShowBy(this.bscroll[hasScroll])) {\r\n            var _a = this.keysMap, wrapperSize = _a.wrapperSize, scrollerSize = _a.scrollerSize, maxScroll = _a.maxScroll;\r\n            this.keyVals = this._refreshKeyValues(this.wrapper[wrapperSize], this.bscroll[scrollerSize], this.bscroll[maxScroll]);\r\n            this.updatePosAndSize({\r\n                x: this.bscroll.x,\r\n                y: this.bscroll.y\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype._setShowBy = function (hasScroll) {\r\n        if (hasScroll) {\r\n            this.wrapper.style.display = '';\r\n            return true;\r\n        }\r\n        this.wrapper.style.display = 'none';\r\n        return false;\r\n    };\r\n    Indicator.prototype._refreshKeyValues = function (wrapperSize, scrollerSize, maxScroll) {\r\n        var initialSize = Math.max(Math.round((wrapperSize * wrapperSize) / (scrollerSize || wrapperSize || 1)), INDICATOR_MIN_LEN);\r\n        var maxPos = wrapperSize - initialSize;\r\n        // sizeRatio is negative\r\n        var sizeRatio = maxPos / maxScroll;\r\n        return {\r\n            initialSize: initialSize,\r\n            maxPos: maxPos,\r\n            sizeRatio: sizeRatio\r\n        };\r\n    };\r\n    Indicator.prototype.updatePosAndSize = function (endPoint) {\r\n        var _a = this._refreshPosAndSizeValue(endPoint, this.keyVals), pos = _a.pos, size = _a.size;\r\n        this.curPos = pos;\r\n        this._refreshPosAndSizeStyle(size, pos);\r\n    };\r\n    Indicator.prototype._refreshPosAndSizeValue = function (endPoint, keyVals) {\r\n        var posKey = this.keysMap.pos;\r\n        var sizeRatio = keyVals.sizeRatio, initialSize = keyVals.initialSize, maxPos = keyVals.maxPos;\r\n        var pos = Math.round(sizeRatio * endPoint[posKey]);\r\n        var size;\r\n        if (pos < 0) {\r\n            size = Math.max(initialSize + pos * 3, INDICATOR_MIN_LEN);\r\n            pos = 0;\r\n        }\r\n        else if (pos > maxPos) {\r\n            size = Math.max(initialSize - (pos - maxPos) * 3, INDICATOR_MIN_LEN);\r\n            pos = maxPos + initialSize - size;\r\n        }\r\n        else {\r\n            size = initialSize;\r\n        }\r\n        return {\r\n            pos: pos,\r\n            size: size\r\n        };\r\n    };\r\n    Indicator.prototype._refreshPosAndSizeStyle = function (size, pos) {\r\n        var _a = this.keysMap, translate = _a.translate, sizeKey = _a.size;\r\n        this.elStyle[sizeKey] = size + \"px\";\r\n        this.elStyle[style.transform] = translate + \"(\" + pos + \"px)\" + this.bscroll.options.translateZ;\r\n    };\r\n    Indicator.prototype.setTransitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.elStyle[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.setTransitionTimingFunction = function (easing) {\r\n        this.elStyle[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.startHandler = function () {\r\n        this.setTransitionTime();\r\n        this.bscroll.trigger('beforeScrollStart');\r\n    };\r\n    Indicator.prototype.moveHandler = function (moved, delta) {\r\n        if (!moved) {\r\n            this.bscroll.trigger('scrollStart');\r\n        }\r\n        var newScrollPos = this._calScrollDesPos(this.curPos, delta, this.keyVals);\r\n        // TODO freeScroll ？\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            this.bscroll.scrollTo(this.bscroll.x, newScrollPos);\r\n        }\r\n        else {\r\n            this.bscroll.scrollTo(newScrollPos, this.bscroll.y);\r\n        }\r\n        this.bscroll.trigger('scroll', {\r\n            x: this.bscroll.x,\r\n            y: this.bscroll.y\r\n        });\r\n    };\r\n    Indicator.prototype._calScrollDesPos = function (curPos, delta, keyVals) {\r\n        var maxPos = keyVals.maxPos, sizeRatio = keyVals.sizeRatio;\r\n        var newPos = curPos + delta;\r\n        if (newPos < 0) {\r\n            newPos = 0;\r\n        }\r\n        else if (newPos > maxPos) {\r\n            newPos = maxPos;\r\n        }\r\n        return Math.round(newPos / sizeRatio);\r\n    };\r\n    Indicator.prototype.endHandler = function (moved) {\r\n        if (moved) {\r\n            this.bscroll.trigger('scrollEnd', {\r\n                x: this.bscroll.x,\r\n                y: this.bscroll.y\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        if (this.options.interactive) {\r\n            this.eventHandler.destroy();\r\n        }\r\n        this.wrapper.parentNode.removeChild(this.wrapper);\r\n        this.hooksHandlers.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksHandlers.length = 0;\r\n    };\r\n    Indicator.prototype._listen = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksHandlers.push([hooks, name, handler]);\r\n    };\r\n    return Indicator;\r\n}());\n\nvar ScrollBar = /** @class */ (function () {\r\n    function ScrollBar(bscroll) {\r\n        this.indicators = [];\r\n        if (bscroll.options.scrollbar) {\r\n            this.indicators = this._initIndicators(bscroll);\r\n            bscroll.on('destroy', this.destroy, this);\r\n        }\r\n    }\r\n    ScrollBar.prototype._initIndicators = function (bscroll) {\r\n        var _this = this;\r\n        var _a = bscroll.options\r\n            .scrollbar, _b = _a.fade, fade = _b === void 0 ? true : _b, _c = _a.interactive, interactive = _c === void 0 ? false : _c;\r\n        var indicatorOption;\r\n        var scrolls = {\r\n            scrollX: \"horizontal\" /* Horizontal */,\r\n            scrollY: \"vertical\" /* Vertical */\r\n        };\r\n        var indicators = [];\r\n        Object.keys(scrolls).forEach(function (key) {\r\n            var direction = scrolls[key];\r\n            if (bscroll.options[key]) {\r\n                indicatorOption = {\r\n                    wrapper: _this._createIndicatorElement(direction),\r\n                    direction: direction,\r\n                    fade: fade,\r\n                    interactive: interactive\r\n                };\r\n                bscroll.wrapper.appendChild(indicatorOption.wrapper);\r\n                indicators.push(new Indicator(bscroll, indicatorOption));\r\n            }\r\n        });\r\n        return indicators;\r\n    };\r\n    ScrollBar.prototype._createIndicatorElement = function (direction) {\r\n        var scrollbarEl = document.createElement('div');\r\n        var indicatorEl = document.createElement('div');\r\n        scrollbarEl.style.cssText =\r\n            'position:absolute;z-index:9999;pointerEvents:none';\r\n        indicatorEl.style.cssText =\r\n            'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\r\n        indicatorEl.className = 'bscroll-indicator';\r\n        if (direction === 'horizontal') {\r\n            scrollbarEl.style.cssText += ';height:7px;left:2px;right:2px;bottom:0';\r\n            indicatorEl.style.height = '100%';\r\n            scrollbarEl.className = 'bscroll-horizontal-scrollbar';\r\n        }\r\n        else {\r\n            scrollbarEl.style.cssText += ';width:7px;bottom:2px;top:2px;right:1px';\r\n            indicatorEl.style.width = '100%';\r\n            scrollbarEl.className = 'bscroll-vertical-scrollbar';\r\n        }\r\n        scrollbarEl.style.cssText += ';overflow:hidden';\r\n        scrollbarEl.appendChild(indicatorEl);\r\n        return scrollbarEl;\r\n    };\r\n    ScrollBar.prototype.destroy = function () {\r\n        for (var _i = 0, _a = this.indicators; _i < _a.length; _i++) {\r\n            var indicator = _a[_i];\r\n            indicator.destroy();\r\n        }\r\n    };\r\n    ScrollBar.pluginName = 'scrollbar';\r\n    return ScrollBar;\r\n}());\n\nvar PagesPos = /** @class */ (function () {\r\n    function PagesPos(scroll, slideOpt) {\r\n        this.scroll = scroll;\r\n        this.slideOpt = slideOpt;\r\n        this.slideEl = null;\r\n        this.init();\r\n    }\r\n    PagesPos.prototype.init = function () {\r\n        var scrollerIns = this.scroll.scroller;\r\n        var scrollBehaviorX = scrollerIns.scrollBehaviorX;\r\n        var scrollBehaviorY = scrollerIns.scrollBehaviorY;\r\n        var wrapper = getRect(scrollerIns.wrapper);\r\n        var scroller = getRect(scrollerIns.content);\r\n        this.wrapperWidth = wrapper.width;\r\n        this.wrapperHeight = wrapper.height;\r\n        this.scrollerHeight = scrollBehaviorY.hasScroll\r\n            ? scroller.height\r\n            : wrapper.height;\r\n        this.scrollerWidth = scrollBehaviorX.hasScroll\r\n            ? scroller.width\r\n            : wrapper.width;\r\n        var stepX = this.slideOpt.stepX || this.wrapperWidth;\r\n        var stepY = this.slideOpt.stepY || this.wrapperHeight;\r\n        var slideEls = scrollerIns.content;\r\n        var el = this.slideOpt.el;\r\n        if (typeof el === 'string') {\r\n            this.slideEl = slideEls.querySelectorAll(el);\r\n        }\r\n        this.pages = this.slideEl\r\n            ? this.computePagePosInfoByEl(this.slideEl)\r\n            : this.computePagePosInfo(stepX, stepY);\r\n        this.xLen = this.pages ? this.pages.length : 0;\r\n        this.yLen = this.pages && this.pages[0] ? this.pages[0].length : 0;\r\n    };\r\n    PagesPos.prototype.hasInfo = function () {\r\n        if (!this.pages || !this.pages.length) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    PagesPos.prototype.getPos = function (x, y) {\r\n        return this.pages[x][y];\r\n    };\r\n    PagesPos.prototype.getNearestPage = function (x, y) {\r\n        if (!this.hasInfo()) {\r\n            return;\r\n        }\r\n        var pageX = 0;\r\n        var pageY = 0;\r\n        var l = this.pages.length;\r\n        for (; pageX < l - 1; pageX++) {\r\n            if (x >= this.pages[pageX][0].cx) {\r\n                break;\r\n            }\r\n        }\r\n        l = this.pages[pageX].length;\r\n        for (; pageY < l - 1; pageY++) {\r\n            if (y >= this.pages[0][pageY].cy) {\r\n                break;\r\n            }\r\n        }\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY\r\n        };\r\n    };\r\n    PagesPos.prototype.computePagePosInfo = function (stepX, stepY) {\r\n        var pages = [];\r\n        var x = 0;\r\n        var y;\r\n        var cx;\r\n        var cy;\r\n        var i = 0;\r\n        var l;\r\n        var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n        var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n        cx = Math.round(stepX / 2);\r\n        cy = Math.round(stepY / 2);\r\n        while (x > -this.scrollerWidth) {\r\n            pages[i] = [];\r\n            l = 0;\r\n            y = 0;\r\n            while (y > -this.scrollerHeight) {\r\n                pages[i][l] = {\r\n                    x: Math.max(x, maxScrollPosX),\r\n                    y: Math.max(y, maxScrollPosY),\r\n                    width: stepX,\r\n                    height: stepY,\r\n                    cx: x - cx,\r\n                    cy: y - cy\r\n                };\r\n                y -= stepY;\r\n                l++;\r\n            }\r\n            x -= stepX;\r\n            i++;\r\n        }\r\n        return pages;\r\n    };\r\n    PagesPos.prototype.computePagePosInfoByEl = function (el) {\r\n        var pages = [];\r\n        var x = 0;\r\n        var y = 0;\r\n        var cx;\r\n        var cy;\r\n        var i = 0;\r\n        var l = el.length;\r\n        var m = 0;\r\n        var n = -1;\r\n        var rect;\r\n        var maxScrollX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n        var maxScrollY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n        for (; i < l; i++) {\r\n            rect = getRect(el[i]);\r\n            if (i === 0 || rect.left <= getRect(el[i - 1]).left) {\r\n                m = 0;\r\n                n++;\r\n            }\r\n            if (!pages[m]) {\r\n                pages[m] = [];\r\n            }\r\n            x = Math.max(-rect.left, maxScrollX);\r\n            y = Math.max(-rect.top, maxScrollY);\r\n            cx = x - Math.round(rect.width / 2);\r\n            cy = y - Math.round(rect.height / 2);\r\n            pages[m][n] = {\r\n                x: x,\r\n                y: y,\r\n                width: rect.width,\r\n                height: rect.height,\r\n                cx: cx,\r\n                cy: cy\r\n            };\r\n            if (x > maxScrollX) {\r\n                m++;\r\n            }\r\n        }\r\n        return pages;\r\n    };\r\n    return PagesPos;\r\n}());\n\nvar PageInfo = /** @class */ (function () {\r\n    function PageInfo(scroll, slideOpt) {\r\n        this.scroll = scroll;\r\n        this.slideOpt = slideOpt;\r\n    }\r\n    PageInfo.prototype.init = function () {\r\n        this.currentPage = this.currentPage || {\r\n            x: 0,\r\n            y: 0,\r\n            pageX: 0,\r\n            pageY: 0\r\n        };\r\n        this.pagesPos = new PagesPos(this.scroll, this.slideOpt);\r\n        this.checkSlideLoop();\r\n    };\r\n    PageInfo.prototype.changeCurrentPage = function (newPage) {\r\n        this.currentPage = newPage;\r\n    };\r\n    PageInfo.prototype.change2safePage = function (pageX, pageY) {\r\n        if (!this.pagesPos.hasInfo()) {\r\n            return;\r\n        }\r\n        if (pageX >= this.pagesPos.xLen) {\r\n            pageX = this.pagesPos.xLen - 1;\r\n        }\r\n        else if (pageX < 0) {\r\n            pageX = 0;\r\n        }\r\n        if (pageY >= this.pagesPos.yLen) {\r\n            pageY = this.pagesPos.yLen - 1;\r\n        }\r\n        else if (pageY < 0) {\r\n            pageY = 0;\r\n        }\r\n        var _a = this.pagesPos.getPos(pageX, pageY), x = _a.x, y = _a.y;\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n            x: x,\r\n            y: y\r\n        };\r\n    };\r\n    PageInfo.prototype.getInitPage = function () {\r\n        var initPageX = this.loopX ? 1 : 0;\r\n        var initPageY = this.loopY ? 1 : 0;\r\n        return {\r\n            pageX: this.currentPage.pageX || initPageX,\r\n            pageY: this.currentPage.pageY || initPageY\r\n        };\r\n    };\r\n    PageInfo.prototype.getRealPage = function (page) {\r\n        var fixedPage = function (page, realPageLen) {\r\n            var pageIndex = [];\r\n            for (var i = 0; i < realPageLen; i++) {\r\n                pageIndex.push(i);\r\n            }\r\n            pageIndex.unshift(realPageLen - 1);\r\n            pageIndex.push(0);\r\n            return pageIndex[page];\r\n        };\r\n        var currentPage = page\r\n            ? extend({}, page)\r\n            : extend({}, this.currentPage);\r\n        if (this.loopX) {\r\n            currentPage.pageX = fixedPage(currentPage.pageX, this.pagesPos.xLen - 2);\r\n        }\r\n        if (this.loopY) {\r\n            currentPage.pageY = fixedPage(currentPage.pageY, this.pagesPos.yLen - 2);\r\n        }\r\n        return {\r\n            pageX: currentPage.pageX,\r\n            pageY: currentPage.pageY\r\n        };\r\n    };\r\n    PageInfo.prototype.getPageSize = function () {\r\n        return this.pagesPos.getPos(this.currentPage.pageX, this.currentPage.pageY);\r\n    };\r\n    PageInfo.prototype.realPage2Page = function (x, y) {\r\n        if (!this.pagesPos.hasInfo()) {\r\n            return;\r\n        }\r\n        var lastX = this.pagesPos.xLen - 1;\r\n        var lastY = this.pagesPos.yLen - 1;\r\n        var firstX = 0;\r\n        var firstY = 0;\r\n        if (this.loopX) {\r\n            x += 1;\r\n            firstX = firstX + 1;\r\n            lastX = lastX - 1;\r\n        }\r\n        if (this.loopY) {\r\n            y += 1;\r\n            firstY = firstY + 1;\r\n            lastY = lastY - 1;\r\n        }\r\n        x = fixInboundValue(x, firstX, lastX);\r\n        y = fixInboundValue(y, firstY, lastY);\r\n        return {\r\n            realX: x,\r\n            realY: y\r\n        };\r\n    };\r\n    PageInfo.prototype.nextPage = function () {\r\n        return this.changedPageNum(\"positive\" /* Positive */);\r\n    };\r\n    PageInfo.prototype.prevPage = function () {\r\n        return this.changedPageNum(\"negative\" /* Negative */);\r\n    };\r\n    PageInfo.prototype.nearestPage = function (x, y, directionX, directionY) {\r\n        var pageInfo = this.pagesPos.getNearestPage(x, y);\r\n        if (!pageInfo) {\r\n            return {\r\n                x: 0,\r\n                y: 0,\r\n                pageX: 0,\r\n                pageY: 0\r\n            };\r\n        }\r\n        var pageX = pageInfo.pageX;\r\n        var pageY = pageInfo.pageY;\r\n        var newX;\r\n        var newY;\r\n        if (pageX === this.currentPage.pageX) {\r\n            pageX += directionX;\r\n            pageX = fixInboundValue(pageX, 0, this.pagesPos.xLen - 1);\r\n        }\r\n        if (pageY === this.currentPage.pageY) {\r\n            pageY += directionY;\r\n            pageY = fixInboundValue(pageInfo.pageY, 0, this.pagesPos.yLen - 1);\r\n        }\r\n        newX = this.pagesPos.getPos(pageX, 0).x;\r\n        newY = this.pagesPos.getPos(0, pageY).y;\r\n        return {\r\n            x: newX,\r\n            y: newY,\r\n            pageX: pageX,\r\n            pageY: pageY\r\n        };\r\n    };\r\n    PageInfo.prototype.getLoopStage = function () {\r\n        if (!this.needLoop) {\r\n            return \"middle\" /* Middle */;\r\n        }\r\n        if (this.loopX) {\r\n            if (this.currentPage.pageX === 0) {\r\n                return \"head\" /* Head */;\r\n            }\r\n            if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\r\n                return \"tail\" /* Tail */;\r\n            }\r\n        }\r\n        if (this.loopY) {\r\n            if (this.currentPage.pageY === 0) {\r\n                return \"head\" /* Head */;\r\n            }\r\n            if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\r\n                return \"tail\" /* Tail */;\r\n            }\r\n        }\r\n        return \"middle\" /* Middle */;\r\n    };\r\n    PageInfo.prototype.resetLoopPage = function () {\r\n        if (this.loopX) {\r\n            if (this.currentPage.pageX === 0) {\r\n                return {\r\n                    pageX: this.pagesPos.xLen - 2,\r\n                    pageY: this.currentPage.pageY\r\n                };\r\n            }\r\n            if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\r\n                return {\r\n                    pageX: 1,\r\n                    pageY: this.currentPage.pageY\r\n                };\r\n            }\r\n        }\r\n        if (this.loopY) {\r\n            if (this.currentPage.pageY === 0) {\r\n                return {\r\n                    pageX: this.currentPage.pageX,\r\n                    pageY: this.pagesPos.yLen - 2\r\n                };\r\n            }\r\n            if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\r\n                return {\r\n                    pageX: this.currentPage.pageX,\r\n                    pageY: 1\r\n                };\r\n            }\r\n        }\r\n    };\r\n    PageInfo.prototype.isSameWithCurrent = function (page) {\r\n        if (page.pageX !== this.currentPage.pageX ||\r\n            page.pageY !== this.currentPage.pageY) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    PageInfo.prototype.changedPageNum = function (direction) {\r\n        var x = this.currentPage.pageX;\r\n        var y = this.currentPage.pageY;\r\n        if (this.slideX) {\r\n            x = direction === \"negative\" /* Negative */ ? x - 1 : x + 1;\r\n        }\r\n        if (this.slideY) {\r\n            y = direction === \"negative\" /* Negative */ ? y - 1 : y + 1;\r\n        }\r\n        return {\r\n            pageX: x,\r\n            pageY: y\r\n        };\r\n    };\r\n    PageInfo.prototype.checkSlideLoop = function () {\r\n        this.needLoop = this.slideOpt.loop;\r\n        if (this.pagesPos.xLen > 1) {\r\n            this.slideX = true;\r\n        }\r\n        if (this.pagesPos.pages[0] && this.pagesPos.yLen > 1) {\r\n            this.slideY = true;\r\n        }\r\n        this.loopX = this.needLoop && this.slideX;\r\n        this.loopY = this.needLoop && this.slideY;\r\n        if (this.slideX && this.slideY) {\r\n            warn('slide does not support two direction at the same time.');\r\n        }\r\n    };\r\n    return PageInfo;\r\n}());\n\nvar sourcePrefix$2 = 'plugins.slide';\r\nvar propertiesMap$2 = [\r\n    {\r\n        key: 'next',\r\n        name: 'next'\r\n    },\r\n    {\r\n        key: 'prev',\r\n        name: 'prev'\r\n    },\r\n    {\r\n        key: 'goToPage',\r\n        name: 'goToPage'\r\n    },\r\n    {\r\n        key: 'getCurrentPage',\r\n        name: 'getCurrentPage'\r\n    }\r\n];\r\nvar propertiesConfig$1 = propertiesMap$2.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$2 + \".\" + item.name\r\n    };\r\n});\n\nvar Slide = /** @class */ (function () {\r\n    function Slide(scroll) {\r\n        this.scroll = scroll;\r\n        this.resetLooping = false;\r\n        this.isTouching = false;\r\n        this.scroll.proxy(propertiesConfig$1);\r\n        this.scroll.registerType(['slideWillChange']);\r\n        this.slideOpt = this.scroll.options.slide;\r\n        this.page = new PageInfo(scroll, this.slideOpt);\r\n        this.hooksFn = [];\r\n        this.willChangeToPage = {\r\n            pageX: 0,\r\n            pageY: 0\r\n        };\r\n        this.init();\r\n    }\r\n    Slide.prototype.init = function () {\r\n        var _this = this;\r\n        var slide = this.slideOpt;\r\n        var slideEls = this.scroll.scroller.content;\r\n        var lazyInitByRefresh = false;\r\n        if (slide.loop) {\r\n            var children = slideEls.children;\r\n            if (children.length > 1) {\r\n                this.cloneSlideEleForLoop(slideEls);\r\n                lazyInitByRefresh = true;\r\n            }\r\n            else {\r\n                // Loop does not make any sense if there is only one child.\r\n                slide.loop = false;\r\n            }\r\n        }\r\n        var shouldRefreshByWidth = this.setSlideWidth(slideEls);\r\n        var shouldRefreshByHeight = this.setSlideHeight(this.scroll.scroller.wrapper, slideEls);\r\n        var shouldRefresh = shouldRefreshByWidth || shouldRefreshByHeight;\r\n        var scrollHooks = this.scroll.hooks;\r\n        var scrollerHooks = this.scroll.scroller.hooks;\r\n        this.registorHooks(scrollHooks, 'refresh', this.initSlideState);\r\n        this.registorHooks(scrollHooks, 'destroy', this.destroy);\r\n        this.registorHooks(scrollerHooks, 'momentum', this.modifyScrollMetaHandler);\r\n        // scrollEnd handler should be called before customized handlers\r\n        this.registorHooks(this.scroll, 'scrollEnd', this.amendCurrentPage);\r\n        this.registorHooks(scrollerHooks, 'beforeStart', this.setTouchFlag);\r\n        this.registorHooks(scrollerHooks, 'scroll', this.scrollMoving);\r\n        this.registorHooks(scrollerHooks, 'resize', this.resize);\r\n        // for mousewheel event\r\n        if (this.scroll.eventTypes.mousewheelMove &&\r\n            this.scroll.eventTypes.mousewheelEnd) {\r\n            this.registorHooks(this.scroll, 'mousewheelMove', function () {\r\n                // prevent default action of mousewheelMove\r\n                return true;\r\n            });\r\n            this.registorHooks(this.scroll, 'mousewheelEnd', function (delta) {\r\n                if (delta.directionX === 1 /* Positive */ ||\r\n                    delta.directionY === 1 /* Positive */) {\r\n                    _this.next();\r\n                }\r\n                if (delta.directionX === -1 /* Negative */ ||\r\n                    delta.directionY === -1 /* Negative */) {\r\n                    _this.prev();\r\n                }\r\n            });\r\n        }\r\n        if (slide.listenFlick !== false) {\r\n            this.registorHooks(scrollerHooks, 'flick', this.flickHandler);\r\n        }\r\n        if (!lazyInitByRefresh && !shouldRefresh) {\r\n            this.initSlideState();\r\n        }\r\n        else {\r\n            this.scroll.refresh();\r\n        }\r\n    };\r\n    Slide.prototype.resize = function () {\r\n        var _this = this;\r\n        var slideEls = this.scroll.scroller.content;\r\n        var slideWrapper = this.scroll.scroller.wrapper;\r\n        clearTimeout(this.resizeTimeout);\r\n        this.resizeTimeout = window.setTimeout(function () {\r\n            _this.clearSlideWidth(slideEls);\r\n            _this.clearSlideHeight(slideEls);\r\n            _this.setSlideWidth(slideEls);\r\n            _this.setSlideHeight(slideWrapper, slideEls);\r\n            _this.scroll.refresh();\r\n        }, this.scroll.options.resizePolling);\r\n        return true;\r\n    };\r\n    Slide.prototype.next = function (time, easing) {\r\n        var _a = this.page.nextPage(), pageX = _a.pageX, pageY = _a.pageY;\r\n        this.goTo(pageX, pageY, time, easing);\r\n    };\r\n    Slide.prototype.prev = function (time, easing) {\r\n        var _a = this.page.prevPage(), pageX = _a.pageX, pageY = _a.pageY;\r\n        this.goTo(pageX, pageY, time, easing);\r\n    };\r\n    Slide.prototype.goToPage = function (x, y, time, easing) {\r\n        var pageInfo = this.page.realPage2Page(x, y);\r\n        if (!pageInfo) {\r\n            return;\r\n        }\r\n        this.goTo(pageInfo.realX, pageInfo.realY, time, easing);\r\n    };\r\n    Slide.prototype.getCurrentPage = function () {\r\n        return this.page.getRealPage();\r\n    };\r\n    Slide.prototype.nearestPage = function (x, y) {\r\n        var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        var triggerThreshold = true;\r\n        if (Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX &&\r\n            Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY) {\r\n            triggerThreshold = false;\r\n        }\r\n        if (!triggerThreshold) {\r\n            return this.page.currentPage;\r\n        }\r\n        return this.page.nearestPage(fixInboundValue(x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos), fixInboundValue(y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos), scrollBehaviorX.direction, scrollBehaviorY.direction);\r\n    };\r\n    Slide.prototype.destroy = function () {\r\n        var slideEls = this.scroll.scroller.content;\r\n        if (this.slideOpt.loop) {\r\n            var children = slideEls.children;\r\n            if (children.length > 2) {\r\n                removeChild(slideEls, children[children.length - 1]);\r\n                removeChild(slideEls, children[0]);\r\n            }\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            if (hooks.eventTypes[hooksName]) {\r\n                hooks.off(hooksName, handlerFn);\r\n            }\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Slide.prototype.initSlideState = function () {\r\n        this.page.init();\r\n        this.initThreshold();\r\n        var initPage = this.page.getInitPage();\r\n        this.goTo(initPage.pageX, initPage.pageY, 0);\r\n    };\r\n    Slide.prototype.initThreshold = function () {\r\n        var slideThreshold = this.slideOpt.threshold || 0.1;\r\n        if (slideThreshold % 1 === 0) {\r\n            this.thresholdX = slideThreshold;\r\n            this.thresholdY = slideThreshold;\r\n        }\r\n        else {\r\n            var pageSize = this.page.getPageSize();\r\n            this.thresholdX = Math.round(pageSize.width * slideThreshold);\r\n            this.thresholdY = Math.round(pageSize.height * slideThreshold);\r\n        }\r\n    };\r\n    Slide.prototype.cloneSlideEleForLoop = function (slideEls) {\r\n        var children = slideEls.children;\r\n        prepend(children[children.length - 1].cloneNode(true), slideEls);\r\n        slideEls.appendChild(children[1].cloneNode(true));\r\n    };\r\n    Slide.prototype.amendCurrentPage = function () {\r\n        this.isTouching = false;\r\n        if (!this.slideOpt.loop) {\r\n            return;\r\n        }\r\n        // triggered by resetLoop\r\n        if (this.resetLooping) {\r\n            this.resetLooping = false;\r\n            return;\r\n        }\r\n        // fix bug: scroll two page or even more page at once and fetch the boundary.\r\n        // In this case, momentum won't be trigger, so the pageIndex will be wrong and won't be trigger reset.\r\n        var isScrollToBoundary = false;\r\n        if (this.page.loopX &&\r\n            (this.scroll.x === this.scroll.scroller.scrollBehaviorX.minScrollPos ||\r\n                this.scroll.x === this.scroll.scroller.scrollBehaviorX.maxScrollPos)) {\r\n            isScrollToBoundary = true;\r\n        }\r\n        if (this.page.loopY &&\r\n            (this.scroll.y === this.scroll.scroller.scrollBehaviorY.minScrollPos ||\r\n                this.scroll.y === this.scroll.scroller.scrollBehaviorY.maxScrollPos)) {\r\n            isScrollToBoundary = true;\r\n        }\r\n        if (isScrollToBoundary) {\r\n            var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n            var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n            var newPos = this.page.nearestPage(fixInboundValue(this.scroll.x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos), fixInboundValue(this.scroll.y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos), 0, 0);\r\n            var newPage = {\r\n                x: newPos.x,\r\n                y: newPos.y,\r\n                pageX: newPos.pageX,\r\n                pageY: newPos.pageY\r\n            };\r\n            if (!this.page.isSameWithCurrent(newPage)) {\r\n                this.page.changeCurrentPage(newPage);\r\n            }\r\n        }\r\n        var changePage = this.page.resetLoopPage();\r\n        if (changePage) {\r\n            this.resetLooping = true;\r\n            this.goTo(changePage.pageX, changePage.pageY, 0);\r\n            return true; // stop trigger chain\r\n        }\r\n        // amend willChangeToPage, because willChangeToPage maybe wrong when sliding quickly\r\n        this.pageWillChangeTo(this.page.currentPage);\r\n    };\r\n    Slide.prototype.shouldSetWidthHeight = function (checkType) {\r\n        var checkMap = {\r\n            width: ['scrollX', 'disableSetWidth'],\r\n            height: ['scrollY', 'disableSetHeight']\r\n        };\r\n        var checkOption = checkMap[checkType];\r\n        if (!this.scroll.options[checkOption[0]]) {\r\n            return false;\r\n        }\r\n        if (this.slideOpt[checkOption[1]]) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    Slide.prototype.clearSlideWidth = function (slideEls) {\r\n        if (!this.shouldSetWidthHeight('width')) {\r\n            return;\r\n        }\r\n        var children = slideEls.children;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var slideItemDom = children[i];\r\n            slideItemDom.removeAttribute('style');\r\n        }\r\n        slideEls.removeAttribute('style');\r\n    };\r\n    Slide.prototype.setSlideWidth = function (slideEls) {\r\n        if (!this.shouldSetWidthHeight('width')) {\r\n            return false;\r\n        }\r\n        var children = slideEls.children;\r\n        var slideItemWidth = children[0].clientWidth;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var slideItemDom = children[i];\r\n            slideItemDom.style.width = slideItemWidth + 'px';\r\n        }\r\n        slideEls.style.width = slideItemWidth * children.length + 'px';\r\n        return true;\r\n    };\r\n    Slide.prototype.clearSlideHeight = function (slideEls) {\r\n        if (!this.shouldSetWidthHeight('height')) {\r\n            return;\r\n        }\r\n        var children = slideEls.children;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var slideItemDom = children[i];\r\n            slideItemDom.removeAttribute('style');\r\n        }\r\n        slideEls.removeAttribute('style');\r\n    };\r\n    // height change will not effect minScrollY & maxScrollY\r\n    Slide.prototype.setSlideHeight = function (slideWrapper, slideEls) {\r\n        if (!this.shouldSetWidthHeight('height')) {\r\n            return false;\r\n        }\r\n        var wrapperHeight = slideWrapper.clientHeight;\r\n        var children = slideEls.children;\r\n        for (var i = 0; i < children.length; i++) {\r\n            var slideItemDom = children[i];\r\n            slideItemDom.style.height = wrapperHeight + 'px';\r\n        }\r\n        slideEls.style.height = wrapperHeight * children.length + 'px';\r\n        return true;\r\n    };\r\n    Slide.prototype.goTo = function (pageX, pageY, time, easing) {\r\n        if (pageY === void 0) { pageY = 0; }\r\n        var newPageInfo = this.page.change2safePage(pageX, pageY);\r\n        if (!newPageInfo) {\r\n            return;\r\n        }\r\n        var scrollEasing = easing || this.slideOpt.easing || ease.bounce;\r\n        var posX = newPageInfo.x;\r\n        var posY = newPageInfo.y;\r\n        var deltaX = posX - this.scroll.scroller.scrollBehaviorX.currentPos;\r\n        var deltaY = posY - this.scroll.scroller.scrollBehaviorY.currentPos;\r\n        if (!deltaX && !deltaY) {\r\n            return;\r\n        }\r\n        time = time === undefined ? this.getAnimateTime(deltaX, deltaY) : time;\r\n        this.page.changeCurrentPage({\r\n            x: posX,\r\n            y: posY,\r\n            pageX: newPageInfo.pageX,\r\n            pageY: newPageInfo.pageY\r\n        });\r\n        this.pageWillChangeTo(this.page.currentPage);\r\n        this.scroll.scroller.scrollTo(posX, posY, time, scrollEasing);\r\n    };\r\n    Slide.prototype.flickHandler = function () {\r\n        var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        var deltaX = scrollBehaviorX.currentPos - scrollBehaviorX.startPos;\r\n        var deltaY = scrollBehaviorY.currentPos - scrollBehaviorY.startPos;\r\n        var time = this.getAnimateTime(deltaX, deltaY);\r\n        this.goTo(this.page.currentPage.pageX + scrollBehaviorX.direction, this.page.currentPage.pageY + scrollBehaviorY.direction, time);\r\n    };\r\n    Slide.prototype.getAnimateTime = function (deltaX, deltaY) {\r\n        if (this.slideOpt.speed) {\r\n            return this.slideOpt.speed;\r\n        }\r\n        return Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300);\r\n    };\r\n    Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\r\n        var newPos = this.nearestPage(scrollMeta.newX, scrollMeta.newY);\r\n        scrollMeta.time = this.getAnimateTime(scrollMeta.newX - newPos.x, scrollMeta.newY - newPos.y);\r\n        scrollMeta.newX = newPos.x;\r\n        scrollMeta.newY = newPos.y;\r\n        scrollMeta.easing = this.slideOpt.easing || ease.bounce;\r\n        this.page.changeCurrentPage({\r\n            x: scrollMeta.newX,\r\n            y: scrollMeta.newY,\r\n            pageX: newPos.pageX,\r\n            pageY: newPos.pageY\r\n        });\r\n        this.pageWillChangeTo(this.page.currentPage);\r\n    };\r\n    Slide.prototype.scrollMoving = function (point) {\r\n        if (this.isTouching) {\r\n            var newPos = this.nearestPage(point.x, point.y);\r\n            this.pageWillChangeTo(newPos);\r\n        }\r\n    };\r\n    Slide.prototype.pageWillChangeTo = function (newPage) {\r\n        var changeToPage = this.page.getRealPage(newPage);\r\n        if (changeToPage.pageX === this.willChangeToPage.pageX &&\r\n            changeToPage.pageY === this.willChangeToPage.pageY) {\r\n            return;\r\n        }\r\n        this.willChangeToPage = changeToPage;\r\n        this.scroll.trigger('slideWillChange', this.willChangeToPage);\r\n    };\r\n    Slide.prototype.setTouchFlag = function () {\r\n        this.isTouching = true;\r\n    };\r\n    Slide.prototype.registorHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Slide.pluginName = 'slide';\r\n    return Slide;\r\n}());\n\nvar sourcePrefix$3 = 'plugins.wheel';\r\nvar propertiesMap$3 = [\r\n    {\r\n        key: 'wheelTo',\r\n        name: 'wheelTo'\r\n    },\r\n    {\r\n        key: 'getSelectedIndex',\r\n        name: 'getSelectedIndex'\r\n    }\r\n];\r\nvar propertiesConfig$2 = propertiesMap$3.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$3 + \".\" + item.name\r\n    };\r\n});\n\nvar CONSTANTS = {\r\n    rate: 4\r\n};\r\nvar Wheel = /** @class */ (function () {\r\n    function Wheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.options = this.scroll.options.wheel;\r\n        this.init();\r\n    }\r\n    Wheel.prototype.init = function () {\r\n        if (this.options) {\r\n            this.normalizeOptions();\r\n            this.refresh();\r\n            this.tapIntoHooks();\r\n            this.wheelTo(this.selectedIndex);\r\n            this.scroll.proxy(propertiesConfig$2);\r\n        }\r\n    };\r\n    Wheel.prototype.tapIntoHooks = function () {\r\n        var _this = this;\r\n        var scroller = this.scroll.scroller;\r\n        var actionsHandler = scroller.actionsHandler;\r\n        var scrollBehaviorY = scroller.scrollBehaviorY;\r\n        var animater = scroller.animater;\r\n        // BScroll\r\n        this.scroll.on(this.scroll.hooks.eventTypes.refresh, function () {\r\n            _this.refresh();\r\n        });\r\n        // Scroller\r\n        scroller.hooks.on(scroller.hooks.eventTypes.checkClick, function () {\r\n            var index = Array.from(_this.items).indexOf(_this.target);\r\n            if (index === -1)\r\n                return true;\r\n            _this.wheelTo(index, _this.options.adjustTime, ease.swipe);\r\n            return true;\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.scrollTo, function (endPoint) {\r\n            endPoint.y = _this.findNearestValidWheel(endPoint.y).y;\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.scrollToElement, function (el, pos) {\r\n            if (!hasClass(el, _this.options.wheelItemClass)) {\r\n                return true;\r\n            }\r\n            else {\r\n                pos.top = _this.findNearestValidWheel(pos.top).y;\r\n            }\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.ignoreDisMoveForSamePos, function () {\r\n            return true;\r\n        });\r\n        // ActionsHandler\r\n        actionsHandler.hooks.on(actionsHandler.hooks.eventTypes.beforeStart, function (e) {\r\n            _this.target = e.target;\r\n        });\r\n        // ScrollBehaviorY\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.momentum, function (momentumInfo, distance) {\r\n            momentumInfo.rate = CONSTANTS.rate;\r\n            momentumInfo.destination = _this.findNearestValidWheel(momentumInfo.destination).y;\r\n            var maxDistance = 1000;\r\n            var minDuration = 800;\r\n            if (distance < maxDistance) {\r\n                momentumInfo.duration = Math.max(minDuration, (distance / maxDistance) * _this.scroll.options.swipeTime);\r\n            }\r\n        });\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.end, function (momentumInfo) {\r\n            var validWheel = _this.findNearestValidWheel(scrollBehaviorY.currentPos);\r\n            momentumInfo.destination = validWheel.y;\r\n            momentumInfo.duration = _this.options.adjustTime;\r\n            _this.selectedIndex = validWheel.index;\r\n        });\r\n        // Animater\r\n        animater.hooks.on(animater.hooks.eventTypes.time, function (time) {\r\n            _this.transitionDuration(time);\r\n        });\r\n        animater.hooks.on(animater.hooks.eventTypes.timeFunction, function (easing) {\r\n            _this.timeFunction(easing);\r\n        });\r\n        animater.hooks.on(animater.hooks.eventTypes.beforeForceStop, function (_a) {\r\n            var y = _a.y;\r\n            _this.target = _this.items[_this.findNearestValidWheel(y).index];\r\n            // don't dispatch scrollEnd when it is a click operation\r\n            return true;\r\n        });\r\n        // Translater\r\n        animater.translater.hooks.on(animater.translater.hooks.eventTypes.translate, function (endPoint) {\r\n            _this.rotateX(endPoint.y);\r\n            _this.selectedIndex = _this.findNearestValidWheel(endPoint.y).index;\r\n        });\r\n    };\r\n    Wheel.prototype.refresh = function () {\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorY = scroller.scrollBehaviorY;\r\n        // adjust contentSize\r\n        var contentRect = getRect(scroller.content);\r\n        scrollBehaviorY.contentSize = contentRect.height;\r\n        this.items = scroller.content.children;\r\n        this.checkWheelAllDisabled();\r\n        this.itemHeight = this.items.length\r\n            ? scrollBehaviorY.contentSize / this.items.length\r\n            : 0;\r\n        if (this.selectedIndex === undefined) {\r\n            this.selectedIndex = this.options.selectedIndex || 0;\r\n        }\r\n        this.scroll.maxScrollX = 0;\r\n        this.scroll.maxScrollY = -this.itemHeight * (this.items.length - 1);\r\n        this.scroll.minScrollX = 0;\r\n        this.scroll.minScrollY = 0;\r\n        scrollBehaviorY.hasScroll =\r\n            scrollBehaviorY.options && this.scroll.maxScrollY < this.scroll.minScrollY;\r\n    };\r\n    Wheel.prototype.getSelectedIndex = function () {\r\n        return this.selectedIndex;\r\n    };\r\n    Wheel.prototype.wheelTo = function (index, time, ease, isSlient) {\r\n        if (index === void 0) { index = 0; }\r\n        if (time === void 0) { time = 0; }\r\n        var y = -index * this.itemHeight;\r\n        this.scroll.scrollTo(0, y, time, ease, isSlient);\r\n    };\r\n    Wheel.prototype.transitionDuration = function (time) {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this.items[i].style[style.transitionDuration] =\r\n                time + 'ms';\r\n        }\r\n    };\r\n    Wheel.prototype.timeFunction = function (easing) {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this.items[i].style[style.transitionTimingFunction] = easing;\r\n        }\r\n    };\r\n    Wheel.prototype.rotateX = function (y) {\r\n        var _a = this.options.rotate, rotate = _a === void 0 ? 25 : _a;\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            var deg = rotate * (y / this.itemHeight + i);\r\n            this.items[i].style[style.transform] = \"rotateX(\" + deg + \"deg)\";\r\n        }\r\n    };\r\n    Wheel.prototype.findNearestValidWheel = function (y) {\r\n        y = y > 0 ? 0 : y < this.scroll.maxScrollY ? this.scroll.maxScrollY : y;\r\n        var currentIndex = Math.abs(Math.round(-y / this.itemHeight));\r\n        var cacheIndex = currentIndex;\r\n        var items = this.items;\r\n        var wheelDisabledItemClassName = this.options\r\n            .wheelDisabledItemClass;\r\n        // Impersonation web native select\r\n        // first, check whether there is a enable item whose index is smaller than currentIndex\r\n        // then, check whether there is a enable item whose index is bigger than currentIndex\r\n        // otherwise, there are all disabled items, just keep currentIndex unchange\r\n        while (currentIndex >= 0) {\r\n            if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\r\n                break;\r\n            }\r\n            currentIndex--;\r\n        }\r\n        if (currentIndex < 0) {\r\n            currentIndex = cacheIndex;\r\n            while (currentIndex <= items.length - 1) {\r\n                if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\r\n                    break;\r\n                }\r\n                currentIndex++;\r\n            }\r\n        }\r\n        // keep it unchange when all the items are disabled\r\n        if (currentIndex === items.length) {\r\n            currentIndex = cacheIndex;\r\n        }\r\n        // when all the items are disabled, this.selectedIndex should always be -1\r\n        return {\r\n            index: this.wheelItemsAllDisabled ? -1 : currentIndex,\r\n            y: -currentIndex * this.itemHeight\r\n        };\r\n    };\r\n    Wheel.prototype.normalizeOptions = function () {\r\n        var options = (this.options = isPlainObject(this.options)\r\n            ? this.options\r\n            : {});\r\n        if (!options.wheelWrapperClass) {\r\n            options.wheelWrapperClass = 'wheel-scroll';\r\n        }\r\n        if (!options.wheelItemClass) {\r\n            options.wheelItemClass = 'wheel-item';\r\n        }\r\n        if (!options.rotate) {\r\n            options.rotate = 25;\r\n        }\r\n        if (!options.adjustTime) {\r\n            options.adjustTime = 400;\r\n        }\r\n        if (!options.wheelDisabledItemClass) {\r\n            options.wheelDisabledItemClass = 'wheel-disabled-item';\r\n        }\r\n    };\r\n    Wheel.prototype.checkWheelAllDisabled = function () {\r\n        var wheelDisabledItemClassName = this.options\r\n            .wheelDisabledItemClass;\r\n        var items = this.items;\r\n        this.wheelItemsAllDisabled = true;\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (!hasClass(items[i], wheelDisabledItemClassName)) {\r\n                this.wheelItemsAllDisabled = false;\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    Wheel.pluginName = 'wheel';\r\n    return Wheel;\r\n}());\n\nvar sourcePrefix$4 = 'plugins.zoom';\r\nvar propertiesMap$4 = [\r\n    {\r\n        key: 'zoomTo',\r\n        name: 'zoomTo'\r\n    }\r\n];\r\nvar propertiesConfig$3 = propertiesMap$4.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$4 + \".\" + item.name\r\n    };\r\n});\n\nvar Zoom = /** @class */ (function () {\r\n    function Zoom(scroll) {\r\n        this.scroll = scroll;\r\n        this.scale = 1;\r\n        this.scroll.proxy(propertiesConfig$3);\r\n        this.scroll.registerType(['zoomStart', 'zoomEnd']);\r\n        this.zoomOpt = this.scroll.options.zoom;\r\n        this.lastTransformScale = this.scale;\r\n        this.hooksFn = [];\r\n        this.init();\r\n    }\r\n    Zoom.prototype.init = function () {\r\n        var _this = this;\r\n        var scrollerIns = this.scroll.scroller;\r\n        this.wrapper = this.scroll.scroller.wrapper;\r\n        this.scaleElement = this.scroll.scroller.content;\r\n        this.scaleElement.style[style.transformOrigin] = '0 0';\r\n        this.scaleElementInitSize = getRect(this.scaleElement);\r\n        var scrollBehaviorX = scrollerIns.scrollBehaviorX;\r\n        var scrollBehaviorY = scrollerIns.scrollBehaviorY;\r\n        this.initScrollBoundary = {\r\n            x: [scrollBehaviorX.minScrollPos, scrollBehaviorX.maxScrollPos],\r\n            y: [scrollBehaviorY.minScrollPos, scrollBehaviorY.maxScrollPos]\r\n        };\r\n        this.registorHooks(scrollerIns.actions.hooks, 'start', function (e) {\r\n            if (e.touches && e.touches.length > 1) {\r\n                _this.zoomStart(e);\r\n            }\r\n        });\r\n        this.registorHooks(scrollerIns.actions.hooks, 'beforeMove', function (e) {\r\n            if (!e.touches || e.touches.length < 2) {\r\n                return false;\r\n            }\r\n            _this.zoom(e);\r\n            return true;\r\n        });\r\n        this.registorHooks(scrollerIns.actions.hooks, 'beforeEnd', function (e) {\r\n            if (!_this.zooming) {\r\n                return false;\r\n            }\r\n            _this.zoomEnd();\r\n            return true;\r\n        });\r\n        this.registorHooks(scrollerIns.translater.hooks, 'beforeTranslate', function (transformStyle, point) {\r\n            var scale = point.scale ? point.scale : _this.lastTransformScale;\r\n            _this.lastTransformScale = scale;\r\n            transformStyle.push(\"scale(\" + scale + \")\");\r\n        });\r\n        this.registorHooks(scrollerIns.hooks, 'ignoreDisMoveForSamePos', function () {\r\n            return true;\r\n        });\r\n        this.registorHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    Zoom.prototype.zoomTo = function (scale, x, y) {\r\n        var _a = offsetToBody(this.wrapper), left = _a.left, top = _a.top;\r\n        var originX = x + left - this.scroll.x;\r\n        var originY = y + top - this.scroll.y;\r\n        this.zooming = true;\r\n        this._zoomTo(scale, { x: originX, y: originY }, this.scale);\r\n        this.zooming = false;\r\n    };\r\n    Zoom.prototype.zoomStart = function (e) {\r\n        this.zooming = true;\r\n        var firstFinger = e.touches[0];\r\n        var secondFinger = e.touches[1];\r\n        this.startDistance = this.getFingerDistance(e);\r\n        this.startScale = this.scale;\r\n        var _a = offsetToBody(this.wrapper), left = _a.left, top = _a.top;\r\n        this.origin = {\r\n            x: Math.abs(firstFinger.pageX + secondFinger.pageX) / 2 +\r\n                left -\r\n                this.scroll.x,\r\n            y: Math.abs(firstFinger.pageY + secondFinger.pageY) / 2 +\r\n                top -\r\n                this.scroll.y\r\n        };\r\n        this.scroll.trigger(this.scroll.eventTypes.zoomStart);\r\n    };\r\n    Zoom.prototype.zoom = function (e) {\r\n        var scrollerIns = this.scroll.scroller;\r\n        var currentDistance = this.getFingerDistance(e);\r\n        var currentScale = (currentDistance / this.startDistance) * this.startScale;\r\n        this.scale = this.scaleCure(currentScale);\r\n        var lastScale = this.scale / this.startScale;\r\n        var scrollBehaviorX = scrollerIns.scrollBehaviorX;\r\n        var scrollBehaviorY = scrollerIns.scrollBehaviorY;\r\n        var x = this.getNewPos(this.origin.x, lastScale, scrollBehaviorX);\r\n        var y = this.getNewPos(this.origin.y, lastScale, scrollBehaviorY);\r\n        this.resetBoundaries(this.scale, scrollBehaviorX, 'x', x);\r\n        this.resetBoundaries(this.scale, scrollBehaviorY, 'y', y);\r\n        scrollerIns.scrollTo(x, y, 0, undefined, {\r\n            start: {\r\n                scale: this.lastTransformScale\r\n            },\r\n            end: {\r\n                scale: this.scale\r\n            }\r\n        });\r\n    };\r\n    Zoom.prototype.getFingerDistance = function (e) {\r\n        var firstFinger = e.touches[0];\r\n        var secondFinger = e.touches[1];\r\n        var deltaX = Math.abs(firstFinger.pageX - secondFinger.pageX);\r\n        var deltaY = Math.abs(firstFinger.pageY - secondFinger.pageY);\r\n        return getDistance(deltaX, deltaY);\r\n    };\r\n    Zoom.prototype.zoomEnd = function () {\r\n        this._zoomTo(this.scale, this.origin, this.startScale || this.scale);\r\n        this.zooming = false;\r\n        this.scroll.trigger(this.scroll.eventTypes.zoomEnd);\r\n    };\r\n    Zoom.prototype.destroy = function () {\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Zoom.prototype._zoomTo = function (scale, origin, startScale) {\r\n        this.scale = this.fixInScaleLimit(scale);\r\n        var lastScale = this.scale / startScale;\r\n        var scrollerIns = this.scroll.scroller;\r\n        var scrollBehaviorX = scrollerIns.scrollBehaviorX;\r\n        var scrollBehaviorY = scrollerIns.scrollBehaviorY;\r\n        this.resetBoundaries(this.scale, scrollBehaviorX, 'x');\r\n        this.resetBoundaries(this.scale, scrollBehaviorY, 'y');\r\n        // resetPosition\r\n        var newX = this.getNewPos(origin.x, lastScale, scrollBehaviorX, true);\r\n        var newY = this.getNewPos(origin.y, lastScale, scrollBehaviorY, true);\r\n        if (scrollBehaviorX.currentPos !== Math.round(newX) ||\r\n            scrollBehaviorY.currentPos !== Math.round(newY) ||\r\n            this.scale !== this.lastTransformScale) {\r\n            scrollerIns.scrollTo(newX, newY, this.scroll.options.bounceTime, undefined, {\r\n                start: {\r\n                    scale: this.lastTransformScale\r\n                },\r\n                end: {\r\n                    scale: this.scale\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Zoom.prototype.resetBoundaries = function (scale, scrollBehavior, direction, extendValue) {\r\n        var min = this.initScrollBoundary[direction][0];\r\n        var max = this.initScrollBoundary[direction][1];\r\n        var hasScroll = false;\r\n        if (scale > 1) {\r\n            var sideName = direction === 'x' ? 'width' : 'height';\r\n            max =\r\n                -this.scaleElementInitSize[sideName] * (scale - 1) -\r\n                    this.initScrollBoundary[direction][1];\r\n            hasScroll = true;\r\n        }\r\n        if (!isUndef(extendValue)) {\r\n            max = Math.min(extendValue, max);\r\n            min = Math.max(extendValue, min); // max & min & curValue is negative value\r\n            hasScroll = !!(min || max);\r\n        }\r\n        scrollBehavior.minScrollPos = Math.floor(min);\r\n        scrollBehavior.maxScrollPos = Math.floor(max);\r\n        scrollBehavior.hasScroll = hasScroll;\r\n    };\r\n    Zoom.prototype.getNewPos = function (origin, lastScale, scrollBehavior, fixInBound) {\r\n        var newPos = origin - origin * lastScale + scrollBehavior.startPos;\r\n        if (fixInBound) {\r\n            newPos = fixInboundValue(newPos, scrollBehavior.maxScrollPos, 0);\r\n        }\r\n        return Math.floor(newPos);\r\n    };\r\n    Zoom.prototype.scaleCure = function (scale) {\r\n        var _a = this.zoomOpt, _b = _a.min, min = _b === void 0 ? 1 : _b, _c = _a.max, max = _c === void 0 ? 4 : _c;\r\n        if (scale < min) {\r\n            scale = 0.5 * min * Math.pow(2.0, scale / min);\r\n        }\r\n        else if (scale > max) {\r\n            scale = 2.0 * max * Math.pow(0.5, max / scale);\r\n        }\r\n        return scale;\r\n    };\r\n    Zoom.prototype.fixInScaleLimit = function (scale) {\r\n        var _a = this.zoomOpt, _b = _a.min, min = _b === void 0 ? 1 : _b, _c = _a.max, max = _c === void 0 ? 4 : _c;\r\n        if (scale > max) {\r\n            scale = max;\r\n        }\r\n        else if (scale < min) {\r\n            scale = min;\r\n        }\r\n        return scale;\r\n    };\r\n    Zoom.prototype.registorHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Zoom.pluginName = 'zoom';\r\n    return Zoom;\r\n}());\n\nvar compatibleFeatures = {\r\n    duplicateClick: function (_a) {\r\n        var parentScroll = _a[0], childScroll = _a[1];\r\n        // no need to make childScroll's click true\r\n        if (parentScroll.options.click && childScroll.options.click) {\r\n            childScroll.options.click = false;\r\n        }\r\n    },\r\n    nestedScroll: function (scrollsPair) {\r\n        var parentScroll = scrollsPair[0], childScroll = scrollsPair[1];\r\n        var parentScrollX = parentScroll.options.scrollX;\r\n        var parentScrollY = parentScroll.options.scrollY;\r\n        var childScrollX = childScroll.options.scrollX;\r\n        var childScrollY = childScroll.options.scrollY;\r\n        // vertical nested in vertical scroll and horizontal nested in horizontal\r\n        // otherwise, no need to handle.\r\n        if (parentScrollX === childScrollX || parentScrollY === childScrollY) {\r\n            scrollsPair.forEach(function (scroll, index) {\r\n                var oppositeScroll = scrollsPair[(index + 1) % 2];\r\n                scroll.on('beforeScrollStart', function () {\r\n                    if (oppositeScroll.pending) {\r\n                        oppositeScroll.stop();\r\n                        oppositeScroll.resetPosition();\r\n                    }\r\n                    setupData(oppositeScroll);\r\n                    oppositeScroll.disable();\r\n                });\r\n                scroll.on('touchEnd', function () {\r\n                    oppositeScroll.enable();\r\n                });\r\n            });\r\n            childScroll.on('scrollStart', function () {\r\n                if (checkBeyondBoundary(childScroll)) {\r\n                    childScroll.disable();\r\n                    parentScroll.enable();\r\n                }\r\n            });\r\n        }\r\n    }\r\n};\r\nvar NestedScroll = /** @class */ (function () {\r\n    function NestedScroll(scroll) {\r\n        var singleton = NestedScroll.nestedScroll;\r\n        if (!(singleton instanceof NestedScroll)) {\r\n            singleton = NestedScroll.nestedScroll = this;\r\n            singleton.stores = [];\r\n        }\r\n        singleton.setup(scroll);\r\n        singleton.addHooks(scroll);\r\n        return singleton;\r\n    }\r\n    NestedScroll.prototype.setup = function (scroll) {\r\n        this.appendBScroll(scroll);\r\n        this.handleContainRelationship();\r\n        this.handleCompatible();\r\n    };\r\n    NestedScroll.prototype.addHooks = function (scroll) {\r\n        var _this = this;\r\n        scroll.on('destroy', function () {\r\n            _this.teardown(scroll);\r\n        });\r\n    };\r\n    NestedScroll.prototype.teardown = function (scroll) {\r\n        this.removeBScroll(scroll);\r\n        this.handleContainRelationship();\r\n        this.handleCompatible();\r\n    };\r\n    NestedScroll.prototype.appendBScroll = function (scroll) {\r\n        this.stores.push(scroll);\r\n    };\r\n    NestedScroll.prototype.removeBScroll = function (scroll) {\r\n        var index = this.stores.indexOf(scroll);\r\n        if (index === -1)\r\n            return;\r\n        scroll.wrapper.isBScrollContainer = undefined;\r\n        this.stores.splice(index, 1);\r\n    };\r\n    NestedScroll.prototype.handleContainRelationship = function () {\r\n        // bs's length <= 1\r\n        var stores = this.stores;\r\n        if (stores.length <= 1) {\r\n            // there is only a childBScroll left.\r\n            if (stores[0] && stores[0].__parentInfo) {\r\n                stores[0].__parentInfo = undefined;\r\n            }\r\n            return;\r\n        }\r\n        var outerBS;\r\n        var outerBSWrapper;\r\n        var innerBS;\r\n        var innerBSWrapper;\r\n        // Need two layers of \"For loop\" to calculate parent-child relationship\r\n        for (var i = 0; i < stores.length; i++) {\r\n            outerBS = stores[i];\r\n            outerBSWrapper = outerBS.wrapper;\r\n            for (var j = 0; j < stores.length; j++) {\r\n                innerBS = stores[j];\r\n                innerBSWrapper = innerBS.wrapper;\r\n                // same bs\r\n                if (outerBS === innerBS)\r\n                    continue;\r\n                // now start calculating\r\n                if (!innerBSWrapper.contains(outerBSWrapper))\r\n                    continue;\r\n                // now innerBS contains outerBS\r\n                // no parentInfo yet\r\n                if (!outerBS.__parentInfo) {\r\n                    outerBS.__parentInfo = {\r\n                        parent: innerBS,\r\n                        depth: calculateDepths(outerBSWrapper, innerBSWrapper)\r\n                    };\r\n                }\r\n                else {\r\n                    // has parentInfo already!\r\n                    // just judge the \"true\" parent by depth\r\n                    // we regard the latest node as parent, not the furthest\r\n                    var currentDepths = calculateDepths(outerBSWrapper, innerBSWrapper);\r\n                    var prevDepths = outerBS.__parentInfo.depth;\r\n                    // refresh currentBS as parentScroll\r\n                    if (prevDepths > currentDepths) {\r\n                        outerBS.__parentInfo = {\r\n                            parent: innerBS,\r\n                            depth: currentDepths\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    NestedScroll.prototype.handleCompatible = function () {\r\n        var pairs = this.availableBScrolls();\r\n        var keys = ['duplicateClick', 'nestedScroll'];\r\n        pairs.forEach(function (pair) {\r\n            keys.forEach(function (key) {\r\n                compatibleFeatures[key](pair);\r\n            });\r\n        });\r\n    };\r\n    NestedScroll.prototype.availableBScrolls = function () {\r\n        var ret = [];\r\n        ret = this.stores\r\n            .filter(function (bs) { return !!bs.__parentInfo; })\r\n            .map(function (bs) { return [bs.__parentInfo.parent, bs]; });\r\n        return ret;\r\n    };\r\n    NestedScroll.pluginName = 'nestedScroll';\r\n    return NestedScroll;\r\n}());\r\nfunction calculateDepths(childNode, parentNode) {\r\n    var depth = 0;\r\n    var parent = childNode.parentNode;\r\n    while (parent && parent !== parentNode) {\r\n        depth++;\r\n        parent = parent.parentNode;\r\n    }\r\n    return depth;\r\n}\r\nfunction checkBeyondBoundary(scroll) {\r\n    var _a = hasScroll(scroll), hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll;\r\n    var _b = scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n    var hasReachLeft = scroll.x >= scroll.minScrollX && scrollBehaviorX.movingDirection === -1;\r\n    var hasReachRight = scroll.x <= scroll.maxScrollX && scrollBehaviorX.movingDirection === 1;\r\n    var hasReachTop = scroll.y >= scroll.minScrollY && scrollBehaviorY.movingDirection === -1;\r\n    var hasReachBottom = scroll.y <= scroll.maxScrollY && scrollBehaviorY.movingDirection === 1;\r\n    if (hasVerticalScroll) {\r\n        return hasReachTop || hasReachBottom;\r\n    }\r\n    else if (hasHorizontalScroll) {\r\n        return hasReachLeft || hasReachRight;\r\n    }\r\n    return false;\r\n}\r\nfunction setupData(scroll) {\r\n    var _a = hasScroll(scroll), hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll;\r\n    var _b = scroll.scroller, actions = _b.actions, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n    actions.startTime = +new Date();\r\n    if (hasVerticalScroll) {\r\n        scrollBehaviorY.startPos = scrollBehaviorY.currentPos;\r\n    }\r\n    else if (hasHorizontalScroll) {\r\n        scrollBehaviorX.startPos = scrollBehaviorX.currentPos;\r\n    }\r\n}\r\nfunction hasScroll(scroll) {\r\n    return {\r\n        hasHorizontalScroll: scroll.scroller.scrollBehaviorX.hasScroll,\r\n        hasVerticalScroll: scroll.scroller.scrollBehaviorY.hasScroll\r\n    };\r\n}\n\nvar PRE_NUM = 10;\r\nvar POST_NUM = 30;\r\nvar IndexCalculator = /** @class */ (function () {\r\n    function IndexCalculator(wrapperHeight, tombstoneHeight) {\r\n        this.wrapperHeight = wrapperHeight;\r\n        this.tombstoneHeight = tombstoneHeight;\r\n        this.lastDirection = 1 /* DOWN */;\r\n        this.lastPos = 0;\r\n    }\r\n    IndexCalculator.prototype.calculate = function (pos, list) {\r\n        var offset = pos - this.lastPos;\r\n        this.lastPos = pos;\r\n        var direction = this.getDirection(offset);\r\n        // important! start index is much more important than end index.\r\n        var start = this.calculateIndex(0, pos, list);\r\n        var end = this.calculateIndex(start, pos + this.wrapperHeight, list);\r\n        if (direction === 1 /* DOWN */) {\r\n            start -= PRE_NUM;\r\n            end += POST_NUM;\r\n        }\r\n        else {\r\n            start -= POST_NUM;\r\n            end += PRE_NUM;\r\n        }\r\n        if (start < 0) {\r\n            start = 0;\r\n        }\r\n        return {\r\n            start: start,\r\n            end: end\r\n        };\r\n    };\r\n    IndexCalculator.prototype.getDirection = function (offset) {\r\n        var direction;\r\n        if (offset > 0) {\r\n            direction = 1 /* DOWN */;\r\n        }\r\n        else if (offset < 0) {\r\n            direction = 0 /* UP */;\r\n        }\r\n        else {\r\n            return this.lastDirection;\r\n        }\r\n        this.lastDirection = direction;\r\n        return direction;\r\n    };\r\n    IndexCalculator.prototype.calculateIndex = function (start, offset, list) {\r\n        if (offset <= 0) {\r\n            return start;\r\n        }\r\n        var i = start;\r\n        var startPos = list[i] && list[i].pos !== -1 ? list[i].pos : 0;\r\n        var lastPos = startPos;\r\n        var tombstone = 0;\r\n        while (i < list.length && list[i].pos < offset) {\r\n            lastPos = list[i].pos;\r\n            i++;\r\n        }\r\n        if (i === list.length) {\r\n            tombstone = Math.floor((offset - lastPos) / this.tombstoneHeight);\r\n        }\r\n        i += tombstone;\r\n        return i;\r\n    };\r\n    return IndexCalculator;\r\n}());\n\nvar ListItem = /** @class */ (function () {\r\n    function ListItem() {\r\n        this.data = null;\r\n        this.dom = null;\r\n        this.tombstone = null;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.pos = 0;\r\n    }\r\n    return ListItem;\r\n}());\r\nvar DataManager = /** @class */ (function () {\r\n    function DataManager(list, fetchFn, onFetchFinish) {\r\n        this.fetchFn = fetchFn;\r\n        this.onFetchFinish = onFetchFinish;\r\n        this.loadedNum = 0;\r\n        this.fetching = false;\r\n        this.hasMore = true;\r\n        this.list = list || [];\r\n    }\r\n    DataManager.prototype.update = function (end) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var len;\r\n            return __generator(this, function (_a) {\r\n                if (!this.hasMore) {\r\n                    end = Math.min(end, this.list.length);\r\n                }\r\n                // add data placeholder\r\n                if (end > this.list.length) {\r\n                    len = end - this.list.length;\r\n                    this.addEmptyData(len);\r\n                }\r\n                // tslint:disable-next-line: no-floating-promises\r\n                return [2 /*return*/, this.checkToFetch(end)];\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.add = function (data) {\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (!this.list[this.loadedNum]) {\r\n                this.list[this.loadedNum] = { data: data[i] };\r\n            }\r\n            else {\r\n                this.list[this.loadedNum] = __assign({}, this.list[this.loadedNum], { data: data[i] });\r\n            }\r\n            this.loadedNum++;\r\n        }\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.addEmptyData = function (len) {\r\n        for (var i = 0; i < len; i++) {\r\n            this.list.push(new ListItem());\r\n        }\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.fetch = function (len) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (this.fetching) {\r\n                            return [2 /*return*/, []];\r\n                        }\r\n                        this.fetching = true;\r\n                        return [4 /*yield*/, this.fetchFn(len)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        this.fetching = false;\r\n                        return [2 /*return*/, data];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.checkToFetch = function (end) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var min, newData, currentEnd;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.hasMore) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        if (end <= this.loadedNum) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        min = end - this.loadedNum;\r\n                        return [4 /*yield*/, this.fetch(min)];\r\n                    case 1:\r\n                        newData = _a.sent();\r\n                        if (newData instanceof Array && newData.length) {\r\n                            this.add(newData);\r\n                            currentEnd = this.onFetchFinish(this.list, true);\r\n                            return [2 /*return*/, this.checkToFetch(currentEnd)];\r\n                        }\r\n                        else if (typeof newData === 'boolean' && newData === false) {\r\n                            this.hasMore = false;\r\n                            this.list.splice(this.loadedNum);\r\n                            this.onFetchFinish(this.list, false);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.getList = function () {\r\n        return this.list;\r\n    };\r\n    return DataManager;\r\n}());\n\nvar Tombstone = /** @class */ (function () {\r\n    function Tombstone(create) {\r\n        this.create = create;\r\n        this.cached = [];\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.initialed = false;\r\n        this.getSize();\r\n    }\r\n    Tombstone.isTombstone = function (el) {\r\n        if (el && el.classList) {\r\n            return el.classList.contains('tombstone');\r\n        }\r\n        return false;\r\n    };\r\n    Tombstone.prototype.getSize = function () {\r\n        if (!this.initialed) {\r\n            var tombstone = this.create();\r\n            tombstone.style.position = 'absolute';\r\n            document.body.appendChild(tombstone);\r\n            tombstone.style.display = '';\r\n            this.height = tombstone.offsetHeight;\r\n            this.width = tombstone.offsetWidth;\r\n            document.body.removeChild(tombstone);\r\n            this.cached.push(tombstone);\r\n        }\r\n    };\r\n    Tombstone.prototype.getOne = function () {\r\n        var tombstone = this.cached.pop();\r\n        if (tombstone) {\r\n            var tombstoneStyle = tombstone.style;\r\n            tombstoneStyle.display = '';\r\n            tombstoneStyle.opacity = '1';\r\n            tombstoneStyle[style.transform] = '';\r\n            tombstoneStyle[style.transition] = '';\r\n            return tombstone;\r\n        }\r\n        return this.create();\r\n    };\r\n    Tombstone.prototype.recycle = function (tombstones) {\r\n        for (var _i = 0, tombstones_1 = tombstones; _i < tombstones_1.length; _i++) {\r\n            var tombstone = tombstones_1[_i];\r\n            tombstone.style.display = 'none';\r\n            this.cached.push(tombstone);\r\n        }\r\n        return this.cached;\r\n    };\r\n    Tombstone.prototype.recycleOne = function (tombstone) {\r\n        this.cached.push(tombstone);\r\n        return this.cached;\r\n    };\r\n    return Tombstone;\r\n}());\n\nvar ANIMATION_DURATION_MS = 200;\r\nvar DomManager = /** @class */ (function () {\r\n    function DomManager(content, renderFn, tombstone) {\r\n        this.content = content;\r\n        this.renderFn = renderFn;\r\n        this.tombstone = tombstone;\r\n        this.unusedDom = [];\r\n        this.timers = [];\r\n    }\r\n    DomManager.prototype.update = function (list, start, end) {\r\n        if (start >= list.length) {\r\n            start = list.length - 1;\r\n        }\r\n        if (end > list.length) {\r\n            end = list.length;\r\n        }\r\n        this.collectUnusedDom(list, start, end);\r\n        this.createDom(list, start, end);\r\n        this.cacheHeight(list, start, end);\r\n        var _a = this.positionDom(list, start, end), startPos = _a.startPos, startDelta = _a.startDelta, endPos = _a.endPos;\r\n        return {\r\n            start: start,\r\n            startPos: startPos,\r\n            startDelta: startDelta,\r\n            end: end,\r\n            endPos: endPos\r\n        };\r\n    };\r\n    DomManager.prototype.collectUnusedDom = function (list, start, end) {\r\n        // TODO optimise\r\n        for (var i = 0; i < list.length; i++) {\r\n            if (i === start) {\r\n                i = end - 1;\r\n                continue;\r\n            }\r\n            if (list[i].dom) {\r\n                var dom = list[i].dom;\r\n                if (Tombstone.isTombstone(dom)) {\r\n                    this.tombstone.recycleOne(dom);\r\n                    dom.style.display = 'none';\r\n                }\r\n                else {\r\n                    this.unusedDom.push(dom);\r\n                }\r\n                list[i].dom = null;\r\n            }\r\n        }\r\n        return list;\r\n    };\r\n    DomManager.prototype.createDom = function (list, start, end) {\r\n        for (var i = start; i < end; i++) {\r\n            var dom = list[i].dom;\r\n            var data = list[i].data;\r\n            if (dom) {\r\n                if (Tombstone.isTombstone(dom) && data) {\r\n                    list[i].tombstone = dom;\r\n                    list[i].dom = null;\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n            dom = data\r\n                ? this.renderFn(data, this.unusedDom.pop())\r\n                : this.tombstone.getOne();\r\n            dom.style.position = 'absolute';\r\n            list[i].dom = dom;\r\n            list[i].pos = -1;\r\n            this.content.appendChild(dom);\r\n        }\r\n    };\r\n    DomManager.prototype.cacheHeight = function (list, start, end) {\r\n        for (var i = start; i < end; i++) {\r\n            if (list[i].data && !list[i].height) {\r\n                list[i].height = list[i].dom.offsetHeight;\r\n            }\r\n        }\r\n    };\r\n    DomManager.prototype.positionDom = function (list, start, end) {\r\n        var _this = this;\r\n        var tombstoneEles = [];\r\n        var _a = this.getStartPos(list, start, end), startPos = _a.start, startDelta = _a.delta;\r\n        var pos = startPos;\r\n        // TODO transition\r\n        for (var i = start; i < end; i++) {\r\n            var tombstone = list[i].tombstone;\r\n            if (tombstone) {\r\n                var tombstoneStyle = tombstone.style;\r\n                tombstoneStyle[style.transition] = cssVendor + \"transform \" + ANIMATION_DURATION_MS + \"ms, opacity \" + ANIMATION_DURATION_MS + \"ms\";\r\n                tombstoneStyle[style.transform] = \"translateY(\" + pos + \"px)\";\r\n                tombstoneStyle.opacity = '0';\r\n                list[i].tombstone = null;\r\n                tombstoneEles.push(tombstone);\r\n            }\r\n            if (list[i].dom && list[i].pos !== pos) {\r\n                list[i].dom.style[style.transform] = \"translateY(\" + pos + \"px)\";\r\n                list[i].pos = pos;\r\n            }\r\n            pos += list[i].height || this.tombstone.height;\r\n        }\r\n        var timerId = window.setTimeout(function () {\r\n            _this.tombstone.recycle(tombstoneEles);\r\n        }, ANIMATION_DURATION_MS);\r\n        this.timers.push(timerId);\r\n        return {\r\n            startPos: startPos,\r\n            startDelta: startDelta,\r\n            endPos: pos\r\n        };\r\n    };\r\n    DomManager.prototype.getStartPos = function (list, start, end) {\r\n        if (list[start] && list[start].pos !== -1) {\r\n            return {\r\n                start: list[start].pos,\r\n                delta: 0\r\n            };\r\n        }\r\n        // TODO optimise\r\n        var pos = list[0].pos === -1 ? 0 : list[0].pos;\r\n        for (var i_1 = 0; i_1 < start; i_1++) {\r\n            pos += list[i_1].height || this.tombstone.height;\r\n        }\r\n        var originPos = pos;\r\n        var i;\r\n        for (i = start; i < end; i++) {\r\n            if (!Tombstone.isTombstone(list[i].dom) && list[i].pos !== -1) {\r\n                pos = list[i].pos;\r\n                break;\r\n            }\r\n        }\r\n        var x = i;\r\n        if (x < end) {\r\n            while (x > start) {\r\n                pos -= list[x - 1].height;\r\n                x--;\r\n            }\r\n        }\r\n        var delta = originPos - pos;\r\n        return {\r\n            start: pos,\r\n            delta: delta\r\n        };\r\n    };\r\n    DomManager.prototype.removeTombstone = function () {\r\n        var tombstones = this.content.querySelectorAll('.tombstone');\r\n        for (var i = tombstones.length - 1; i >= 0; i--) {\r\n            this.content.removeChild(tombstones[i]);\r\n        }\r\n    };\r\n    DomManager.prototype.destroy = function () {\r\n        this.removeTombstone();\r\n        this.timers.forEach(function (id) {\r\n            clearTimeout(id);\r\n        });\r\n    };\r\n    return DomManager;\r\n}());\n\nvar EXTRA_SCROLL_Y = -2000;\r\nvar InfinityScroll = /** @class */ (function () {\r\n    function InfinityScroll(bscroll) {\r\n        this.bscroll = bscroll;\r\n        this.start = 0;\r\n        this.end = 0;\r\n        if (bscroll.options.infinity) {\r\n            this.bscroll.options.probeType = 3 /* Realtime */;\r\n            this.bscroll.scroller.scrollBehaviorY.hasScroll = true;\r\n            this.bscroll.scroller.scrollBehaviorY.maxScrollPos = EXTRA_SCROLL_Y;\r\n            this.init(bscroll.options.infinity);\r\n        }\r\n    }\r\n    InfinityScroll.prototype.init = function (options) {\r\n        var fetchFn = options.fetch, renderFn = options.render, createTombstoneFn = options.createTombstone;\r\n        this.tombstone = new Tombstone(createTombstoneFn);\r\n        this.indexCalculator = new IndexCalculator(this.bscroll.scroller.scrollBehaviorY.wrapperSize, this.tombstone.height);\r\n        this.domManager = new DomManager(this.bscroll.scroller.content, renderFn, this.tombstone);\r\n        this.dataManager = new DataManager([], fetchFn, this.onFetchFinish.bind(this));\r\n        this.bscroll.on('destroy', this.destroy, this);\r\n        this.bscroll.on('scroll', this.update, this);\r\n        this.update({ y: 0 });\r\n    };\r\n    InfinityScroll.prototype.update = function (pos) {\r\n        var position = Math.round(-pos.y);\r\n        // important! calculate start/end index to render\r\n        var _a = this.indexCalculator.calculate(position, this.dataManager.getList()), start = _a.start, end = _a.end;\r\n        this.start = start;\r\n        this.end = end;\r\n        // tslint:disable-next-line: no-floating-promises\r\n        this.dataManager.update(end);\r\n        this.updateDom(this.dataManager.getList());\r\n    };\r\n    InfinityScroll.prototype.onFetchFinish = function (list, hasMore) {\r\n        var end = this.updateDom(list).end;\r\n        if (!hasMore) {\r\n            this.domManager.removeTombstone();\r\n            this.bscroll.scroller.animater.stop();\r\n            this.bscroll.resetPosition();\r\n        }\r\n        // tslint:disable-next-line: no-floating-promises\r\n        return end;\r\n    };\r\n    InfinityScroll.prototype.updateDom = function (list) {\r\n        var _a = this.domManager.update(list, this.start, this.end), end = _a.end, startPos = _a.startPos, endPos = _a.endPos, startDelta = _a.startDelta;\r\n        if (startDelta) {\r\n            this.bscroll.minScrollY = startDelta;\r\n        }\r\n        if (endPos > this.bscroll.maxScrollY) {\r\n            this.bscroll.maxScrollY = -(endPos - this.bscroll.scroller.scrollBehaviorY.wrapperSize);\r\n        }\r\n        return {\r\n            end: end,\r\n            startPos: startPos,\r\n            endPos: endPos\r\n        };\r\n    };\r\n    InfinityScroll.prototype.destroy = function () {\r\n        var content = this.bscroll.scroller.content;\r\n        while (content.firstChild) {\r\n            content.removeChild(content.firstChild);\r\n        }\r\n        this.domManager.destroy();\r\n        this.bscroll.off('scroll', this.update);\r\n        this.bscroll.off('destroy', this.destroy);\r\n    };\r\n    InfinityScroll.pluginName = 'infinity';\r\n    return InfinityScroll;\r\n}());\n\nBScroll.use(MouseWheel)\r\n    .use(ObserveDOM)\r\n    .use(PullDown)\r\n    .use(PullUp)\r\n    .use(ScrollBar)\r\n    .use(Slide)\r\n    .use(Wheel)\r\n    .use(Zoom)\r\n    .use(NestedScroll)\r\n    .use(InfinityScroll);\n\nexport default BScroll;\n"]},"metadata":{},"sourceType":"module"}