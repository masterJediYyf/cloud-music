{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\86136\\\\Desktop\\\\\\u5B66\\u4E60\\u8FDB\\u5EA6\\\\new_html\\\\fullstack_yyf\\\\react\\\\cloud-music\\\\src\\\\baseUI\\\\scroll\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { forwardRef, useState, useEffect, useRef, useImperativeHandle } from \"react\";\nimport PropTypes from \"prop-types\";\nimport BScroll from \"better-scroll\";\nimport styled from 'styled-components';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ScrollContainer = styled.div`\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`;\n_c = ScrollContainer;\nconst Scroll = /*#__PURE__*/forwardRef(_c2 = _s((props, ref) => {\n  _s();\n\n  const [bScroll, setBScroll] = useState();\n  const scrollContaninerRef = useRef();\n  const {\n    direction,\n    click,\n    refresh,\n    bounceTop,\n    bounceBottom\n  } = props;\n  const {\n    pullUp,\n    pullDown,\n    onScroll\n  } = props;\n  useEffect(() => {\n    const scroll = new BScroll(scrollContaninerRef.current, {\n      scrollX: direction === \"horizental\",\n      scrollY: direction === \"vertical\",\n      probeType: 3,\n      click: click,\n      bounce: {\n        top: bounceTop,\n        bottom: bounceBottom\n      }\n    });\n    setBScroll(scroll);\n    return () => {\n      setBScroll(null);\n    }; //eslint-disable-next-line\n  }, []);\n  useEffect(() => {\n    if (!bScroll || !onScroll) return;\n    bScroll.on('scroll', scroll => {\n      onScroll(scroll);\n    });\n    return () => {\n      bScroll.off('scroll');\n    };\n  }, [onScroll, bScroll]);\n  useEffect(() => {\n    if (!bScroll || !pullUp) return;\n    bScroll.on('scrollEnd', () => {\n      // 判断是否滑动到了底部\n      if (bScroll.y <= bScroll.maxScrollY + 100) {\n        pullUp();\n      }\n    });\n    return () => {\n      bScroll.off('scrollEnd');\n    };\n  }, [pullUp, bScroll]);\n  useEffect(() => {\n    if (!bScroll || !pullDown) return;\n    bScroll.on('touchEnd', pos => {\n      // 判断用户的下拉动作\n      if (pos.y > 50) {\n        pullDown();\n      }\n    });\n    return () => {\n      bScroll.off('touchEnd');\n    };\n  }, [pullDown, bScroll]);\n  useEffect(() => {\n    if (refresh && bScroll) {\n      bScroll.refresh();\n    }\n  });\n  useImperativeHandle(ref, () => ({\n    refresh() {\n      if (bScroll) {\n        bScroll.refresh();\n        bScroll.scrollTo(0, 0);\n      }\n    },\n\n    getBScroll() {\n      if (bScroll) {\n        return bScroll;\n      }\n    }\n\n  }));\n  return /*#__PURE__*/_jsxDEV(ScrollContainer, {\n    ref: scrollContaninerRef,\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n}, \"xv1Kq+IZIM0YGUo9seEr3h4Kqwk=\", false, function () {\n  return [useImperativeHandle];\n}));\n_c3 = Scroll;\nScroll.defaultProps = {\n  direction: \"vertical\",\n  click: true,\n  refresh: true,\n  onScroll: null,\n  pullUpLoading: false,\n  pullDownLoading: false,\n  pullUp: null,\n  pullDown: null,\n  bounceTop: true,\n  bounceBottom: true\n};\nScroll.propTypes = {\n  direction: PropTypes.oneOf(['vertical', 'horizental']),\n  refresh: PropTypes.bool,\n  onScroll: PropTypes.func,\n  pullUp: PropTypes.func,\n  pullDown: PropTypes.func,\n  pullUpLoading: PropTypes.bool,\n  pullDownLoading: PropTypes.bool,\n  bounceTop: PropTypes.bool,\n  // 是否支持向上吸顶\n  bounceBottom: PropTypes.bool // 是否支持向上吸顶\n\n};\nexport default Scroll;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"ScrollContainer\");\n$RefreshReg$(_c2, \"Scroll$forwardRef\");\n$RefreshReg$(_c3, \"Scroll\");","map":{"version":3,"sources":["C:/Users/86136/Desktop/学习进度/new_html/fullstack_yyf/react/cloud-music/src/baseUI/scroll/index.js"],"names":["React","forwardRef","useState","useEffect","useRef","useImperativeHandle","PropTypes","BScroll","styled","ScrollContainer","div","Scroll","props","ref","bScroll","setBScroll","scrollContaninerRef","direction","click","refresh","bounceTop","bounceBottom","pullUp","pullDown","onScroll","scroll","current","scrollX","scrollY","probeType","bounce","top","bottom","on","off","y","maxScrollY","pos","scrollTo","getBScroll","children","defaultProps","pullUpLoading","pullDownLoading","propTypes","oneOf","bool","func"],"mappings":"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","sourcesContent":["import React, { forwardRef, useState,useEffect, useRef, useImperativeHandle } from \"react\"\r\nimport PropTypes from \"prop-types\"\r\nimport BScroll from \"better-scroll\"\r\nimport styled from'styled-components';\r\n\r\nconst ScrollContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n`\r\nconst Scroll = forwardRef ((props, ref) => {\r\n  const [bScroll, setBScroll] = useState ();\r\n\r\n  const scrollContaninerRef = useRef ();\r\n\r\n  const { direction, click, refresh,  bounceTop, bounceBottom } = props;\r\n\r\n  const { pullUp, pullDown, onScroll } = props;\r\n\r\n  useEffect (() => {\r\n    const scroll = new BScroll (scrollContaninerRef.current, {\r\n      scrollX: direction === \"horizental\",\r\n      scrollY: direction === \"vertical\",\r\n      probeType: 3,\r\n      click: click,\r\n      bounce:{\r\n        top: bounceTop,\r\n        bottom: bounceBottom\r\n      }\r\n    });\r\n    setBScroll (scroll);\r\n    return () => {\r\n      setBScroll (null);\r\n    }\r\n    //eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect (() => {\r\n    if (!bScroll || !onScroll) return;\r\n    bScroll.on ('scroll', (scroll) => {\r\n      onScroll (scroll);\r\n    })\r\n    return () => {\r\n      bScroll.off ('scroll');\r\n    }\r\n  }, [onScroll, bScroll]);\r\n\r\n  useEffect (() => {\r\n    if (!bScroll || !pullUp) return;\r\n    bScroll.on ('scrollEnd', () => {\r\n      // 判断是否滑动到了底部\r\n      if (bScroll.y <= bScroll.maxScrollY + 100){\r\n        pullUp ();\r\n      }\r\n    });\r\n    return () => {\r\n      bScroll.off ('scrollEnd');\r\n    }\r\n  }, [pullUp, bScroll]);\r\n\r\n  useEffect (() => {\r\n    if (!bScroll || !pullDown) return;\r\n    bScroll.on ('touchEnd', (pos) => {\r\n      // 判断用户的下拉动作\r\n      if (pos.y > 50) {\r\n        pullDown ();\r\n      }\r\n    });\r\n    return () => {\r\n      bScroll.off ('touchEnd');\r\n    }\r\n  }, [pullDown, bScroll]);\r\n\r\n\r\n  useEffect (() => {\r\n    if (refresh && bScroll){\r\n      bScroll.refresh ();\r\n    }\r\n  });\r\n\r\n  useImperativeHandle (ref, () => ({\r\n    refresh () {\r\n      if (bScroll) {\r\n        bScroll.refresh ();\r\n        bScroll.scrollTo (0, 0);\r\n      }\r\n    },\r\n    getBScroll () {\r\n      if (bScroll) {\r\n        return bScroll;\r\n      }\r\n    }\r\n  }));\r\n\r\n\r\n  return (\r\n    <ScrollContainer ref={scrollContaninerRef}>\r\n      {props.children}\r\n    </ScrollContainer>\r\n  );\r\n})\r\n\r\nScroll.defaultProps = {\r\n  direction: \"vertical\",\r\n  click: true,\r\n  refresh: true,\r\n  onScroll:null,\r\n  pullUpLoading: false,\r\n  pullDownLoading: false,\r\n  pullUp: null,\r\n  pullDown: null,\r\n  bounceTop: true,\r\n  bounceBottom: true\r\n};\r\n\r\nScroll.propTypes = {\r\n  direction: PropTypes.oneOf (['vertical', 'horizental']),\r\n  refresh: PropTypes.bool,\r\n  onScroll: PropTypes.func,\r\n  pullUp: PropTypes.func,\r\n  pullDown: PropTypes.func,\r\n  pullUpLoading: PropTypes.bool,\r\n  pullDownLoading: PropTypes.bool,\r\n  bounceTop: PropTypes.bool,// 是否支持向上吸顶\r\n  bounceBottom: PropTypes.bool// 是否支持向上吸顶\r\n};\r\n\r\nexport default Scroll;"]},"metadata":{},"sourceType":"module"}