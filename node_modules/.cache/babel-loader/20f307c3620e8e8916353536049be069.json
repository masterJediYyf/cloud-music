{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\86136\\\\Desktop\\\\\\u5B66\\u4E60\\u8FDB\\u5EA6\\\\new_html\\\\fullstack_yyf\\\\react\\\\cloud-music\\\\src\\\\baseUI\\\\scroll\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { forwardRef, useState, useEffect, useRef, useImperativeHandle, useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport BScroll from \"better-scroll\";\nimport styled from 'styled-components';\nimport Loading from '../loading';\nimport { debounce } from \"../../api/utils\";\nimport LoadingV2 from '../loading-v2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ScrollContainer = styled.div`\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`;\n_c = ScrollContainer;\nconst PullUpLoading = styled.div`\n  position: absolute;\n  left:0; right:0;\n  bottom: 5px;\n  width: 60px;\n  height: 60px;\n  margin: auto;\n  z-index: 100;\n`;\n_c2 = PullUpLoading;\nexport const PullDownLoading = styled.div`\n  position: absolute;\n  left:0; right:0;\n  top: 0px;\n  height: 30px;\n  margin: auto;\n  z-index: 100;\n`;\n_c3 = PullDownLoading;\nconst Scroll = /*#__PURE__*/forwardRef(_c4 = _s((props, ref) => {\n  _s();\n\n  const [bScroll, setBScroll] = useState();\n  const scrollContaninerRef = useRef();\n  const {\n    direction,\n    click,\n    refresh,\n    bounceTop,\n    bounceBottom\n  } = props;\n  const {\n    pullUp,\n    pullDown,\n    onScroll,\n    pullUpLoading,\n    pullDownLoading\n  } = props;\n  let pullUpDebounce = useMemo(() => {\n    return debounce(pullUp, 300);\n  }, [pullUp]);\n  let pullDownDebounce = useMemo(() => {\n    return debounce(pullDown, 300);\n  }, [pullDown]);\n  useEffect(() => {\n    const scroll = new BScroll(scrollContaninerRef.current, {\n      scrollX: direction === \"horizontal\",\n      scrollY: direction === \"vertical\",\n      probeType: 3,\n      click: click,\n      bounce: {\n        top: bounceTop,\n        bottom: bounceBottom\n      }\n    });\n    setBScroll(scroll);\n    return () => {\n      setBScroll(null);\n    }; // eslint-disable-next-line\n  }, []);\n  useEffect(() => {\n    if (!bScroll || !onScroll) return;\n    bScroll.on('scroll', scroll => {\n      onScroll(scroll);\n    });\n    return () => {\n      bScroll.off('scroll');\n    };\n  }, [onScroll, bScroll]);\n  useEffect(() => {\n    if (!bScroll || !pullUp) return;\n    bScroll.on('scrollEnd', () => {\n      //判断是否滑动到了底部\n      if (bScroll.y <= bScroll.maxScrollY + 100) {\n        pullUpDebounce();\n      }\n    });\n    return () => {\n      bScroll.off('scrollEnd');\n    };\n  }, [pullUpDebounce, pullUp, bScroll]);\n  useEffect(() => {\n    if (!bScroll || !pullDown) return;\n    bScroll.on('touchEnd', pos => {\n      //判断用户的下拉动作\n      if (pos.y > 50) {\n        pullDownDebounce();\n      }\n    });\n    return () => {\n      bScroll.off('touchEnd');\n    };\n  }, [pullDownDebounce, pullDown, bScroll]);\n  useEffect(() => {\n    if (refresh && bScroll) {\n      bScroll.refresh();\n    }\n  });\n  useImperativeHandle(ref, () => ({\n    refresh() {\n      if (bScroll) {\n        bScroll.refresh();\n        bScroll.scrollTo(0, 0);\n      }\n    },\n\n    getBScroll() {\n      if (bScroll) {\n        return bScroll;\n      }\n    }\n\n  }));\n  const PullUpdisplayStyle = pullUpLoading ? {\n    display: \"\"\n  } : {\n    display: \"none\"\n  };\n  const PullDowndisplayStyle = pullDownLoading ? {\n    display: \"\"\n  } : {\n    display: \"none\"\n  };\n  return /*#__PURE__*/_jsxDEV(ScrollContainer, {\n    ref: scrollContaninerRef,\n    children: [props.children, /*#__PURE__*/_jsxDEV(PullUpLoading, {\n      style: PullUpdisplayStyle,\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 51\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PullDownLoading, {\n      style: PullDowndisplayStyle,\n      children: /*#__PURE__*/_jsxDEV(LoadingV2, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 55\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 5\n  }, this);\n}, \"t9cmBZGzT7r5ndsCpJhW16Lahk4=\", false, function () {\n  return [useImperativeHandle];\n}));\n_c5 = Scroll;\nScroll.defaultProps = {\n  direction: \"vertical\",\n  click: true,\n  refresh: true,\n  onScroll: null,\n  pullUpLoading: false,\n  pullDownLoading: false,\n  pullUp: null,\n  pullDown: null,\n  bounceTop: true,\n  bounceBottom: true\n};\nScroll.propTypes = {\n  direction: PropTypes.oneOf(['vertical', 'horizontal']),\n  refresh: PropTypes.bool,\n  onScroll: PropTypes.func,\n  pullUp: PropTypes.func,\n  pullDown: PropTypes.func,\n  pullUpLoading: PropTypes.bool,\n  pullDownLoading: PropTypes.bool,\n  bounceTop: PropTypes.bool,\n  //是否支持向上吸顶\n  bounceBottom: PropTypes.bool //是否支持向上吸顶\n\n};\nexport default Scroll;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"ScrollContainer\");\n$RefreshReg$(_c2, \"PullUpLoading\");\n$RefreshReg$(_c3, \"PullDownLoading\");\n$RefreshReg$(_c4, \"Scroll$forwardRef\");\n$RefreshReg$(_c5, \"Scroll\");","map":{"version":3,"sources":["C:/Users/86136/Desktop/学习进度/new_html/fullstack_yyf/react/cloud-music/src/baseUI/scroll/index.js"],"names":["React","forwardRef","useState","useEffect","useRef","useImperativeHandle","useMemo","PropTypes","BScroll","styled","Loading","debounce","LoadingV2","ScrollContainer","div","PullUpLoading","PullDownLoading","Scroll","props","ref","bScroll","setBScroll","scrollContaninerRef","direction","click","refresh","bounceTop","bounceBottom","pullUp","pullDown","onScroll","pullUpLoading","pullDownLoading","pullUpDebounce","pullDownDebounce","scroll","current","scrollX","scrollY","probeType","bounce","top","bottom","on","off","y","maxScrollY","pos","scrollTo","getBScroll","PullUpdisplayStyle","display","PullDowndisplayStyle","children","defaultProps","propTypes","oneOf","bool","func"],"mappings":"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","sourcesContent":["import React, { forwardRef, useState,useEffect, useRef, useImperativeHandle, useMemo } from \"react\"\r\nimport PropTypes from \"prop-types\"\r\nimport BScroll from \"better-scroll\"\r\nimport styled from 'styled-components';\r\nimport Loading from '../loading';\r\nimport { debounce } from \"../../api/utils\";\r\nimport LoadingV2 from '../loading-v2';\r\n\r\nconst ScrollContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst PullUpLoading = styled.div`\r\n  position: absolute;\r\n  left:0; right:0;\r\n  bottom: 5px;\r\n  width: 60px;\r\n  height: 60px;\r\n  margin: auto;\r\n  z-index: 100;\r\n`;\r\n\r\nexport const PullDownLoading = styled.div`\r\n  position: absolute;\r\n  left:0; right:0;\r\n  top: 0px;\r\n  height: 30px;\r\n  margin: auto;\r\n  z-index: 100;\r\n`;\r\n\r\nconst Scroll = forwardRef((props, ref) => {\r\n  const [bScroll, setBScroll] = useState();\r\n\r\n  const scrollContaninerRef = useRef();\r\n\r\n  const { direction, click, refresh,  bounceTop, bounceBottom } = props;\r\n\r\n  const { pullUp, pullDown, onScroll, pullUpLoading, pullDownLoading } = props;\r\n\r\n  let pullUpDebounce = useMemo(() => {\r\n    return debounce(pullUp, 300)\r\n  }, [pullUp]);\r\n  \r\n  let pullDownDebounce = useMemo(() => {\r\n    return debounce(pullDown, 300)\r\n  }, [pullDown]);\r\n\r\n  useEffect(() => {\r\n    const scroll = new BScroll(scrollContaninerRef.current, {\r\n      scrollX: direction === \"horizontal\",\r\n      scrollY: direction === \"vertical\",\r\n      probeType: 3,\r\n      click: click,\r\n      bounce:{\r\n        top: bounceTop,\r\n        bottom: bounceBottom\r\n      }\r\n    });\r\n    setBScroll(scroll);\r\n    return () => {\r\n      setBScroll(null);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if(!bScroll || !onScroll) return;\r\n    bScroll.on('scroll', (scroll) => {\r\n      onScroll(scroll);\r\n    })\r\n    return () => {\r\n      bScroll.off('scroll');\r\n    }\r\n  }, [onScroll, bScroll]);\r\n\r\n  useEffect(() => {\r\n    if(!bScroll || !pullUp) return;\r\n    bScroll.on('scrollEnd', () => {\r\n      //判断是否滑动到了底部\r\n      if(bScroll.y <= bScroll.maxScrollY + 100){\r\n        pullUpDebounce();\r\n      }\r\n    });\r\n    return () => {\r\n      bScroll.off('scrollEnd');\r\n    }\r\n  }, [pullUpDebounce, pullUp, bScroll]);\r\n\r\n  useEffect(() => {\r\n    if(!bScroll || !pullDown) return;\r\n    bScroll.on('touchEnd', (pos) => {\r\n      //判断用户的下拉动作\r\n      if(pos.y > 50) {\r\n        pullDownDebounce();\r\n      }\r\n    });\r\n    return () => {\r\n      bScroll.off('touchEnd');\r\n    }\r\n  }, [pullDownDebounce, pullDown, bScroll]);\r\n\r\n\r\n  useEffect(() => {\r\n    if(refresh && bScroll){\r\n      bScroll.refresh();\r\n    }\r\n  });\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    refresh() {\r\n      if(bScroll) {\r\n        bScroll.refresh();\r\n        bScroll.scrollTo(0, 0);\r\n      }\r\n    },\r\n    getBScroll() {\r\n      if(bScroll) {\r\n        return bScroll;\r\n      }\r\n    }\r\n  }));\r\n\r\n  const PullUpdisplayStyle = pullUpLoading ? { display: \"\" } : { display: \"none\" };\r\n  const PullDowndisplayStyle = pullDownLoading ? { display: \"\" } : { display: \"none\" };\r\n  return (\r\n    <ScrollContainer ref={scrollContaninerRef}>\r\n      {props.children}\r\n      {/* 滑到底部加载动画 */}\r\n      <PullUpLoading style={ PullUpdisplayStyle }><Loading></Loading></PullUpLoading>\r\n      {/* 顶部下拉刷新动画 */}\r\n      <PullDownLoading style={ PullDowndisplayStyle }><LoadingV2></LoadingV2></PullDownLoading>\r\n    </ScrollContainer>\r\n  );\r\n})\r\n\r\nScroll.defaultProps = {\r\n  direction: \"vertical\",\r\n  click: true,\r\n  refresh: true,\r\n  onScroll:null,\r\n  pullUpLoading: false,\r\n  pullDownLoading: false,\r\n  pullUp: null,\r\n  pullDown: null,\r\n  bounceTop: true,\r\n  bounceBottom: true\r\n};\r\n\r\nScroll.propTypes = {\r\n  direction: PropTypes.oneOf(['vertical', 'horizontal']),\r\n  refresh: PropTypes.bool,\r\n  onScroll: PropTypes.func,\r\n  pullUp: PropTypes.func,\r\n  pullDown: PropTypes.func,\r\n  pullUpLoading: PropTypes.bool,\r\n  pullDownLoading: PropTypes.bool,\r\n  bounceTop: PropTypes.bool,//是否支持向上吸顶\r\n  bounceBottom: PropTypes.bool//是否支持向上吸顶\r\n};\r\n\r\nexport default Scroll;"]},"metadata":{},"sourceType":"module"}