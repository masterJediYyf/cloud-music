{"ast":null,"code":"import React,{useEffect}from'react';import{connect}from'react-redux';import{getRankList}from'./store/index';import Loading from'../../baseUI/loading';import{List,ListItem,SongList,Container}from'./style';import Scroll from'../../baseUI/scroll/index';import{EnterLoading}from'./../Singers/style';import{filterIndex}from'../../api/utils';import{renderRoutes}from'react-router-config';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function Rank(props){var list=props.rankList,loading=props.loading;var getRankListDataDispatch=props.getRankListDataDispatch;var rankList=list?list.toJS():[];useEffect(function(){if(!rankList.length){getRankListDataDispatch();}// eslint-disable-next-line\n},[]);var globalStartIndex=filterIndex(rankList);var officialList=rankList.slice(0,globalStartIndex);var globalList=rankList.slice(globalStartIndex);var enterDetail=function enterDetail(detail){props.history.push(\"/rank/\".concat(detail.id));};var renderSongList=function renderSongList(list){return list.length?/*#__PURE__*/_jsx(SongList,{children:list.map(function(item,index){return/*#__PURE__*/_jsxs(\"li\",{children:[index+1,\". \",item.first,\" - \",item.second]},index);})}):null;};var renderRankList=function renderRankList(list,global){return/*#__PURE__*/_jsx(List,{globalRank:global,children:list.map(function(item){return/*#__PURE__*/_jsxs(ListItem,{tracks:item.tracks,onClick:function onClick(){return enterDetail(item);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"img_wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.coverImgUrl,alt:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"decorate\"}),/*#__PURE__*/_jsx(\"span\",{className:\"update_frequecy\",children:item.updateFrequency})]}),renderSongList(item.tracks)]},item.coverImgId);})});};var displayStyle=loading?{\"display\":\"none\"}:{\"display\":\"\"};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Scroll,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"offical\",style:displayStyle,children:\"\\u5B98\\u65B9\\u699C\"}),renderRankList(officialList),/*#__PURE__*/_jsx(\"h1\",{className:\"global\",style:displayStyle,children:\"\\u5168\\u7403\\u699C\"}),renderRankList(globalList,true),loading?/*#__PURE__*/_jsx(EnterLoading,{children:/*#__PURE__*/_jsx(Loading,{})}):null]})}),renderRoutes(props.route.routes)]});}// 映射Redux全局的state到组件的props上\nvar mapStateToProps=function mapStateToProps(state){return{rankList:state.getIn(['rank','rankList']),loading:state.getIn(['rank','loading'])};};// 映射dispatch到props上\nvar mapDispatchToProps=function mapDispatchToProps(dispatch){return{getRankListDataDispatch:function getRankListDataDispatch(){dispatch(getRankList());}};};export default connect(mapStateToProps,mapDispatchToProps)(/*#__PURE__*/React.memo(Rank));","map":{"version":3,"sources":["C:/Users/86136/Desktop/学习进度/new_html/fullstack_yyf/react/cloud-music/src/application/Rank/index.js"],"names":["React","useEffect","connect","getRankList","Loading","List","ListItem","SongList","Container","Scroll","EnterLoading","filterIndex","renderRoutes","Rank","props","list","rankList","loading","getRankListDataDispatch","toJS","length","globalStartIndex","officialList","slice","globalList","enterDetail","detail","history","push","id","renderSongList","map","item","index","first","second","renderRankList","global","tracks","coverImgUrl","updateFrequency","coverImgId","displayStyle","route","routes","mapStateToProps","state","getIn","mapDispatchToProps","dispatch","memo"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { getRankList } from './store/index'\r\nimport Loading from '../../baseUI/loading';\r\nimport {\r\n  List, \r\n  ListItem,\r\n  SongList,\r\n  Container\r\n} from './style';\r\nimport Scroll from '../../baseUI/scroll/index';\r\nimport { EnterLoading } from './../Singers/style';\r\nimport { filterIndex } from '../../api/utils';\r\nimport { renderRoutes } from 'react-router-config';\r\n\r\nfunction Rank(props) {\r\n  const { rankList:list, loading } = props;\r\n\r\n  const { getRankListDataDispatch } = props;\r\n\r\n  let rankList = list ? list.toJS() : [];\r\n\r\n  useEffect(() => {\r\n    if(!rankList.length){\r\n      getRankListDataDispatch();\r\n    }\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  let globalStartIndex = filterIndex(rankList);\r\n  let officialList = rankList.slice(0, globalStartIndex);\r\n  let globalList = rankList.slice(globalStartIndex);\r\n\r\n  const enterDetail = (detail) => {\r\n    props.history.push(`/rank/${detail.id}`)\r\n  }\r\n  const renderSongList = (list) => {\r\n    return list.length ? (\r\n      <SongList>\r\n        {\r\n          list.map((item, index) => {\r\n            return <li key={index}>{index+1}. {item.first} - {item.second}</li>\r\n          })\r\n        }\r\n      </SongList>\r\n    ) : null;\r\n  }\r\n  const renderRankList = (list, global) => {\r\n    return (\r\n      <List globalRank={global}>\r\n       {\r\n        list.map((item) => {\r\n          return (\r\n            <ListItem key={item.coverImgId} tracks={item.tracks} onClick={() => enterDetail(item)}>\r\n              <div className=\"img_wrapper\">\r\n                <img src={item.coverImgUrl} alt=\"\"/>\r\n                <div className=\"decorate\"></div>\r\n                <span className=\"update_frequecy\">{item.updateFrequency}</span>\r\n              </div>\r\n              { renderSongList(item.tracks)  }\r\n            </ListItem>\r\n          )\r\n       })\r\n      } \r\n      </List>\r\n    )\r\n  }\r\n\r\n  let displayStyle = loading ? {\"display\":\"none\"}:  {\"display\": \"\"};\r\n  return (\r\n    <Container>\r\n      <Scroll>\r\n        <div>\r\n          <h1 className=\"offical\" style={displayStyle}>官方榜</h1>\r\n            { renderRankList(officialList) }\r\n          <h1 className=\"global\" style={displayStyle}>全球榜</h1>\r\n            { renderRankList(globalList, true) }\r\n          { loading ? <EnterLoading><Loading></Loading></EnterLoading> : null }\r\n        </div>\r\n      </Scroll> \r\n      {renderRoutes(props.route.routes)}\r\n    </Container>\r\n    );\r\n}\r\n\r\n// 映射Redux全局的state到组件的props上\r\nconst mapStateToProps = (state) => ({\r\n  rankList: state.getIn(['rank', 'rankList']),\r\n  loading: state.getIn(['rank', 'loading']),\r\n});\r\n// 映射dispatch到props上\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    getRankListDataDispatch() {\r\n      dispatch(getRankList());\r\n    }\r\n  }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(Rank));"]},"metadata":{},"sourceType":"module"}